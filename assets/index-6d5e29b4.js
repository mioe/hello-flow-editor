(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function Jr(t,e){const n=Object.create(null),i=t.split(",");for(let r=0;r<i.length;r++)n[i[r]]=!0;return e?r=>!!n[r.toLowerCase()]:r=>!!n[r]}const yu="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt",bu=Jr(yu);function kt(t){if(ee(t)){const e={};for(let n=0;n<t.length;n++){const i=t[n],r=Me(i)?xu(i):kt(i);if(r)for(const s in r)e[s]=r[s]}return e}else{if(Me(t))return t;if(Se(t))return t}}const wu=/;(?![^(]*\))/g,Cu=/:([^]+)/,Su=/\/\*.*?\*\//gs;function xu(t){const e={};return t.replace(Su,"").split(wu).forEach(n=>{if(n){const i=n.split(Cu);i.length>1&&(e[i[0].trim()]=i[1].trim())}}),e}function Ze(t){let e="";if(Me(t))e=t;else if(ee(t))for(let n=0;n<t.length;n++){const i=Ze(t[n]);i&&(e+=i+" ")}else if(Se(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}function Eu(t){if(!t)return null;let{class:e,style:n}=t;return e&&!Me(e)&&(t.class=Ze(e)),n&&(t.style=kt(n)),t}const Tu="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",ku=Jr(Tu);function Bl(t){return!!t||t===""}function Pu(t,e){if(t.length!==e.length)return!1;let n=!0;for(let i=0;n&&i<t.length;i++)n=hn(t[i],e[i]);return n}function hn(t,e){if(t===e)return!0;let n=ca(t),i=ca(e);if(n||i)return n&&i?t.getTime()===e.getTime():!1;if(n=zi(t),i=zi(e),n||i)return t===e;if(n=ee(t),i=ee(e),n||i)return n&&i?Pu(t,e):!1;if(n=Se(t),i=Se(e),n||i){if(!n||!i)return!1;const r=Object.keys(t).length,s=Object.keys(e).length;if(r!==s)return!1;for(const o in t){const a=t.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!hn(t[o],e[o]))return!1}}return String(t)===String(e)}function Qr(t,e){return t.findIndex(n=>hn(n,e))}const Ke=t=>Me(t)?t:t==null?"":ee(t)||Se(t)&&(t.toString===Ul||!oe(t.toString))?JSON.stringify(t,Hl,2):String(t),Hl=(t,e)=>e&&e.__v_isRef?Hl(t,e.value):ei(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[i,r])=>(n[`${i} =>`]=r,n),{})}:$n(e)?{[`Set(${e.size})`]:[...e.values()]}:Se(e)&&!ee(e)&&!jl(e)?String(e):e,Ce={},Zn=[],xt=()=>{},Mu=()=>!1,Ou=/^on[^a-z]/,rr=t=>Ou.test(t),Co=t=>t.startsWith("onUpdate:"),De=Object.assign,So=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},Au=Object.prototype.hasOwnProperty,ve=(t,e)=>Au.call(t,e),ee=Array.isArray,ei=t=>fi(t)==="[object Map]",$n=t=>fi(t)==="[object Set]",ca=t=>fi(t)==="[object Date]",Iu=t=>fi(t)==="[object RegExp]",oe=t=>typeof t=="function",Me=t=>typeof t=="string",zi=t=>typeof t=="symbol",Se=t=>t!==null&&typeof t=="object",xo=t=>Se(t)&&oe(t.then)&&oe(t.catch),Ul=Object.prototype.toString,fi=t=>Ul.call(t),Ru=t=>fi(t).slice(8,-1),jl=t=>fi(t)==="[object Object]",Eo=t=>Me(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Li=Jr(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Zr=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},Nu=/-(\w)/g,it=Zr(t=>t.replace(Nu,(e,n)=>n?n.toUpperCase():"")),Du=/\B([A-Z])/g,gt=Zr(t=>t.replace(Du,"-$1").toLowerCase()),sr=Zr(t=>t.charAt(0).toUpperCase()+t.slice(1)),Gi=Zr(t=>t?`on${sr(t)}`:""),oi=(t,e)=>!Object.is(t,e),ti=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},Hr=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},Ur=t=>{const e=parseFloat(t);return isNaN(e)?t:e},jr=t=>{const e=Me(t)?Number(t):NaN;return isNaN(e)?t:e};let ua;const Lu=()=>ua||(ua=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let at;class To{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=at,!e&&at&&(this.index=(at.scopes||(at.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const n=at;try{return at=this,e()}finally{at=n}}}on(){at=this}off(){at=this.parent}stop(e){if(this._active){let n,i;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].stop();for(n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.scopes)for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0,this._active=!1}}}function Gu(t){return new To(t)}function Wl(t,e=at){e&&e.active&&e.effects.push(t)}function ko(){return at}function zl(t){at&&at.cleanups.push(t)}const Po=t=>{const e=new Set(t);return e.w=0,e.n=0,e},Vl=t=>(t.w&cn)>0,Yl=t=>(t.n&cn)>0,Fu=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=cn},$u=t=>{const{deps:e}=t;if(e.length){let n=0;for(let i=0;i<e.length;i++){const r=e[i];Vl(r)&&!Yl(r)?r.delete(t):e[n++]=r,r.w&=~cn,r.n&=~cn}e.length=n}},Wr=new WeakMap;let Mi=0,cn=1;const Bs=30;let Ct;const Mn=Symbol(""),Hs=Symbol("");class or{constructor(e,n=null,i){this.fn=e,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,Wl(this,i)}run(){if(!this.active)return this.fn();let e=Ct,n=on;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=Ct,Ct=this,on=!0,cn=1<<++Mi,Mi<=Bs?Fu(this):da(this),this.fn()}finally{Mi<=Bs&&$u(this),cn=1<<--Mi,Ct=this.parent,on=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Ct===this?this.deferStop=!0:this.active&&(da(this),this.onStop&&this.onStop(),this.active=!1)}}function da(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}function Bu(t,e){t.effect&&(t=t.effect.fn);const n=new or(t);e&&(De(n,e),e.scope&&Wl(n,e.scope)),(!e||!e.lazy)&&n.run();const i=n.run.bind(n);return i.effect=n,i}function Hu(t){t.effect.stop()}let on=!0;const Xl=[];function pi(){Xl.push(on),on=!1}function gi(){const t=Xl.pop();on=t===void 0?!0:t}function rt(t,e,n){if(on&&Ct){let i=Wr.get(t);i||Wr.set(t,i=new Map);let r=i.get(n);r||i.set(n,r=Po()),Kl(r)}}function Kl(t,e){let n=!1;Mi<=Bs?Yl(t)||(t.n|=cn,n=!Vl(t)):n=!t.has(Ct),n&&(t.add(Ct),Ct.deps.push(t))}function Vt(t,e,n,i,r,s){const o=Wr.get(t);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(n==="length"&&ee(t)){const l=Number(i);o.forEach((h,c)=>{(c==="length"||c>=l)&&a.push(h)})}else switch(n!==void 0&&a.push(o.get(n)),e){case"add":ee(t)?Eo(n)&&a.push(o.get("length")):(a.push(o.get(Mn)),ei(t)&&a.push(o.get(Hs)));break;case"delete":ee(t)||(a.push(o.get(Mn)),ei(t)&&a.push(o.get(Hs)));break;case"set":ei(t)&&a.push(o.get(Mn));break}if(a.length===1)a[0]&&Us(a[0]);else{const l=[];for(const h of a)h&&l.push(...h);Us(Po(l))}}function Us(t,e){const n=ee(t)?t:[...t];for(const i of n)i.computed&&fa(i);for(const i of n)i.computed||fa(i)}function fa(t,e){(t!==Ct||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}function Uu(t,e){var n;return(n=Wr.get(t))===null||n===void 0?void 0:n.get(e)}const ju=Jr("__proto__,__v_isRef,__isVue"),ql=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(zi)),Wu=es(),zu=es(!1,!0),Vu=es(!0),Yu=es(!0,!0),pa=Xu();function Xu(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const i=pe(this);for(let s=0,o=this.length;s<o;s++)rt(i,"get",s+"");const r=i[e](...n);return r===-1||r===!1?i[e](...n.map(pe)):r}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){pi();const i=pe(this)[e].apply(this,n);return gi(),i}}),t}function Ku(t){const e=pe(this);return rt(e,"has",t),e.hasOwnProperty(t)}function es(t=!1,e=!1){return function(i,r,s){if(r==="__v_isReactive")return!t;if(r==="__v_isReadonly")return t;if(r==="__v_isShallow")return e;if(r==="__v_raw"&&s===(t?e?ih:nh:e?th:eh).get(i))return i;const o=ee(i);if(!t){if(o&&ve(pa,r))return Reflect.get(pa,r,s);if(r==="hasOwnProperty")return Ku}const a=Reflect.get(i,r,s);return(zi(r)?ql.has(r):ju(r))||(t||rt(i,"get",r),e)?a:Be(a)?o&&Eo(r)?a:a.value:Se(a)?t?Oo(a):_t(a):a}}const qu=Jl(),Ju=Jl(!0);function Jl(t=!1){return function(n,i,r,s){let o=n[i];if(Dn(o)&&Be(o)&&!Be(r))return!1;if(!t&&(!Vi(r)&&!Dn(r)&&(o=pe(o),r=pe(r)),!ee(n)&&Be(o)&&!Be(r)))return o.value=r,!0;const a=ee(n)&&Eo(i)?Number(i)<n.length:ve(n,i),l=Reflect.set(n,i,r,s);return n===pe(s)&&(a?oi(r,o)&&Vt(n,"set",i,r):Vt(n,"add",i,r)),l}}function Qu(t,e){const n=ve(t,e);t[e];const i=Reflect.deleteProperty(t,e);return i&&n&&Vt(t,"delete",e,void 0),i}function Zu(t,e){const n=Reflect.has(t,e);return(!zi(e)||!ql.has(e))&&rt(t,"has",e),n}function ed(t){return rt(t,"iterate",ee(t)?"length":Mn),Reflect.ownKeys(t)}const Ql={get:Wu,set:qu,deleteProperty:Qu,has:Zu,ownKeys:ed},Zl={get:Vu,set(t,e){return!0},deleteProperty(t,e){return!0}},td=De({},Ql,{get:zu,set:Ju}),nd=De({},Zl,{get:Yu}),Mo=t=>t,ts=t=>Reflect.getPrototypeOf(t);function dr(t,e,n=!1,i=!1){t=t.__v_raw;const r=pe(t),s=pe(e);n||(e!==s&&rt(r,"get",e),rt(r,"get",s));const{has:o}=ts(r),a=i?Mo:n?Io:Yi;if(o.call(r,e))return a(t.get(e));if(o.call(r,s))return a(t.get(s));t!==r&&t.get(e)}function fr(t,e=!1){const n=this.__v_raw,i=pe(n),r=pe(t);return e||(t!==r&&rt(i,"has",t),rt(i,"has",r)),t===r?n.has(t):n.has(t)||n.has(r)}function pr(t,e=!1){return t=t.__v_raw,!e&&rt(pe(t),"iterate",Mn),Reflect.get(t,"size",t)}function ga(t){t=pe(t);const e=pe(this);return ts(e).has.call(e,t)||(e.add(t),Vt(e,"add",t,t)),this}function va(t,e){e=pe(e);const n=pe(this),{has:i,get:r}=ts(n);let s=i.call(n,t);s||(t=pe(t),s=i.call(n,t));const o=r.call(n,t);return n.set(t,e),s?oi(e,o)&&Vt(n,"set",t,e):Vt(n,"add",t,e),this}function ma(t){const e=pe(this),{has:n,get:i}=ts(e);let r=n.call(e,t);r||(t=pe(t),r=n.call(e,t)),i&&i.call(e,t);const s=e.delete(t);return r&&Vt(e,"delete",t,void 0),s}function _a(){const t=pe(this),e=t.size!==0,n=t.clear();return e&&Vt(t,"clear",void 0,void 0),n}function gr(t,e){return function(i,r){const s=this,o=s.__v_raw,a=pe(o),l=e?Mo:t?Io:Yi;return!t&&rt(a,"iterate",Mn),o.forEach((h,c)=>i.call(r,l(h),l(c),s))}}function vr(t,e,n){return function(...i){const r=this.__v_raw,s=pe(r),o=ei(s),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,h=r[t](...i),c=n?Mo:e?Io:Yi;return!e&&rt(s,"iterate",l?Hs:Mn),{next(){const{value:u,done:d}=h.next();return d?{value:u,done:d}:{value:a?[c(u[0]),c(u[1])]:c(u),done:d}},[Symbol.iterator](){return this}}}}function Zt(t){return function(...e){return t==="delete"?!1:this}}function id(){const t={get(s){return dr(this,s)},get size(){return pr(this)},has:fr,add:ga,set:va,delete:ma,clear:_a,forEach:gr(!1,!1)},e={get(s){return dr(this,s,!1,!0)},get size(){return pr(this)},has:fr,add:ga,set:va,delete:ma,clear:_a,forEach:gr(!1,!0)},n={get(s){return dr(this,s,!0)},get size(){return pr(this,!0)},has(s){return fr.call(this,s,!0)},add:Zt("add"),set:Zt("set"),delete:Zt("delete"),clear:Zt("clear"),forEach:gr(!0,!1)},i={get(s){return dr(this,s,!0,!0)},get size(){return pr(this,!0)},has(s){return fr.call(this,s,!0)},add:Zt("add"),set:Zt("set"),delete:Zt("delete"),clear:Zt("clear"),forEach:gr(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=vr(s,!1,!1),n[s]=vr(s,!0,!1),e[s]=vr(s,!1,!0),i[s]=vr(s,!0,!0)}),[t,n,e,i]}const[rd,sd,od,ad]=id();function ns(t,e){const n=e?t?ad:od:t?sd:rd;return(i,r,s)=>r==="__v_isReactive"?!t:r==="__v_isReadonly"?t:r==="__v_raw"?i:Reflect.get(ve(n,r)&&r in i?n:i,r,s)}const ld={get:ns(!1,!1)},hd={get:ns(!1,!0)},cd={get:ns(!0,!1)},ud={get:ns(!0,!0)},eh=new WeakMap,th=new WeakMap,nh=new WeakMap,ih=new WeakMap;function dd(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function fd(t){return t.__v_skip||!Object.isExtensible(t)?0:dd(Ru(t))}function _t(t){return Dn(t)?t:is(t,!1,Ql,ld,eh)}function rh(t){return is(t,!1,td,hd,th)}function Oo(t){return is(t,!0,Zl,cd,nh)}function sh(t){return is(t,!0,nd,ud,ih)}function is(t,e,n,i,r){if(!Se(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const s=r.get(t);if(s)return s;const o=fd(t);if(o===0)return t;const a=new Proxy(t,o===2?i:n);return r.set(t,a),a}function On(t){return Dn(t)?On(t.__v_raw):!!(t&&t.__v_isReactive)}function Dn(t){return!!(t&&t.__v_isReadonly)}function Vi(t){return!!(t&&t.__v_isShallow)}function Ao(t){return On(t)||Dn(t)}function pe(t){const e=t&&t.__v_raw;return e?pe(e):t}function Bn(t){return Hr(t,"__v_skip",!0),t}const Yi=t=>Se(t)?_t(t):t,Io=t=>Se(t)?Oo(t):t;function Ro(t){on&&Ct&&(t=pe(t),Kl(t.dep||(t.dep=Po())))}function rs(t,e){t=pe(t);const n=t.dep;n&&Us(n)}function Be(t){return!!(t&&t.__v_isRef===!0)}function ne(t){return oh(t,!1)}function pd(t){return oh(t,!0)}function oh(t,e){return Be(t)?t:new gd(t,e)}class gd{constructor(e,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?e:pe(e),this._value=n?e:Yi(e)}get value(){return Ro(this),this._value}set value(e){const n=this.__v_isShallow||Vi(e)||Dn(e);e=n?e:pe(e),oi(e,this._rawValue)&&(this._rawValue=e,this._value=n?e:Yi(e),rs(this))}}function vd(t){rs(t)}function Nt(t){return Be(t)?t.value:t}const md={get:(t,e,n)=>Nt(Reflect.get(t,e,n)),set:(t,e,n,i)=>{const r=t[e];return Be(r)&&!Be(n)?(r.value=n,!0):Reflect.set(t,e,n,i)}};function No(t){return On(t)?t:new Proxy(t,md)}class _d{constructor(e){this.dep=void 0,this.__v_isRef=!0;const{get:n,set:i}=e(()=>Ro(this),()=>rs(this));this._get=n,this._set=i}get value(){return this._get()}set value(e){this._set(e)}}function ah(t){return new _d(t)}function lh(t){const e=ee(t)?new Array(t.length):{};for(const n in t)e[n]=vn(t,n);return e}class yd{constructor(e,n,i){this._object=e,this._key=n,this._defaultValue=i,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return Uu(pe(this._object),this._key)}}function vn(t,e,n){const i=t[e];return Be(i)?i:new yd(t,e,n)}var hh;class bd{constructor(e,n,i,r){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this[hh]=!1,this._dirty=!0,this.effect=new or(e,()=>{this._dirty||(this._dirty=!0,rs(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=i}get value(){const e=pe(this);return Ro(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}hh="__v_isReadonly";function wd(t,e,n=!1){let i,r;const s=oe(t);return s?(i=t,r=xt):(i=t.get,r=t.set),new bd(i,r,s||!r,n)}function Cd(t,...e){}function Sd(t,e){}function zt(t,e,n,i){let r;try{r=i?t(...i):t()}catch(s){Hn(s,e,n)}return r}function ct(t,e,n,i){if(oe(t)){const s=zt(t,e,n,i);return s&&xo(s)&&s.catch(o=>{Hn(o,e,n)}),s}const r=[];for(let s=0;s<t.length;s++)r.push(ct(t[s],e,n,i));return r}function Hn(t,e,n,i=!0){const r=e?e.vnode:null;if(e){let s=e.parent;const o=e.proxy,a=n;for(;s;){const h=s.ec;if(h){for(let c=0;c<h.length;c++)if(h[c](t,o,a)===!1)return}s=s.parent}const l=e.appContext.config.errorHandler;if(l){zt(l,null,10,[t,o,a]);return}}xd(t,n,r,i)}function xd(t,e,n,i=!0){console.error(t)}let Xi=!1,js=!1;const Xe=[];let Dt=0;const ni=[];let jt=null,En=0;const ch=Promise.resolve();let Do=null;function vi(t){const e=Do||ch;return t?e.then(this?t.bind(this):t):e}function Ed(t){let e=Dt+1,n=Xe.length;for(;e<n;){const i=e+n>>>1;Ki(Xe[i])<t?e=i+1:n=i}return e}function ss(t){(!Xe.length||!Xe.includes(t,Xi&&t.allowRecurse?Dt+1:Dt))&&(t.id==null?Xe.push(t):Xe.splice(Ed(t.id),0,t),uh())}function uh(){!Xi&&!js&&(js=!0,Do=ch.then(dh))}function Td(t){const e=Xe.indexOf(t);e>Dt&&Xe.splice(e,1)}function Lo(t){ee(t)?ni.push(...t):(!jt||!jt.includes(t,t.allowRecurse?En+1:En))&&ni.push(t),uh()}function ya(t,e=Xi?Dt+1:0){for(;e<Xe.length;e++){const n=Xe[e];n&&n.pre&&(Xe.splice(e,1),e--,n())}}function zr(t){if(ni.length){const e=[...new Set(ni)];if(ni.length=0,jt){jt.push(...e);return}for(jt=e,jt.sort((n,i)=>Ki(n)-Ki(i)),En=0;En<jt.length;En++)jt[En]();jt=null,En=0}}const Ki=t=>t.id==null?1/0:t.id,kd=(t,e)=>{const n=Ki(t)-Ki(e);if(n===0){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return n};function dh(t){js=!1,Xi=!0,Xe.sort(kd);const e=xt;try{for(Dt=0;Dt<Xe.length;Dt++){const n=Xe[Dt];n&&n.active!==!1&&zt(n,null,14)}}finally{Dt=0,Xe.length=0,zr(),Xi=!1,Do=null,(Xe.length||ni.length)&&dh()}}let Jn,mr=[];function fh(t,e){var n,i;Jn=t,Jn?(Jn.enabled=!0,mr.forEach(({event:r,args:s})=>Jn.emit(r,...s)),mr=[]):typeof window<"u"&&window.HTMLElement&&!(!((i=(n=window.navigator)===null||n===void 0?void 0:n.userAgent)===null||i===void 0)&&i.includes("jsdom"))?((e.__VUE_DEVTOOLS_HOOK_REPLAY__=e.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(s=>{fh(s,e)}),setTimeout(()=>{Jn||(e.__VUE_DEVTOOLS_HOOK_REPLAY__=null,mr=[])},3e3)):mr=[]}function Pd(t,e,...n){if(t.isUnmounted)return;const i=t.vnode.props||Ce;let r=n;const s=e.startsWith("update:"),o=s&&e.slice(7);if(o&&o in i){const c=`${o==="modelValue"?"model":o}Modifiers`,{number:u,trim:d}=i[c]||Ce;d&&(r=n.map(p=>Me(p)?p.trim():p)),u&&(r=n.map(Ur))}let a,l=i[a=Gi(e)]||i[a=Gi(it(e))];!l&&s&&(l=i[a=Gi(gt(e))]),l&&ct(l,t,6,r);const h=i[a+"Once"];if(h){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,ct(h,t,6,r)}}function ph(t,e,n=!1){const i=e.emitsCache,r=i.get(t);if(r!==void 0)return r;const s=t.emits;let o={},a=!1;if(!oe(t)){const l=h=>{const c=ph(h,e,!0);c&&(a=!0,De(o,c))};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!s&&!a?(Se(t)&&i.set(t,null),null):(ee(s)?s.forEach(l=>o[l]=null):De(o,s),Se(t)&&i.set(t,o),o)}function os(t,e){return!t||!rr(e)?!1:(e=e.slice(2).replace(/Once$/,""),ve(t,e[0].toLowerCase()+e.slice(1))||ve(t,gt(e))||ve(t,e))}let Ve=null,as=null;function qi(t){const e=Ve;return Ve=t,as=t&&t.type.__scopeId||null,e}function Md(t){as=t}function Od(){as=null}const Ad=t=>Yt;function Yt(t,e=Ve,n){if(!e||t._n)return t;const i=(...r)=>{i._d&&qs(-1);const s=qi(e);let o;try{o=t(...r)}finally{qi(s),i._d&&qs(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function Lr(t){const{type:e,vnode:n,proxy:i,withProxy:r,props:s,propsOptions:[o],slots:a,attrs:l,emit:h,render:c,renderCache:u,data:d,setupState:p,ctx:f,inheritAttrs:v}=t;let _,y;const g=qi(t);try{if(n.shapeFlag&4){const S=r||i;_=lt(c.call(S,S,u,s,p,d,f)),y=l}else{const S=e;_=lt(S.length>1?S(s,{attrs:l,slots:a,emit:h}):S(s,null)),y=e.props?l:Rd(l)}}catch(S){Bi.length=0,Hn(S,t,1),_=le(qe)}let m=_;if(y&&v!==!1){const S=Object.keys(y),{shapeFlag:P}=m;S.length&&P&7&&(o&&S.some(Co)&&(y=Nd(y,o)),m=Gt(m,y))}return n.dirs&&(m=Gt(m),m.dirs=m.dirs?m.dirs.concat(n.dirs):n.dirs),n.transition&&(m.transition=n.transition),_=m,qi(g),_}function Id(t){let e;for(let n=0;n<t.length;n++){const i=t[n];if(dn(i)){if(i.type!==qe||i.children==="v-if"){if(e)return;e=i}}else return}return e}const Rd=t=>{let e;for(const n in t)(n==="class"||n==="style"||rr(n))&&((e||(e={}))[n]=t[n]);return e},Nd=(t,e)=>{const n={};for(const i in t)(!Co(i)||!(i.slice(9)in e))&&(n[i]=t[i]);return n};function Dd(t,e,n){const{props:i,children:r,component:s}=t,{props:o,children:a,patchFlag:l}=e,h=s.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return i?ba(i,o,h):!!o;if(l&8){const c=e.dynamicProps;for(let u=0;u<c.length;u++){const d=c[u];if(o[d]!==i[d]&&!os(h,d))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:i===o?!1:i?o?ba(i,o,h):!0:!!o;return!1}function ba(t,e,n){const i=Object.keys(e);if(i.length!==Object.keys(t).length)return!0;for(let r=0;r<i.length;r++){const s=i[r];if(e[s]!==t[s]&&!os(n,s))return!0}return!1}function Go({vnode:t,parent:e},n){for(;e&&e.subTree===t;)(t=e.vnode).el=n,e=e.parent}const gh=t=>t.__isSuspense,Ld={name:"Suspense",__isSuspense:!0,process(t,e,n,i,r,s,o,a,l,h){t==null?Fd(e,n,i,r,s,o,a,l,h):$d(t,e,n,i,r,o,a,l,h)},hydrate:Bd,create:Fo,normalize:Hd},Gd=Ld;function Ji(t,e){const n=t.props&&t.props[e];oe(n)&&n()}function Fd(t,e,n,i,r,s,o,a,l){const{p:h,o:{createElement:c}}=l,u=c("div"),d=t.suspense=Fo(t,r,i,e,u,n,s,o,a,l);h(null,d.pendingBranch=t.ssContent,u,null,i,d,s,o),d.deps>0?(Ji(t,"onPending"),Ji(t,"onFallback"),h(null,t.ssFallback,e,n,i,null,s,o),ii(d,t.ssFallback)):d.resolve()}function $d(t,e,n,i,r,s,o,a,{p:l,um:h,o:{createElement:c}}){const u=e.suspense=t.suspense;u.vnode=e,e.el=t.el;const d=e.ssContent,p=e.ssFallback,{activeBranch:f,pendingBranch:v,isInFallback:_,isHydrating:y}=u;if(v)u.pendingBranch=d,St(d,v)?(l(v,d,u.hiddenContainer,null,r,u,s,o,a),u.deps<=0?u.resolve():_&&(l(f,p,n,i,r,null,s,o,a),ii(u,p))):(u.pendingId++,y?(u.isHydrating=!1,u.activeBranch=v):h(v,r,u),u.deps=0,u.effects.length=0,u.hiddenContainer=c("div"),_?(l(null,d,u.hiddenContainer,null,r,u,s,o,a),u.deps<=0?u.resolve():(l(f,p,n,i,r,null,s,o,a),ii(u,p))):f&&St(d,f)?(l(f,d,n,i,r,u,s,o,a),u.resolve(!0)):(l(null,d,u.hiddenContainer,null,r,u,s,o,a),u.deps<=0&&u.resolve()));else if(f&&St(d,f))l(f,d,n,i,r,u,s,o,a),ii(u,d);else if(Ji(e,"onPending"),u.pendingBranch=d,u.pendingId++,l(null,d,u.hiddenContainer,null,r,u,s,o,a),u.deps<=0)u.resolve();else{const{timeout:g,pendingId:m}=u;g>0?setTimeout(()=>{u.pendingId===m&&u.fallback(p)},g):g===0&&u.fallback(p)}}function Fo(t,e,n,i,r,s,o,a,l,h,c=!1){const{p:u,m:d,um:p,n:f,o:{parentNode:v,remove:_}}=h,y=t.props?jr(t.props.timeout):void 0,g={vnode:t,parent:e,parentComponent:n,isSVG:o,container:i,hiddenContainer:r,anchor:s,deps:0,pendingId:0,timeout:typeof y=="number"?y:-1,activeBranch:null,pendingBranch:null,isInFallback:!0,isHydrating:c,isUnmounted:!1,effects:[],resolve(m=!1){const{vnode:S,activeBranch:P,pendingBranch:k,pendingId:x,effects:C,parentComponent:M,container:I}=g;if(g.isHydrating)g.isHydrating=!1;else if(!m){const A=P&&k.transition&&k.transition.mode==="out-in";A&&(P.transition.afterLeave=()=>{x===g.pendingId&&d(k,I,O,0)});let{anchor:O}=g;P&&(O=f(P),p(P,M,g,!0)),A||d(k,I,O,0)}ii(g,k),g.pendingBranch=null,g.isInFallback=!1;let N=g.parent,D=!1;for(;N;){if(N.pendingBranch){N.effects.push(...C),D=!0;break}N=N.parent}D||Lo(C),g.effects=[],Ji(S,"onResolve")},fallback(m){if(!g.pendingBranch)return;const{vnode:S,activeBranch:P,parentComponent:k,container:x,isSVG:C}=g;Ji(S,"onFallback");const M=f(P),I=()=>{g.isInFallback&&(u(null,m,x,M,k,null,C,a,l),ii(g,m))},N=m.transition&&m.transition.mode==="out-in";N&&(P.transition.afterLeave=I),g.isInFallback=!0,p(P,k,null,!0),N||I()},move(m,S,P){g.activeBranch&&d(g.activeBranch,m,S,P),g.container=m},next(){return g.activeBranch&&f(g.activeBranch)},registerDep(m,S){const P=!!g.pendingBranch;P&&g.deps++;const k=m.vnode.el;m.asyncDep.catch(x=>{Hn(x,m,0)}).then(x=>{if(m.isUnmounted||g.isUnmounted||g.pendingId!==m.suspenseId)return;m.asyncResolved=!0;const{vnode:C}=m;Js(m,x,!1),k&&(C.el=k);const M=!k&&m.subTree.el;S(m,C,v(k||m.subTree.el),k?null:f(m.subTree),g,o,l),M&&_(M),Go(m,C.el),P&&--g.deps===0&&g.resolve()})},unmount(m,S){g.isUnmounted=!0,g.activeBranch&&p(g.activeBranch,n,m,S),g.pendingBranch&&p(g.pendingBranch,n,m,S)}};return g}function Bd(t,e,n,i,r,s,o,a,l){const h=e.suspense=Fo(e,i,n,t.parentNode,document.createElement("div"),null,r,s,o,a,!0),c=l(t,h.pendingBranch=e.ssContent,n,h,s,o);return h.deps===0&&h.resolve(),c}function Hd(t){const{shapeFlag:e,children:n}=t,i=e&32;t.ssContent=wa(i?n.default:n),t.ssFallback=i?wa(n.fallback):le(qe)}function wa(t){let e;if(oe(t)){const n=Fn&&t._c;n&&(t._d=!1,W()),t=t(),n&&(t._d=!0,e=nt,Uh())}return ee(t)&&(t=Id(t)),t=lt(t),e&&!t.dynamicChildren&&(t.dynamicChildren=e.filter(n=>n!==t)),t}function vh(t,e){e&&e.pendingBranch?ee(t)?e.effects.push(...t):e.effects.push(t):Lo(t)}function ii(t,e){t.activeBranch=e;const{vnode:n,parentComponent:i}=t,r=n.el=e.el;i&&i.subTree===n&&(i.vnode.el=r,Go(i,r))}function ls(t,e){if(Ne){let n=Ne.provides;const i=Ne.parent&&Ne.parent.provides;i===n&&(n=Ne.provides=Object.create(i)),n[t]=e}}function An(t,e,n=!1){const i=Ne||Ve;if(i){const r=i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides;if(r&&t in r)return r[t];if(arguments.length>1)return n&&oe(e)?e.call(i.proxy):e}}function Ud(t,e){return ar(t,null,e)}function mh(t,e){return ar(t,null,{flush:"post"})}function jd(t,e){return ar(t,null,{flush:"sync"})}const _r={};function Et(t,e,n){return ar(t,e,n)}function ar(t,e,{immediate:n,deep:i,flush:r,onTrack:s,onTrigger:o}=Ce){const a=ko()===(Ne==null?void 0:Ne.scope)?Ne:null;let l,h=!1,c=!1;if(Be(t)?(l=()=>t.value,h=Vi(t)):On(t)?(l=()=>t,i=!0):ee(t)?(c=!0,h=t.some(m=>On(m)||Vi(m)),l=()=>t.map(m=>{if(Be(m))return m.value;if(On(m))return kn(m);if(oe(m))return zt(m,a,2)})):oe(t)?e?l=()=>zt(t,a,2):l=()=>{if(!(a&&a.isUnmounted))return u&&u(),ct(t,a,3,[d])}:l=xt,e&&i){const m=l;l=()=>kn(m())}let u,d=m=>{u=y.onStop=()=>{zt(m,a,4)}},p;if(li)if(d=xt,e?n&&ct(e,a,3,[l(),c?[]:void 0,d]):l(),r==="sync"){const m=tc();p=m.__watcherHandles||(m.__watcherHandles=[])}else return xt;let f=c?new Array(t.length).fill(_r):_r;const v=()=>{if(y.active)if(e){const m=y.run();(i||h||(c?m.some((S,P)=>oi(S,f[P])):oi(m,f)))&&(u&&u(),ct(e,a,3,[m,f===_r?void 0:c&&f[0]===_r?[]:f,d]),f=m)}else y.run()};v.allowRecurse=!!e;let _;r==="sync"?_=v:r==="post"?_=()=>ze(v,a&&a.suspense):(v.pre=!0,a&&(v.id=a.uid),_=()=>ss(v));const y=new or(l,_);e?n?v():f=y.run():r==="post"?ze(y.run.bind(y),a&&a.suspense):y.run();const g=()=>{y.stop(),a&&a.scope&&So(a.scope.effects,y)};return p&&p.push(g),g}function Wd(t,e,n){const i=this.proxy,r=Me(t)?t.includes(".")?_h(i,t):()=>i[t]:t.bind(i,i);let s;oe(e)?s=e:(s=e.handler,n=e);const o=Ne;fn(this);const a=ar(r,s.bind(i),n);return o?fn(o):an(),a}function _h(t,e){const n=e.split(".");return()=>{let i=t;for(let r=0;r<n.length&&i;r++)i=i[n[r]];return i}}function kn(t,e){if(!Se(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),Be(t))kn(t.value,e);else if(ee(t))for(let n=0;n<t.length;n++)kn(t[n],e);else if($n(t)||ei(t))t.forEach(n=>{kn(n,e)});else if(jl(t))for(const n in t)kn(t[n],e);return t}function $o(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Kt(()=>{t.isMounted=!0}),hr(()=>{t.isUnmounting=!0}),t}const pt=[Function,Array],zd={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:pt,onEnter:pt,onAfterEnter:pt,onEnterCancelled:pt,onBeforeLeave:pt,onLeave:pt,onAfterLeave:pt,onLeaveCancelled:pt,onBeforeAppear:pt,onAppear:pt,onAfterAppear:pt,onAppearCancelled:pt},setup(t,{slots:e}){const n=mn(),i=$o();let r;return()=>{const s=e.default&&hs(e.default(),!0);if(!s||!s.length)return;let o=s[0];if(s.length>1){for(const v of s)if(v.type!==qe){o=v;break}}const a=pe(t),{mode:l}=a;if(i.isLeaving)return Ss(o);const h=Ca(o);if(!h)return Ss(o);const c=ai(h,a,i,n);Ln(h,c);const u=n.subTree,d=u&&Ca(u);let p=!1;const{getTransitionKey:f}=h.type;if(f){const v=f();r===void 0?r=v:v!==r&&(r=v,p=!0)}if(d&&d.type!==qe&&(!St(h,d)||p)){const v=ai(d,a,i,n);if(Ln(d,v),l==="out-in")return i.isLeaving=!0,v.afterLeave=()=>{i.isLeaving=!1,n.update.active!==!1&&n.update()},Ss(o);l==="in-out"&&h.type!==qe&&(v.delayLeave=(_,y,g)=>{const m=yh(i,d);m[String(d.key)]=d,_._leaveCb=()=>{y(),_._leaveCb=void 0,delete c.delayedLeave},c.delayedLeave=g})}return o}}},Bo=zd;function yh(t,e){const{leavingVNodes:n}=t;let i=n.get(e.type);return i||(i=Object.create(null),n.set(e.type,i)),i}function ai(t,e,n,i){const{appear:r,mode:s,persisted:o=!1,onBeforeEnter:a,onEnter:l,onAfterEnter:h,onEnterCancelled:c,onBeforeLeave:u,onLeave:d,onAfterLeave:p,onLeaveCancelled:f,onBeforeAppear:v,onAppear:_,onAfterAppear:y,onAppearCancelled:g}=e,m=String(t.key),S=yh(n,t),P=(C,M)=>{C&&ct(C,i,9,M)},k=(C,M)=>{const I=M[1];P(C,M),ee(C)?C.every(N=>N.length<=1)&&I():C.length<=1&&I()},x={mode:s,persisted:o,beforeEnter(C){let M=a;if(!n.isMounted)if(r)M=v||a;else return;C._leaveCb&&C._leaveCb(!0);const I=S[m];I&&St(t,I)&&I.el._leaveCb&&I.el._leaveCb(),P(M,[C])},enter(C){let M=l,I=h,N=c;if(!n.isMounted)if(r)M=_||l,I=y||h,N=g||c;else return;let D=!1;const A=C._enterCb=O=>{D||(D=!0,O?P(N,[C]):P(I,[C]),x.delayedLeave&&x.delayedLeave(),C._enterCb=void 0)};M?k(M,[C,A]):A()},leave(C,M){const I=String(t.key);if(C._enterCb&&C._enterCb(!0),n.isUnmounting)return M();P(u,[C]);let N=!1;const D=C._leaveCb=A=>{N||(N=!0,M(),A?P(f,[C]):P(p,[C]),C._leaveCb=void 0,S[I]===t&&delete S[I])};S[I]=t,d?k(d,[C,D]):D()},clone(C){return ai(C,e,n,i)}};return x}function Ss(t){if(lr(t))return t=Gt(t),t.children=null,t}function Ca(t){return lr(t)?t.children?t.children[0]:void 0:t}function Ln(t,e){t.shapeFlag&6&&t.component?Ln(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function hs(t,e=!1,n){let i=[],r=0;for(let s=0;s<t.length;s++){let o=t[s];const a=n==null?o.key:String(n)+String(o.key!=null?o.key:s);o.type===ge?(o.patchFlag&128&&r++,i=i.concat(hs(o.children,e,a))):(e||o.type!==qe)&&i.push(a!=null?Gt(o,{key:a}):o)}if(r>1)for(let s=0;s<i.length;s++)i[s].patchFlag=-2;return i}function xe(t){return oe(t)?{setup:t,name:t.name}:t}const In=t=>!!t.type.__asyncLoader;function Vd(t){oe(t)&&(t={loader:t});const{loader:e,loadingComponent:n,errorComponent:i,delay:r=200,timeout:s,suspensible:o=!0,onError:a}=t;let l=null,h,c=0;const u=()=>(c++,l=null,d()),d=()=>{let p;return l||(p=l=e().catch(f=>{if(f=f instanceof Error?f:new Error(String(f)),a)return new Promise((v,_)=>{a(f,()=>v(u()),()=>_(f),c+1)});throw f}).then(f=>p!==l&&l?l:(f&&(f.__esModule||f[Symbol.toStringTag]==="Module")&&(f=f.default),h=f,f)))};return xe({name:"AsyncComponentWrapper",__asyncLoader:d,get __asyncResolved(){return h},setup(){const p=Ne;if(h)return()=>xs(h,p);const f=g=>{l=null,Hn(g,p,13,!i)};if(o&&p.suspense||li)return d().then(g=>()=>xs(g,p)).catch(g=>(f(g),()=>i?le(i,{error:g}):null));const v=ne(!1),_=ne(),y=ne(!!r);return r&&setTimeout(()=>{y.value=!1},r),s!=null&&setTimeout(()=>{if(!v.value&&!_.value){const g=new Error(`Async component timed out after ${s}ms.`);f(g),_.value=g}},s),d().then(()=>{v.value=!0,p.parent&&lr(p.parent.vnode)&&ss(p.parent.update)}).catch(g=>{f(g),_.value=g}),()=>{if(v.value&&h)return xs(h,p);if(_.value&&i)return le(i,{error:_.value});if(n&&!y.value)return le(n)}}})}function xs(t,e){const{ref:n,props:i,children:r,ce:s}=e.vnode,o=le(t,i,r);return o.ref=n,o.ce=s,delete e.vnode.ce,o}const lr=t=>t.type.__isKeepAlive,Yd={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(t,{slots:e}){const n=mn(),i=n.ctx;if(!i.renderer)return()=>{const g=e.default&&e.default();return g&&g.length===1?g[0]:g};const r=new Map,s=new Set;let o=null;const a=n.suspense,{renderer:{p:l,m:h,um:c,o:{createElement:u}}}=i,d=u("div");i.activate=(g,m,S,P,k)=>{const x=g.component;h(g,m,S,0,a),l(x.vnode,g,m,S,x,a,P,g.slotScopeIds,k),ze(()=>{x.isDeactivated=!1,x.a&&ti(x.a);const C=g.props&&g.props.onVnodeMounted;C&&tt(C,x.parent,g)},a)},i.deactivate=g=>{const m=g.component;h(g,d,null,1,a),ze(()=>{m.da&&ti(m.da);const S=g.props&&g.props.onVnodeUnmounted;S&&tt(S,m.parent,g),m.isDeactivated=!0},a)};function p(g){Es(g),c(g,n,a,!0)}function f(g){r.forEach((m,S)=>{const P=Zs(m.type);P&&(!g||!g(P))&&v(S)})}function v(g){const m=r.get(g);!o||!St(m,o)?p(m):o&&Es(o),r.delete(g),s.delete(g)}Et(()=>[t.include,t.exclude],([g,m])=>{g&&f(S=>Oi(g,S)),m&&f(S=>!Oi(m,S))},{flush:"post",deep:!0});let _=null;const y=()=>{_!=null&&r.set(_,Ts(n.subTree))};return Kt(y),mi(y),hr(()=>{r.forEach(g=>{const{subTree:m,suspense:S}=n,P=Ts(m);if(g.type===P.type&&g.key===P.key){Es(P);const k=P.component.da;k&&ze(k,S);return}p(g)})}),()=>{if(_=null,!e.default)return null;const g=e.default(),m=g[0];if(g.length>1)return o=null,g;if(!dn(m)||!(m.shapeFlag&4)&&!(m.shapeFlag&128))return o=null,m;let S=Ts(m);const P=S.type,k=Zs(In(S)?S.type.__asyncResolved||{}:P),{include:x,exclude:C,max:M}=t;if(x&&(!k||!Oi(x,k))||C&&k&&Oi(C,k))return o=S,m;const I=S.key==null?P:S.key,N=r.get(I);return S.el&&(S=Gt(S),m.shapeFlag&128&&(m.ssContent=S)),_=I,N?(S.el=N.el,S.component=N.component,S.transition&&Ln(S,S.transition),S.shapeFlag|=512,s.delete(I),s.add(I)):(s.add(I),M&&s.size>parseInt(M,10)&&v(s.values().next().value)),S.shapeFlag|=256,o=S,gh(m.type)?m:S}}},Xd=Yd;function Oi(t,e){return ee(t)?t.some(n=>Oi(n,e)):Me(t)?t.split(",").includes(e):Iu(t)?t.test(e):!1}function bh(t,e){Ch(t,"a",e)}function wh(t,e){Ch(t,"da",e)}function Ch(t,e,n=Ne){const i=t.__wdc||(t.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return t()});if(cs(e,i,n),n){let r=n.parent;for(;r&&r.parent;)lr(r.parent.vnode)&&Kd(i,e,n,r),r=r.parent}}function Kd(t,e,n,i){const r=cs(e,t,i,!0);us(()=>{So(i[e],r)},n)}function Es(t){t.shapeFlag&=-257,t.shapeFlag&=-513}function Ts(t){return t.shapeFlag&128?t.ssContent:t}function cs(t,e,n=Ne,i=!1){if(n){const r=n[t]||(n[t]=[]),s=e.__weh||(e.__weh=(...o)=>{if(n.isUnmounted)return;pi(),fn(n);const a=ct(e,n,t,o);return an(),gi(),a});return i?r.unshift(s):r.push(s),s}}const Xt=t=>(e,n=Ne)=>(!li||t==="sp")&&cs(t,(...i)=>e(...i),n),Sh=Xt("bm"),Kt=Xt("m"),xh=Xt("bu"),mi=Xt("u"),hr=Xt("bum"),us=Xt("um"),Eh=Xt("sp"),Th=Xt("rtg"),kh=Xt("rtc");function Ph(t,e=Ne){cs("ec",t,e)}function un(t,e){const n=Ve;if(n===null)return t;const i=gs(n)||n.proxy,r=t.dirs||(t.dirs=[]);for(let s=0;s<e.length;s++){let[o,a,l,h=Ce]=e[s];o&&(oe(o)&&(o={mounted:o,updated:o}),o.deep&&kn(a),r.push({dir:o,instance:i,value:a,oldValue:void 0,arg:l,modifiers:h}))}return t}function It(t,e,n,i){const r=t.dirs,s=e&&e.dirs;for(let o=0;o<r.length;o++){const a=r[o];s&&(a.oldValue=s[o].value);let l=a.dir[i];l&&(pi(),ct(l,n,8,[t.el,a,t,e]),gi())}}const Ho="components",qd="directives";function Ge(t,e){return Uo(Ho,t,!0,e)||t}const Mh=Symbol();function ds(t){return Me(t)?Uo(Ho,t,!1)||t:t||Mh}function Jd(t){return Uo(qd,t)}function Uo(t,e,n=!0,i=!1){const r=Ve||Ne;if(r){const s=r.type;if(t===Ho){const a=Zs(s,!1);if(a&&(a===e||a===it(e)||a===sr(it(e))))return s}const o=Sa(r[t]||s[t],e)||Sa(r.appContext[t],e);return!o&&i?s:o}}function Sa(t,e){return t&&(t[e]||t[it(e)]||t[sr(it(e))])}function st(t,e,n,i){let r;const s=n&&n[i];if(ee(t)||Me(t)){r=new Array(t.length);for(let o=0,a=t.length;o<a;o++)r[o]=e(t[o],o,void 0,s&&s[o])}else if(typeof t=="number"){r=new Array(t);for(let o=0;o<t;o++)r[o]=e(o+1,o,void 0,s&&s[o])}else if(Se(t))if(t[Symbol.iterator])r=Array.from(t,(o,a)=>e(o,a,void 0,s&&s[a]));else{const o=Object.keys(t);r=new Array(o.length);for(let a=0,l=o.length;a<l;a++){const h=o[a];r[a]=e(t[h],h,a,s&&s[a])}}else r=[];return n&&(n[i]=r),r}function Qd(t,e){for(let n=0;n<e.length;n++){const i=e[n];if(ee(i))for(let r=0;r<i.length;r++)t[i[r].name]=i[r].fn;else i&&(t[i.name]=i.key?(...r)=>{const s=i.fn(...r);return s&&(s.key=i.key),s}:i.fn)}return t}function Bt(t,e,n={},i,r){if(Ve.isCE||Ve.parent&&In(Ve.parent)&&Ve.parent.isCE)return e!=="default"&&(n.name=e),le("slot",n,i&&i());let s=t[e];s&&s._c&&(s._d=!1),W();const o=s&&Oh(s(n)),a=Fe(ge,{key:n.key||o&&o.key||`_${e}`},o||(i?i():[]),o&&t._===1?64:-2);return!r&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),s&&s._c&&(s._d=!0),a}function Oh(t){return t.some(e=>dn(e)?!(e.type===qe||e.type===ge&&!Oh(e.children)):!0)?t:null}function Zd(t,e){const n={};for(const i in t)n[e&&/[A-Z]/.test(i)?`on:${i}`:Gi(i)]=t[i];return n}const Ws=t=>t?Xh(t)?gs(t)||t.proxy:Ws(t.parent):null,Fi=De(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Ws(t.parent),$root:t=>Ws(t.root),$emit:t=>t.emit,$options:t=>jo(t),$forceUpdate:t=>t.f||(t.f=()=>ss(t.update)),$nextTick:t=>t.n||(t.n=vi.bind(t.proxy)),$watch:t=>Wd.bind(t)}),ks=(t,e)=>t!==Ce&&!t.__isScriptSetup&&ve(t,e),zs={get({_:t},e){const{ctx:n,setupState:i,data:r,props:s,accessCache:o,type:a,appContext:l}=t;let h;if(e[0]!=="$"){const p=o[e];if(p!==void 0)switch(p){case 1:return i[e];case 2:return r[e];case 4:return n[e];case 3:return s[e]}else{if(ks(i,e))return o[e]=1,i[e];if(r!==Ce&&ve(r,e))return o[e]=2,r[e];if((h=t.propsOptions[0])&&ve(h,e))return o[e]=3,s[e];if(n!==Ce&&ve(n,e))return o[e]=4,n[e];Vs&&(o[e]=0)}}const c=Fi[e];let u,d;if(c)return e==="$attrs"&&rt(t,"get",e),c(t);if((u=a.__cssModules)&&(u=u[e]))return u;if(n!==Ce&&ve(n,e))return o[e]=4,n[e];if(d=l.config.globalProperties,ve(d,e))return d[e]},set({_:t},e,n){const{data:i,setupState:r,ctx:s}=t;return ks(r,e)?(r[e]=n,!0):i!==Ce&&ve(i,e)?(i[e]=n,!0):ve(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(s[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:i,appContext:r,propsOptions:s}},o){let a;return!!n[o]||t!==Ce&&ve(t,o)||ks(e,o)||(a=s[0])&&ve(a,o)||ve(i,o)||ve(Fi,o)||ve(r.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:ve(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}},ef=De({},zs,{get(t,e){if(e!==Symbol.unscopables)return zs.get(t,e,t)},has(t,e){return e[0]!=="_"&&!bu(e)}});let Vs=!0;function tf(t){const e=jo(t),n=t.proxy,i=t.ctx;Vs=!1,e.beforeCreate&&xa(e.beforeCreate,t,"bc");const{data:r,computed:s,methods:o,watch:a,provide:l,inject:h,created:c,beforeMount:u,mounted:d,beforeUpdate:p,updated:f,activated:v,deactivated:_,beforeDestroy:y,beforeUnmount:g,destroyed:m,unmounted:S,render:P,renderTracked:k,renderTriggered:x,errorCaptured:C,serverPrefetch:M,expose:I,inheritAttrs:N,components:D,directives:A,filters:O}=e;if(h&&nf(h,i,null,t.appContext.config.unwrapInjectedRef),o)for(const K in o){const ie=o[K];oe(ie)&&(i[K]=ie.bind(n))}if(r){const K=r.call(n,n);Se(K)&&(t.data=_t(K))}if(Vs=!0,s)for(const K in s){const ie=s[K],ue=oe(ie)?ie.bind(n,n):oe(ie.get)?ie.get.bind(n,n):xt,Z=!oe(ie)&&oe(ie.set)?ie.set.bind(n):xt,ce=he({get:ue,set:Z});Object.defineProperty(i,K,{enumerable:!0,configurable:!0,get:()=>ce.value,set:fe=>ce.value=fe})}if(a)for(const K in a)Ah(a[K],i,n,K);if(l){const K=oe(l)?l.call(n):l;Reflect.ownKeys(K).forEach(ie=>{ls(ie,K[ie])})}c&&xa(c,t,"c");function $(K,ie){ee(ie)?ie.forEach(ue=>K(ue.bind(n))):ie&&K(ie.bind(n))}if($(Sh,u),$(Kt,d),$(xh,p),$(mi,f),$(bh,v),$(wh,_),$(Ph,C),$(kh,k),$(Th,x),$(hr,g),$(us,S),$(Eh,M),ee(I))if(I.length){const K=t.exposed||(t.exposed={});I.forEach(ie=>{Object.defineProperty(K,ie,{get:()=>n[ie],set:ue=>n[ie]=ue})})}else t.exposed||(t.exposed={});P&&t.render===xt&&(t.render=P),N!=null&&(t.inheritAttrs=N),D&&(t.components=D),A&&(t.directives=A)}function nf(t,e,n=xt,i=!1){ee(t)&&(t=Ys(t));for(const r in t){const s=t[r];let o;Se(s)?"default"in s?o=An(s.from||r,s.default,!0):o=An(s.from||r):o=An(s),Be(o)&&i?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>o.value,set:a=>o.value=a}):e[r]=o}}function xa(t,e,n){ct(ee(t)?t.map(i=>i.bind(e.proxy)):t.bind(e.proxy),e,n)}function Ah(t,e,n,i){const r=i.includes(".")?_h(n,i):()=>n[i];if(Me(t)){const s=e[t];oe(s)&&Et(r,s)}else if(oe(t))Et(r,t.bind(n));else if(Se(t))if(ee(t))t.forEach(s=>Ah(s,e,n,i));else{const s=oe(t.handler)?t.handler.bind(n):e[t.handler];oe(s)&&Et(r,s,t)}}function jo(t){const e=t.type,{mixins:n,extends:i}=e,{mixins:r,optionsCache:s,config:{optionMergeStrategies:o}}=t.appContext,a=s.get(e);let l;return a?l=a:!r.length&&!n&&!i?l=e:(l={},r.length&&r.forEach(h=>Vr(l,h,o,!0)),Vr(l,e,o)),Se(e)&&s.set(e,l),l}function Vr(t,e,n,i=!1){const{mixins:r,extends:s}=e;s&&Vr(t,s,n,!0),r&&r.forEach(o=>Vr(t,o,n,!0));for(const o in e)if(!(i&&o==="expose")){const a=rf[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const rf={data:Ea,props:xn,emits:xn,methods:xn,computed:xn,beforeCreate:Je,created:Je,beforeMount:Je,mounted:Je,beforeUpdate:Je,updated:Je,beforeDestroy:Je,beforeUnmount:Je,destroyed:Je,unmounted:Je,activated:Je,deactivated:Je,errorCaptured:Je,serverPrefetch:Je,components:xn,directives:xn,watch:of,provide:Ea,inject:sf};function Ea(t,e){return e?t?function(){return De(oe(t)?t.call(this,this):t,oe(e)?e.call(this,this):e)}:e:t}function sf(t,e){return xn(Ys(t),Ys(e))}function Ys(t){if(ee(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function Je(t,e){return t?[...new Set([].concat(t,e))]:e}function xn(t,e){return t?De(De(Object.create(null),t),e):e}function of(t,e){if(!t)return e;if(!e)return t;const n=De(Object.create(null),t);for(const i in e)n[i]=Je(t[i],e[i]);return n}function af(t,e,n,i=!1){const r={},s={};Hr(s,fs,1),t.propsDefaults=Object.create(null),Ih(t,e,r,s);for(const o in t.propsOptions[0])o in r||(r[o]=void 0);n?t.props=i?r:rh(r):t.type.props?t.props=r:t.props=s,t.attrs=s}function lf(t,e,n,i){const{props:r,attrs:s,vnode:{patchFlag:o}}=t,a=pe(r),[l]=t.propsOptions;let h=!1;if((i||o>0)&&!(o&16)){if(o&8){const c=t.vnode.dynamicProps;for(let u=0;u<c.length;u++){let d=c[u];if(os(t.emitsOptions,d))continue;const p=e[d];if(l)if(ve(s,d))p!==s[d]&&(s[d]=p,h=!0);else{const f=it(d);r[f]=Xs(l,a,f,p,t,!1)}else p!==s[d]&&(s[d]=p,h=!0)}}}else{Ih(t,e,r,s)&&(h=!0);let c;for(const u in a)(!e||!ve(e,u)&&((c=gt(u))===u||!ve(e,c)))&&(l?n&&(n[u]!==void 0||n[c]!==void 0)&&(r[u]=Xs(l,a,u,void 0,t,!0)):delete r[u]);if(s!==a)for(const u in s)(!e||!ve(e,u))&&(delete s[u],h=!0)}h&&Vt(t,"set","$attrs")}function Ih(t,e,n,i){const[r,s]=t.propsOptions;let o=!1,a;if(e)for(let l in e){if(Li(l))continue;const h=e[l];let c;r&&ve(r,c=it(l))?!s||!s.includes(c)?n[c]=h:(a||(a={}))[c]=h:os(t.emitsOptions,l)||(!(l in i)||h!==i[l])&&(i[l]=h,o=!0)}if(s){const l=pe(n),h=a||Ce;for(let c=0;c<s.length;c++){const u=s[c];n[u]=Xs(r,l,u,h[u],t,!ve(h,u))}}return o}function Xs(t,e,n,i,r,s){const o=t[n];if(o!=null){const a=ve(o,"default");if(a&&i===void 0){const l=o.default;if(o.type!==Function&&oe(l)){const{propsDefaults:h}=r;n in h?i=h[n]:(fn(r),i=h[n]=l.call(null,e),an())}else i=l}o[0]&&(s&&!a?i=!1:o[1]&&(i===""||i===gt(n))&&(i=!0))}return i}function Rh(t,e,n=!1){const i=e.propsCache,r=i.get(t);if(r)return r;const s=t.props,o={},a=[];let l=!1;if(!oe(t)){const c=u=>{l=!0;const[d,p]=Rh(u,e,!0);De(o,d),p&&a.push(...p)};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}if(!s&&!l)return Se(t)&&i.set(t,Zn),Zn;if(ee(s))for(let c=0;c<s.length;c++){const u=it(s[c]);Ta(u)&&(o[u]=Ce)}else if(s)for(const c in s){const u=it(c);if(Ta(u)){const d=s[c],p=o[u]=ee(d)||oe(d)?{type:d}:Object.assign({},d);if(p){const f=Ma(Boolean,p.type),v=Ma(String,p.type);p[0]=f>-1,p[1]=v<0||f<v,(f>-1||ve(p,"default"))&&a.push(u)}}}const h=[o,a];return Se(t)&&i.set(t,h),h}function Ta(t){return t[0]!=="$"}function ka(t){const e=t&&t.toString().match(/^\s*(function|class) (\w+)/);return e?e[2]:t===null?"null":""}function Pa(t,e){return ka(t)===ka(e)}function Ma(t,e){return ee(e)?e.findIndex(n=>Pa(n,t)):oe(e)&&Pa(e,t)?0:-1}const Nh=t=>t[0]==="_"||t==="$stable",Wo=t=>ee(t)?t.map(lt):[lt(t)],hf=(t,e,n)=>{if(e._n)return e;const i=Yt((...r)=>Wo(e(...r)),n);return i._c=!1,i},Dh=(t,e,n)=>{const i=t._ctx;for(const r in t){if(Nh(r))continue;const s=t[r];if(oe(s))e[r]=hf(r,s,i);else if(s!=null){const o=Wo(s);e[r]=()=>o}}},Lh=(t,e)=>{const n=Wo(e);t.slots.default=()=>n},cf=(t,e)=>{if(t.vnode.shapeFlag&32){const n=e._;n?(t.slots=pe(e),Hr(e,"_",n)):Dh(e,t.slots={})}else t.slots={},e&&Lh(t,e);Hr(t.slots,fs,1)},uf=(t,e,n)=>{const{vnode:i,slots:r}=t;let s=!0,o=Ce;if(i.shapeFlag&32){const a=e._;a?n&&a===1?s=!1:(De(r,e),!n&&a===1&&delete r._):(s=!e.$stable,Dh(e,r)),o=e}else e&&(Lh(t,e),o={default:1});if(s)for(const a in r)!Nh(a)&&!(a in o)&&delete r[a]};function Gh(){return{app:null,config:{isNativeTag:Mu,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let df=0;function ff(t,e){return function(i,r=null){oe(i)||(i=Object.assign({},i)),r!=null&&!Se(r)&&(r=null);const s=Gh(),o=new Set;let a=!1;const l=s.app={_uid:df++,_component:i,_props:r,_container:null,_context:s,_instance:null,version:ic,get config(){return s.config},set config(h){},use(h,...c){return o.has(h)||(h&&oe(h.install)?(o.add(h),h.install(l,...c)):oe(h)&&(o.add(h),h(l,...c))),l},mixin(h){return s.mixins.includes(h)||s.mixins.push(h),l},component(h,c){return c?(s.components[h]=c,l):s.components[h]},directive(h,c){return c?(s.directives[h]=c,l):s.directives[h]},mount(h,c,u){if(!a){const d=le(i,r);return d.appContext=s,c&&e?e(d,h):t(d,h,u),a=!0,l._container=h,h.__vue_app__=l,gs(d.component)||d.component.proxy}},unmount(){a&&(t(null,l._container),delete l._container.__vue_app__)},provide(h,c){return s.provides[h]=c,l}};return l}}function Yr(t,e,n,i,r=!1){if(ee(t)){t.forEach((d,p)=>Yr(d,e&&(ee(e)?e[p]:e),n,i,r));return}if(In(i)&&!r)return;const s=i.shapeFlag&4?gs(i.component)||i.component.proxy:i.el,o=r?null:s,{i:a,r:l}=t,h=e&&e.r,c=a.refs===Ce?a.refs={}:a.refs,u=a.setupState;if(h!=null&&h!==l&&(Me(h)?(c[h]=null,ve(u,h)&&(u[h]=null)):Be(h)&&(h.value=null)),oe(l))zt(l,a,12,[o,c]);else{const d=Me(l),p=Be(l);if(d||p){const f=()=>{if(t.f){const v=d?ve(u,l)?u[l]:c[l]:l.value;r?ee(v)&&So(v,s):ee(v)?v.includes(s)||v.push(s):d?(c[l]=[s],ve(u,l)&&(u[l]=c[l])):(l.value=[s],t.k&&(c[t.k]=l.value))}else d?(c[l]=o,ve(u,l)&&(u[l]=o)):p&&(l.value=o,t.k&&(c[t.k]=o))};o?(f.id=-1,ze(f,n)):f()}}}let en=!1;const yr=t=>/svg/.test(t.namespaceURI)&&t.tagName!=="foreignObject",br=t=>t.nodeType===8;function pf(t){const{mt:e,p:n,o:{patchProp:i,createText:r,nextSibling:s,parentNode:o,remove:a,insert:l,createComment:h}}=t,c=(y,g)=>{if(!g.hasChildNodes()){n(null,y,g),zr(),g._vnode=y;return}en=!1,u(g.firstChild,y,null,null,null),zr(),g._vnode=y,en&&console.error("Hydration completed but contains mismatches.")},u=(y,g,m,S,P,k=!1)=>{const x=br(y)&&y.data==="[",C=()=>v(y,g,m,S,P,x),{type:M,ref:I,shapeFlag:N,patchFlag:D}=g;let A=y.nodeType;g.el=y,D===-2&&(k=!1,g.dynamicChildren=null);let O=null;switch(M){case Gn:A!==3?g.children===""?(l(g.el=r(""),o(y),y),O=y):O=C():(y.data!==g.children&&(en=!0,y.data=g.children),O=s(y));break;case qe:A!==8||x?O=C():O=s(y);break;case Rn:if(x&&(y=s(y),A=y.nodeType),A===1||A===3){O=y;const V=!g.children.length;for(let $=0;$<g.staticCount;$++)V&&(g.children+=O.nodeType===1?O.outerHTML:O.data),$===g.staticCount-1&&(g.anchor=O),O=s(O);return x?s(O):O}else C();break;case ge:x?O=f(y,g,m,S,P,k):O=C();break;default:if(N&1)A!==1||g.type.toLowerCase()!==y.tagName.toLowerCase()?O=C():O=d(y,g,m,S,P,k);else if(N&6){g.slotScopeIds=P;const V=o(y);if(e(g,V,null,m,S,yr(V),k),O=x?_(y):s(y),O&&br(O)&&O.data==="teleport end"&&(O=s(O)),In(g)){let $;x?($=le(ge),$.anchor=O?O.previousSibling:V.lastChild):$=y.nodeType===3?ps(""):le("div"),$.el=y,g.component.subTree=$}}else N&64?A!==8?O=C():O=g.type.hydrate(y,g,m,S,P,k,t,p):N&128&&(O=g.type.hydrate(y,g,m,S,yr(o(y)),P,k,t,u))}return I!=null&&Yr(I,null,S,g),O},d=(y,g,m,S,P,k)=>{k=k||!!g.dynamicChildren;const{type:x,props:C,patchFlag:M,shapeFlag:I,dirs:N}=g,D=x==="input"&&N||x==="option";if(D||M!==-1){if(N&&It(g,null,m,"created"),C)if(D||!k||M&48)for(const O in C)(D&&O.endsWith("value")||rr(O)&&!Li(O))&&i(y,O,null,C[O],!1,void 0,m);else C.onClick&&i(y,"onClick",null,C.onClick,!1,void 0,m);let A;if((A=C&&C.onVnodeBeforeMount)&&tt(A,m,g),N&&It(g,null,m,"beforeMount"),((A=C&&C.onVnodeMounted)||N)&&vh(()=>{A&&tt(A,m,g),N&&It(g,null,m,"mounted")},S),I&16&&!(C&&(C.innerHTML||C.textContent))){let O=p(y.firstChild,g,y,m,S,P,k);for(;O;){en=!0;const V=O;O=O.nextSibling,a(V)}}else I&8&&y.textContent!==g.children&&(en=!0,y.textContent=g.children)}return y.nextSibling},p=(y,g,m,S,P,k,x)=>{x=x||!!g.dynamicChildren;const C=g.children,M=C.length;for(let I=0;I<M;I++){const N=x?C[I]:C[I]=lt(C[I]);if(y)y=u(y,N,S,P,k,x);else{if(N.type===Gn&&!N.children)continue;en=!0,n(null,N,m,null,S,P,yr(m),k)}}return y},f=(y,g,m,S,P,k)=>{const{slotScopeIds:x}=g;x&&(P=P?P.concat(x):x);const C=o(y),M=p(s(y),g,C,m,S,P,k);return M&&br(M)&&M.data==="]"?s(g.anchor=M):(en=!0,l(g.anchor=h("]"),C,M),M)},v=(y,g,m,S,P,k)=>{if(en=!0,g.el=null,k){const M=_(y);for(;;){const I=s(y);if(I&&I!==M)a(I);else break}}const x=s(y),C=o(y);return a(y),n(null,g,C,x,m,S,yr(C),P),x},_=y=>{let g=0;for(;y;)if(y=s(y),y&&br(y)&&(y.data==="["&&g++,y.data==="]")){if(g===0)return s(y);g--}return y};return[c,u]}const ze=vh;function Fh(t){return Bh(t)}function $h(t){return Bh(t,pf)}function Bh(t,e){const n=Lu();n.__VUE__=!0;const{insert:i,remove:r,patchProp:s,createElement:o,createText:a,createComment:l,setText:h,setElementText:c,parentNode:u,nextSibling:d,setScopeId:p=xt,insertStaticContent:f}=t,v=(w,E,R,G=null,L=null,z=null,X=!1,j=null,Y=!!E.dynamicChildren)=>{if(w===E)return;w&&!St(w,E)&&(G=bt(w),fe(w,L,z,!0),w=null),E.patchFlag===-2&&(Y=!1,E.dynamicChildren=null);const{type:B,ref:re,shapeFlag:te}=E;switch(B){case Gn:_(w,E,R,G);break;case qe:y(w,E,R,G);break;case Rn:w==null&&g(E,R,G,X);break;case ge:D(w,E,R,G,L,z,X,j,Y);break;default:te&1?P(w,E,R,G,L,z,X,j,Y):te&6?A(w,E,R,G,L,z,X,j,Y):(te&64||te&128)&&B.process(w,E,R,G,L,z,X,j,Y,Ot)}re!=null&&L&&Yr(re,w&&w.ref,z,E||w,!E)},_=(w,E,R,G)=>{if(w==null)i(E.el=a(E.children),R,G);else{const L=E.el=w.el;E.children!==w.children&&h(L,E.children)}},y=(w,E,R,G)=>{w==null?i(E.el=l(E.children||""),R,G):E.el=w.el},g=(w,E,R,G)=>{[w.el,w.anchor]=f(w.children,E,R,G,w.el,w.anchor)},m=({el:w,anchor:E},R,G)=>{let L;for(;w&&w!==E;)L=d(w),i(w,R,G),w=L;i(E,R,G)},S=({el:w,anchor:E})=>{let R;for(;w&&w!==E;)R=d(w),r(w),w=R;r(E)},P=(w,E,R,G,L,z,X,j,Y)=>{X=X||E.type==="svg",w==null?k(E,R,G,L,z,X,j,Y):M(w,E,L,z,X,j,Y)},k=(w,E,R,G,L,z,X,j)=>{let Y,B;const{type:re,props:te,shapeFlag:se,transition:ae,dirs:de}=w;if(Y=w.el=o(w.type,z,te&&te.is,te),se&8?c(Y,w.children):se&16&&C(w.children,Y,null,G,L,z&&re!=="foreignObject",X,j),de&&It(w,null,G,"created"),x(Y,w,w.scopeId,X,G),te){for(const be in te)be!=="value"&&!Li(be)&&s(Y,be,null,te[be],z,w.children,G,L,Re);"value"in te&&s(Y,"value",null,te.value),(B=te.onVnodeBeforeMount)&&tt(B,G,w)}de&&It(w,null,G,"beforeMount");const Te=(!L||L&&!L.pendingBranch)&&ae&&!ae.persisted;Te&&ae.beforeEnter(Y),i(Y,E,R),((B=te&&te.onVnodeMounted)||Te||de)&&ze(()=>{B&&tt(B,G,w),Te&&ae.enter(Y),de&&It(w,null,G,"mounted")},L)},x=(w,E,R,G,L)=>{if(R&&p(w,R),G)for(let z=0;z<G.length;z++)p(w,G[z]);if(L){let z=L.subTree;if(E===z){const X=L.vnode;x(w,X,X.scopeId,X.slotScopeIds,L.parent)}}},C=(w,E,R,G,L,z,X,j,Y=0)=>{for(let B=Y;B<w.length;B++){const re=w[B]=j?sn(w[B]):lt(w[B]);v(null,re,E,R,G,L,z,X,j)}},M=(w,E,R,G,L,z,X)=>{const j=E.el=w.el;let{patchFlag:Y,dynamicChildren:B,dirs:re}=E;Y|=w.patchFlag&16;const te=w.props||Ce,se=E.props||Ce;let ae;R&&wn(R,!1),(ae=se.onVnodeBeforeUpdate)&&tt(ae,R,E,w),re&&It(E,w,R,"beforeUpdate"),R&&wn(R,!0);const de=L&&E.type!=="foreignObject";if(B?I(w.dynamicChildren,B,j,R,G,de,z):X||ie(w,E,j,null,R,G,de,z,!1),Y>0){if(Y&16)N(j,E,te,se,R,G,L);else if(Y&2&&te.class!==se.class&&s(j,"class",null,se.class,L),Y&4&&s(j,"style",te.style,se.style,L),Y&8){const Te=E.dynamicProps;for(let be=0;be<Te.length;be++){const $e=Te[be],wt=te[$e],Xn=se[$e];(Xn!==wt||$e==="value")&&s(j,$e,wt,Xn,L,w.children,R,G,Re)}}Y&1&&w.children!==E.children&&c(j,E.children)}else!X&&B==null&&N(j,E,te,se,R,G,L);((ae=se.onVnodeUpdated)||re)&&ze(()=>{ae&&tt(ae,R,E,w),re&&It(E,w,R,"updated")},G)},I=(w,E,R,G,L,z,X)=>{for(let j=0;j<E.length;j++){const Y=w[j],B=E[j],re=Y.el&&(Y.type===ge||!St(Y,B)||Y.shapeFlag&70)?u(Y.el):R;v(Y,B,re,null,G,L,z,X,!0)}},N=(w,E,R,G,L,z,X)=>{if(R!==G){if(R!==Ce)for(const j in R)!Li(j)&&!(j in G)&&s(w,j,R[j],null,X,E.children,L,z,Re);for(const j in G){if(Li(j))continue;const Y=G[j],B=R[j];Y!==B&&j!=="value"&&s(w,j,B,Y,X,E.children,L,z,Re)}"value"in G&&s(w,"value",R.value,G.value)}},D=(w,E,R,G,L,z,X,j,Y)=>{const B=E.el=w?w.el:a(""),re=E.anchor=w?w.anchor:a("");let{patchFlag:te,dynamicChildren:se,slotScopeIds:ae}=E;ae&&(j=j?j.concat(ae):ae),w==null?(i(B,R,G),i(re,R,G),C(E.children,R,re,L,z,X,j,Y)):te>0&&te&64&&se&&w.dynamicChildren?(I(w.dynamicChildren,se,R,L,z,X,j),(E.key!=null||L&&E===L.subTree)&&zo(w,E,!0)):ie(w,E,R,re,L,z,X,j,Y)},A=(w,E,R,G,L,z,X,j,Y)=>{E.slotScopeIds=j,w==null?E.shapeFlag&512?L.ctx.activate(E,R,G,X,Y):O(E,R,G,L,z,X,Y):V(w,E,Y)},O=(w,E,R,G,L,z,X)=>{const j=w.component=Yh(w,G,L);if(lr(w)&&(j.ctx.renderer=Ot),Kh(j),j.asyncDep){if(L&&L.registerDep(j,$),!w.el){const Y=j.subTree=le(qe);y(null,Y,E,R)}return}$(j,w,E,R,L,z,X)},V=(w,E,R)=>{const G=E.component=w.component;if(Dd(w,E,R))if(G.asyncDep&&!G.asyncResolved){K(G,E,R);return}else G.next=E,Td(G.update),G.update();else E.el=w.el,G.vnode=E},$=(w,E,R,G,L,z,X)=>{const j=()=>{if(w.isMounted){let{next:re,bu:te,u:se,parent:ae,vnode:de}=w,Te=re,be;wn(w,!1),re?(re.el=de.el,K(w,re,X)):re=de,te&&ti(te),(be=re.props&&re.props.onVnodeBeforeUpdate)&&tt(be,ae,re,de),wn(w,!0);const $e=Lr(w),wt=w.subTree;w.subTree=$e,v(wt,$e,u(wt.el),bt(wt),w,L,z),re.el=$e.el,Te===null&&Go(w,$e.el),se&&ze(se,L),(be=re.props&&re.props.onVnodeUpdated)&&ze(()=>tt(be,ae,re,de),L)}else{let re;const{el:te,props:se}=E,{bm:ae,m:de,parent:Te}=w,be=In(E);if(wn(w,!1),ae&&ti(ae),!be&&(re=se&&se.onVnodeBeforeMount)&&tt(re,Te,E),wn(w,!0),te&&Yn){const $e=()=>{w.subTree=Lr(w),Yn(te,w.subTree,w,L,null)};be?E.type.__asyncLoader().then(()=>!w.isUnmounted&&$e()):$e()}else{const $e=w.subTree=Lr(w);v(null,$e,R,G,w,L,z),E.el=$e.el}if(de&&ze(de,L),!be&&(re=se&&se.onVnodeMounted)){const $e=E;ze(()=>tt(re,Te,$e),L)}(E.shapeFlag&256||Te&&In(Te.vnode)&&Te.vnode.shapeFlag&256)&&w.a&&ze(w.a,L),w.isMounted=!0,E=R=G=null}},Y=w.effect=new or(j,()=>ss(B),w.scope),B=w.update=()=>Y.run();B.id=w.uid,wn(w,!0),B()},K=(w,E,R)=>{E.component=w;const G=w.vnode.props;w.vnode=E,w.next=null,lf(w,E.props,G,R),uf(w,E.children,R),pi(),ya(),gi()},ie=(w,E,R,G,L,z,X,j,Y=!1)=>{const B=w&&w.children,re=w?w.shapeFlag:0,te=E.children,{patchFlag:se,shapeFlag:ae}=E;if(se>0){if(se&128){Z(B,te,R,G,L,z,X,j,Y);return}else if(se&256){ue(B,te,R,G,L,z,X,j,Y);return}}ae&8?(re&16&&Re(B,L,z),te!==B&&c(R,te)):re&16?ae&16?Z(B,te,R,G,L,z,X,j,Y):Re(B,L,z,!0):(re&8&&c(R,""),ae&16&&C(te,R,G,L,z,X,j,Y))},ue=(w,E,R,G,L,z,X,j,Y)=>{w=w||Zn,E=E||Zn;const B=w.length,re=E.length,te=Math.min(B,re);let se;for(se=0;se<te;se++){const ae=E[se]=Y?sn(E[se]):lt(E[se]);v(w[se],ae,R,null,L,z,X,j,Y)}B>re?Re(w,L,z,!0,!1,te):C(E,R,G,L,z,X,j,Y,te)},Z=(w,E,R,G,L,z,X,j,Y)=>{let B=0;const re=E.length;let te=w.length-1,se=re-1;for(;B<=te&&B<=se;){const ae=w[B],de=E[B]=Y?sn(E[B]):lt(E[B]);if(St(ae,de))v(ae,de,R,null,L,z,X,j,Y);else break;B++}for(;B<=te&&B<=se;){const ae=w[te],de=E[se]=Y?sn(E[se]):lt(E[se]);if(St(ae,de))v(ae,de,R,null,L,z,X,j,Y);else break;te--,se--}if(B>te){if(B<=se){const ae=se+1,de=ae<re?E[ae].el:G;for(;B<=se;)v(null,E[B]=Y?sn(E[B]):lt(E[B]),R,de,L,z,X,j,Y),B++}}else if(B>se)for(;B<=te;)fe(w[B],L,z,!0),B++;else{const ae=B,de=B,Te=new Map;for(B=de;B<=se;B++){const ot=E[B]=Y?sn(E[B]):lt(E[B]);ot.key!=null&&Te.set(ot.key,B)}let be,$e=0;const wt=se-de+1;let Xn=!1,aa=0;const Ci=new Array(wt);for(B=0;B<wt;B++)Ci[B]=0;for(B=ae;B<=te;B++){const ot=w[B];if($e>=wt){fe(ot,L,z,!0);continue}let At;if(ot.key!=null)At=Te.get(ot.key);else for(be=de;be<=se;be++)if(Ci[be-de]===0&&St(ot,E[be])){At=be;break}At===void 0?fe(ot,L,z,!0):(Ci[At-de]=B+1,At>=aa?aa=At:Xn=!0,v(ot,E[At],R,null,L,z,X,j,Y),$e++)}const la=Xn?gf(Ci):Zn;for(be=la.length-1,B=wt-1;B>=0;B--){const ot=de+B,At=E[ot],ha=ot+1<re?E[ot+1].el:G;Ci[B]===0?v(null,At,R,ha,L,z,X,j,Y):Xn&&(be<0||B!==la[be]?ce(At,R,ha,2):be--)}}},ce=(w,E,R,G,L=null)=>{const{el:z,type:X,transition:j,children:Y,shapeFlag:B}=w;if(B&6){ce(w.component.subTree,E,R,G);return}if(B&128){w.suspense.move(E,R,G);return}if(B&64){X.move(w,E,R,Ot);return}if(X===ge){i(z,E,R);for(let te=0;te<Y.length;te++)ce(Y[te],E,R,G);i(w.anchor,E,R);return}if(X===Rn){m(w,E,R);return}if(G!==2&&B&1&&j)if(G===0)j.beforeEnter(z),i(z,E,R),ze(()=>j.enter(z),L);else{const{leave:te,delayLeave:se,afterLeave:ae}=j,de=()=>i(z,E,R),Te=()=>{te(z,()=>{de(),ae&&ae()})};se?se(z,de,Te):Te()}else i(z,E,R)},fe=(w,E,R,G=!1,L=!1)=>{const{type:z,props:X,ref:j,children:Y,dynamicChildren:B,shapeFlag:re,patchFlag:te,dirs:se}=w;if(j!=null&&Yr(j,null,R,w,!0),re&256){E.ctx.deactivate(w);return}const ae=re&1&&se,de=!In(w);let Te;if(de&&(Te=X&&X.onVnodeBeforeUnmount)&&tt(Te,E,w),re&6)Ie(w.component,R,G);else{if(re&128){w.suspense.unmount(R,G);return}ae&&It(w,null,E,"beforeUnmount"),re&64?w.type.remove(w,E,R,L,Ot,G):B&&(z!==ge||te>0&&te&64)?Re(B,E,R,!1,!0):(z===ge&&te&384||!L&&re&16)&&Re(Y,E,R),G&&ye(w)}(de&&(Te=X&&X.onVnodeUnmounted)||ae)&&ze(()=>{Te&&tt(Te,E,w),ae&&It(w,null,E,"unmounted")},R)},ye=w=>{const{type:E,el:R,anchor:G,transition:L}=w;if(E===ge){Ye(R,G);return}if(E===Rn){S(w);return}const z=()=>{r(R),L&&!L.persisted&&L.afterLeave&&L.afterLeave()};if(w.shapeFlag&1&&L&&!L.persisted){const{leave:X,delayLeave:j}=L,Y=()=>X(R,z);j?j(w.el,z,Y):Y()}else z()},Ye=(w,E)=>{let R;for(;w!==E;)R=d(w),r(w),w=R;r(E)},Ie=(w,E,R)=>{const{bum:G,scope:L,update:z,subTree:X,um:j}=w;G&&ti(G),L.stop(),z&&(z.active=!1,fe(X,w,E,R)),j&&ze(j,E),ze(()=>{w.isUnmounted=!0},E),E&&E.pendingBranch&&!E.isUnmounted&&w.asyncDep&&!w.asyncResolved&&w.suspenseId===E.pendingId&&(E.deps--,E.deps===0&&E.resolve())},Re=(w,E,R,G=!1,L=!1,z=0)=>{for(let X=z;X<w.length;X++)fe(w[X],E,R,G,L)},bt=w=>w.shapeFlag&6?bt(w.component.subTree):w.shapeFlag&128?w.suspense.next():d(w.anchor||w.el),Ue=(w,E,R)=>{w==null?E._vnode&&fe(E._vnode,null,null,!0):v(E._vnode||null,w,E,null,null,null,R),ya(),zr(),E._vnode=w},Ot={p:v,um:fe,m:ce,r:ye,mt:O,mc:C,pc:ie,pbc:I,n:bt,o:t};let wi,Yn;return e&&([wi,Yn]=e(Ot)),{render:Ue,hydrate:wi,createApp:ff(Ue,wi)}}function wn({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function zo(t,e,n=!1){const i=t.children,r=e.children;if(ee(i)&&ee(r))for(let s=0;s<i.length;s++){const o=i[s];let a=r[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[s]=sn(r[s]),a.el=o.el),n||zo(o,a)),a.type===Gn&&(a.el=o.el)}}function gf(t){const e=t.slice(),n=[0];let i,r,s,o,a;const l=t.length;for(i=0;i<l;i++){const h=t[i];if(h!==0){if(r=n[n.length-1],t[r]<h){e[i]=r,n.push(i);continue}for(s=0,o=n.length-1;s<o;)a=s+o>>1,t[n[a]]<h?s=a+1:o=a;h<t[n[s]]&&(s>0&&(e[i]=n[s-1]),n[s]=i)}}for(s=n.length,o=n[s-1];s-- >0;)n[s]=o,o=e[o];return n}const vf=t=>t.__isTeleport,$i=t=>t&&(t.disabled||t.disabled===""),Oa=t=>typeof SVGElement<"u"&&t instanceof SVGElement,Ks=(t,e)=>{const n=t&&t.to;return Me(n)?e?e(n):null:n},mf={__isTeleport:!0,process(t,e,n,i,r,s,o,a,l,h){const{mc:c,pc:u,pbc:d,o:{insert:p,querySelector:f,createText:v,createComment:_}}=h,y=$i(e.props);let{shapeFlag:g,children:m,dynamicChildren:S}=e;if(t==null){const P=e.el=v(""),k=e.anchor=v("");p(P,n,i),p(k,n,i);const x=e.target=Ks(e.props,f),C=e.targetAnchor=v("");x&&(p(C,x),o=o||Oa(x));const M=(I,N)=>{g&16&&c(m,I,N,r,s,o,a,l)};y?M(n,k):x&&M(x,C)}else{e.el=t.el;const P=e.anchor=t.anchor,k=e.target=t.target,x=e.targetAnchor=t.targetAnchor,C=$i(t.props),M=C?n:k,I=C?P:x;if(o=o||Oa(k),S?(d(t.dynamicChildren,S,M,r,s,o,a),zo(t,e,!0)):l||u(t,e,M,I,r,s,o,a,!1),y)C||wr(e,n,P,h,1);else if((e.props&&e.props.to)!==(t.props&&t.props.to)){const N=e.target=Ks(e.props,f);N&&wr(e,N,null,h,0)}else C&&wr(e,k,x,h,1)}Hh(e)},remove(t,e,n,i,{um:r,o:{remove:s}},o){const{shapeFlag:a,children:l,anchor:h,targetAnchor:c,target:u,props:d}=t;if(u&&s(c),(o||!$i(d))&&(s(h),a&16))for(let p=0;p<l.length;p++){const f=l[p];r(f,e,n,!0,!!f.dynamicChildren)}},move:wr,hydrate:_f};function wr(t,e,n,{o:{insert:i},m:r},s=2){s===0&&i(t.targetAnchor,e,n);const{el:o,anchor:a,shapeFlag:l,children:h,props:c}=t,u=s===2;if(u&&i(o,e,n),(!u||$i(c))&&l&16)for(let d=0;d<h.length;d++)r(h[d],e,n,2);u&&i(a,e,n)}function _f(t,e,n,i,r,s,{o:{nextSibling:o,parentNode:a,querySelector:l}},h){const c=e.target=Ks(e.props,l);if(c){const u=c._lpa||c.firstChild;if(e.shapeFlag&16)if($i(e.props))e.anchor=h(o(t),e,a(t),n,i,r,s),e.targetAnchor=u;else{e.anchor=o(t);let d=u;for(;d;)if(d=o(d),d&&d.nodeType===8&&d.data==="teleport anchor"){e.targetAnchor=d,c._lpa=e.targetAnchor&&o(e.targetAnchor);break}h(u,e,c,n,i,r,s)}Hh(e)}return e.anchor&&o(e.anchor)}const yf=mf;function Hh(t){const e=t.ctx;if(e&&e.ut){let n=t.children[0].el;for(;n!==t.targetAnchor;)n.nodeType===1&&n.setAttribute("data-v-owner",e.uid),n=n.nextSibling;e.ut()}}const ge=Symbol(void 0),Gn=Symbol(void 0),qe=Symbol(void 0),Rn=Symbol(void 0),Bi=[];let nt=null;function W(t=!1){Bi.push(nt=t?null:[])}function Uh(){Bi.pop(),nt=Bi[Bi.length-1]||null}let Fn=1;function qs(t){Fn+=t}function jh(t){return t.dynamicChildren=Fn>0?nt||Zn:null,Uh(),Fn>0&&nt&&nt.push(t),t}function Q(t,e,n,i,r,s){return jh(q(t,e,n,i,r,s,!0))}function Fe(t,e,n,i,r){return jh(le(t,e,n,i,r,!0))}function dn(t){return t?t.__v_isVNode===!0:!1}function St(t,e){return t.type===e.type&&t.key===e.key}function bf(t){}const fs="__vInternal",Wh=({key:t})=>t??null,Gr=({ref:t,ref_key:e,ref_for:n})=>t!=null?Me(t)||Be(t)||oe(t)?{i:Ve,r:t,k:e,f:!!n}:t:null;function q(t,e=null,n=null,i=0,r=null,s=t===ge?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Wh(e),ref:e&&Gr(e),scopeId:as,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:i,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:Ve};return a?(Yo(l,n),s&128&&t.normalize(l)):n&&(l.shapeFlag|=Me(n)?8:16),Fn>0&&!o&&nt&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&nt.push(l),l}const le=wf;function wf(t,e=null,n=null,i=0,r=null,s=!1){if((!t||t===Mh)&&(t=qe),dn(t)){const a=Gt(t,e,!0);return n&&Yo(a,n),Fn>0&&!s&&nt&&(a.shapeFlag&6?nt[nt.indexOf(t)]=a:nt.push(a)),a.patchFlag|=-2,a}if(Pf(t)&&(t=t.__vccOpts),e){e=zh(e);let{class:a,style:l}=e;a&&!Me(a)&&(e.class=Ze(a)),Se(l)&&(Ao(l)&&!ee(l)&&(l=De({},l)),e.style=kt(l))}const o=Me(t)?1:gh(t)?128:vf(t)?64:Se(t)?4:oe(t)?2:0;return q(t,e,n,i,r,o,s,!0)}function zh(t){return t?Ao(t)||fs in t?De({},t):t:null}function Gt(t,e,n=!1){const{props:i,ref:r,patchFlag:s,children:o}=t,a=e?Vh(i||{},e):i;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:a,key:a&&Wh(a),ref:e&&e.ref?n&&r?ee(r)?r.concat(Gr(e)):[r,Gr(e)]:Gr(e):r,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==ge?s===-1?16:s|16:s,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Gt(t.ssContent),ssFallback:t.ssFallback&&Gt(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce}}function ps(t=" ",e=0){return le(Gn,null,t,e)}function Vo(t,e){const n=le(Rn,null,t);return n.staticCount=e,n}function ut(t="",e=!1){return e?(W(),Fe(qe,null,t)):le(qe,null,t)}function lt(t){return t==null||typeof t=="boolean"?le(qe):ee(t)?le(ge,null,t.slice()):typeof t=="object"?sn(t):le(Gn,null,String(t))}function sn(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Gt(t)}function Yo(t,e){let n=0;const{shapeFlag:i}=t;if(e==null)e=null;else if(ee(e))n=16;else if(typeof e=="object")if(i&65){const r=e.default;r&&(r._c&&(r._d=!1),Yo(t,r()),r._c&&(r._d=!0));return}else{n=32;const r=e._;!r&&!(fs in e)?e._ctx=Ve:r===3&&Ve&&(Ve.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else oe(e)?(e={default:e,_ctx:Ve},n=32):(e=String(e),i&64?(n=16,e=[ps(e)]):n=8);t.children=e,t.shapeFlag|=n}function Vh(...t){const e={};for(let n=0;n<t.length;n++){const i=t[n];for(const r in i)if(r==="class")e.class!==i.class&&(e.class=Ze([e.class,i.class]));else if(r==="style")e.style=kt([e.style,i.style]);else if(rr(r)){const s=e[r],o=i[r];o&&s!==o&&!(ee(s)&&s.includes(o))&&(e[r]=s?[].concat(s,o):o)}else r!==""&&(e[r]=i[r])}return e}function tt(t,e,n,i=null){ct(t,e,7,[n,i])}const Cf=Gh();let Sf=0;function Yh(t,e,n){const i=t.type,r=(e?e.appContext:t.appContext)||Cf,s={uid:Sf++,vnode:t,type:i,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,scope:new To(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Rh(i,r),emitsOptions:ph(i,r),emit:null,emitted:null,propsDefaults:Ce,inheritAttrs:i.inheritAttrs,ctx:Ce,data:Ce,props:Ce,attrs:Ce,slots:Ce,refs:Ce,setupState:Ce,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=Pd.bind(null,s),t.ce&&t.ce(s),s}let Ne=null;const mn=()=>Ne||Ve,fn=t=>{Ne=t,t.scope.on()},an=()=>{Ne&&Ne.scope.off(),Ne=null};function Xh(t){return t.vnode.shapeFlag&4}let li=!1;function Kh(t,e=!1){li=e;const{props:n,children:i}=t.vnode,r=Xh(t);af(t,n,r,e),cf(t,i);const s=r?xf(t,e):void 0;return li=!1,s}function xf(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=Bn(new Proxy(t.ctx,zs));const{setup:i}=n;if(i){const r=t.setupContext=i.length>1?Jh(t):null;fn(t),pi();const s=zt(i,t,0,[t.props,r]);if(gi(),an(),xo(s)){if(s.then(an,an),e)return s.then(o=>{Js(t,o,e)}).catch(o=>{Hn(o,t,0)});t.asyncDep=s}else Js(t,s,e)}else qh(t,e)}function Js(t,e,n){oe(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Se(e)&&(t.setupState=No(e)),qh(t,n)}let Xr,Qs;function Ef(t){Xr=t,Qs=e=>{e.render._rc&&(e.withProxy=new Proxy(e.ctx,ef))}}const Tf=()=>!Xr;function qh(t,e,n){const i=t.type;if(!t.render){if(!e&&Xr&&!i.render){const r=i.template||jo(t).template;if(r){const{isCustomElement:s,compilerOptions:o}=t.appContext.config,{delimiters:a,compilerOptions:l}=i,h=De(De({isCustomElement:s,delimiters:a},o),l);i.render=Xr(r,h)}}t.render=i.render||xt,Qs&&Qs(t)}fn(t),pi(),tf(t),gi(),an()}function kf(t){return new Proxy(t.attrs,{get(e,n){return rt(t,"get","$attrs"),e[n]}})}function Jh(t){const e=i=>{t.exposed=i||{}};let n;return{get attrs(){return n||(n=kf(t))},slots:t.slots,emit:t.emit,expose:e}}function gs(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(No(Bn(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in Fi)return Fi[n](t)},has(e,n){return n in e||n in Fi}}))}function Zs(t,e=!0){return oe(t)?t.displayName||t.name:t.name||e&&t.__name}function Pf(t){return oe(t)&&"__vccOpts"in t}const he=(t,e)=>wd(t,e,li);function Mf(){return null}function Of(){return null}function Af(t){}function If(t,e){return null}function Rf(){return Qh().slots}function Nf(){return Qh().attrs}function Qh(){const t=mn();return t.setupContext||(t.setupContext=Jh(t))}function Df(t,e){const n=ee(t)?t.reduce((i,r)=>(i[r]={},i),{}):t;for(const i in e){const r=n[i];r?ee(r)||oe(r)?n[i]={type:r,default:e[i]}:r.default=e[i]:r===null&&(n[i]={default:e[i]})}return n}function Lf(t,e){const n={};for(const i in t)e.includes(i)||Object.defineProperty(n,i,{enumerable:!0,get:()=>t[i]});return n}function Gf(t){const e=mn();let n=t();return an(),xo(n)&&(n=n.catch(i=>{throw fn(e),i})),[n,()=>fn(e)]}function Zh(t,e,n){const i=arguments.length;return i===2?Se(e)&&!ee(e)?dn(e)?le(t,null,[e]):le(t,e):le(t,null,e):(i>3?n=Array.prototype.slice.call(arguments,2):i===3&&dn(n)&&(n=[n]),le(t,e,n))}const ec=Symbol(""),tc=()=>An(ec);function Ff(){}function $f(t,e,n,i){const r=n[i];if(r&&nc(r,t))return r;const s=e();return s.memo=t.slice(),n[i]=s}function nc(t,e){const n=t.memo;if(n.length!=e.length)return!1;for(let i=0;i<n.length;i++)if(oi(n[i],e[i]))return!1;return Fn>0&&nt&&nt.push(t),!0}const ic="3.2.47",Bf={createComponentInstance:Yh,setupComponent:Kh,renderComponentRoot:Lr,setCurrentRenderingInstance:qi,isVNode:dn,normalizeVNode:lt},Hf=Bf,Uf=null,jf=null,Wf="http://www.w3.org/2000/svg",Tn=typeof document<"u"?document:null,Aa=Tn&&Tn.createElement("template"),zf={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,i)=>{const r=e?Tn.createElementNS(Wf,t):Tn.createElement(t,n?{is:n}:void 0);return t==="select"&&i&&i.multiple!=null&&r.setAttribute("multiple",i.multiple),r},createText:t=>Tn.createTextNode(t),createComment:t=>Tn.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Tn.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,i,r,s){const o=n?n.previousSibling:e.lastChild;if(r&&(r===s||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),n),!(r===s||!(r=r.nextSibling)););else{Aa.innerHTML=i?`<svg>${t}</svg>`:t;const a=Aa.content;if(i){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}};function Vf(t,e,n){const i=t._vtc;i&&(e=(e?[e,...i]:[...i]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}function Yf(t,e,n){const i=t.style,r=Me(n);if(n&&!r){if(e&&!Me(e))for(const s in e)n[s]==null&&eo(i,s,"");for(const s in n)eo(i,s,n[s])}else{const s=i.display;r?e!==n&&(i.cssText=n):e&&t.removeAttribute("style"),"_vod"in t&&(i.display=s)}}const Ia=/\s*!important$/;function eo(t,e,n){if(ee(n))n.forEach(i=>eo(t,e,i));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const i=Xf(t,e);Ia.test(n)?t.setProperty(gt(i),n.replace(Ia,""),"important"):t[i]=n}}const Ra=["Webkit","Moz","ms"],Ps={};function Xf(t,e){const n=Ps[e];if(n)return n;let i=it(e);if(i!=="filter"&&i in t)return Ps[e]=i;i=sr(i);for(let r=0;r<Ra.length;r++){const s=Ra[r]+i;if(s in t)return Ps[e]=s}return e}const Na="http://www.w3.org/1999/xlink";function Kf(t,e,n,i,r){if(i&&e.startsWith("xlink:"))n==null?t.removeAttributeNS(Na,e.slice(6,e.length)):t.setAttributeNS(Na,e,n);else{const s=ku(e);n==null||s&&!Bl(n)?t.removeAttribute(e):t.setAttribute(e,s?"":n)}}function qf(t,e,n,i,r,s,o){if(e==="innerHTML"||e==="textContent"){i&&o(i,r,s),t[e]=n??"";return}if(e==="value"&&t.tagName!=="PROGRESS"&&!t.tagName.includes("-")){t._value=n;const l=n??"";(t.value!==l||t.tagName==="OPTION")&&(t.value=l),n==null&&t.removeAttribute(e);return}let a=!1;if(n===""||n==null){const l=typeof t[e];l==="boolean"?n=Bl(n):n==null&&l==="string"?(n="",a=!0):l==="number"&&(n=0,a=!0)}try{t[e]=n}catch{}a&&t.removeAttribute(e)}function Wt(t,e,n,i){t.addEventListener(e,n,i)}function Jf(t,e,n,i){t.removeEventListener(e,n,i)}function Qf(t,e,n,i,r=null){const s=t._vei||(t._vei={}),o=s[e];if(i&&o)o.value=i;else{const[a,l]=Zf(e);if(i){const h=s[e]=np(i,r);Wt(t,a,h,l)}else o&&(Jf(t,a,o,l),s[e]=void 0)}}const Da=/(?:Once|Passive|Capture)$/;function Zf(t){let e;if(Da.test(t)){e={};let i;for(;i=t.match(Da);)t=t.slice(0,t.length-i[0].length),e[i[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):gt(t.slice(2)),e]}let Ms=0;const ep=Promise.resolve(),tp=()=>Ms||(ep.then(()=>Ms=0),Ms=Date.now());function np(t,e){const n=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=n.attached)return;ct(ip(i,n.value),e,5,[i])};return n.value=t,n.attached=tp(),n}function ip(t,e){if(ee(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(i=>r=>!r._stopped&&i&&i(r))}else return e}const La=/^on[a-z]/,rp=(t,e,n,i,r=!1,s,o,a,l)=>{e==="class"?Vf(t,i,r):e==="style"?Yf(t,n,i):rr(e)?Co(e)||Qf(t,e,n,i,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):sp(t,e,i,r))?qf(t,e,i,s,o,a,l):(e==="true-value"?t._trueValue=i:e==="false-value"&&(t._falseValue=i),Kf(t,e,i,r))};function sp(t,e,n,i){return i?!!(e==="innerHTML"||e==="textContent"||e in t&&La.test(e)&&oe(n)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||La.test(e)&&Me(n)?!1:e in t}function rc(t,e){const n=xe(t);class i extends vs{constructor(s){super(n,s,e)}}return i.def=n,i}const op=t=>rc(t,yc),ap=typeof HTMLElement<"u"?HTMLElement:class{};class vs extends ap{constructor(e,n={},i){super(),this._def=e,this._props=n,this._instance=null,this._connected=!1,this._resolved=!1,this._numberProps=null,this.shadowRoot&&i?i(this._createVNode(),this.shadowRoot):(this.attachShadow({mode:"open"}),this._def.__asyncLoader||this._resolveProps(this._def))}connectedCallback(){this._connected=!0,this._instance||(this._resolved?this._update():this._resolveDef())}disconnectedCallback(){this._connected=!1,vi(()=>{this._connected||(io(null,this.shadowRoot),this._instance=null)})}_resolveDef(){this._resolved=!0;for(let i=0;i<this.attributes.length;i++)this._setAttr(this.attributes[i].name);new MutationObserver(i=>{for(const r of i)this._setAttr(r.attributeName)}).observe(this,{attributes:!0});const e=(i,r=!1)=>{const{props:s,styles:o}=i;let a;if(s&&!ee(s))for(const l in s){const h=s[l];(h===Number||h&&h.type===Number)&&(l in this._props&&(this._props[l]=jr(this._props[l])),(a||(a=Object.create(null)))[it(l)]=!0)}this._numberProps=a,r&&this._resolveProps(i),this._applyStyles(o),this._update()},n=this._def.__asyncLoader;n?n().then(i=>e(i,!0)):e(this._def)}_resolveProps(e){const{props:n}=e,i=ee(n)?n:Object.keys(n||{});for(const r of Object.keys(this))r[0]!=="_"&&i.includes(r)&&this._setProp(r,this[r],!0,!1);for(const r of i.map(it))Object.defineProperty(this,r,{get(){return this._getProp(r)},set(s){this._setProp(r,s)}})}_setAttr(e){let n=this.getAttribute(e);const i=it(e);this._numberProps&&this._numberProps[i]&&(n=jr(n)),this._setProp(i,n,!1)}_getProp(e){return this._props[e]}_setProp(e,n,i=!0,r=!0){n!==this._props[e]&&(this._props[e]=n,r&&this._instance&&this._update(),i&&(n===!0?this.setAttribute(gt(e),""):typeof n=="string"||typeof n=="number"?this.setAttribute(gt(e),n+""):n||this.removeAttribute(gt(e))))}_update(){io(this._createVNode(),this.shadowRoot)}_createVNode(){const e=le(this._def,De({},this._props));return this._instance||(e.ce=n=>{this._instance=n,n.isCE=!0;const i=(s,o)=>{this.dispatchEvent(new CustomEvent(s,{detail:o}))};n.emit=(s,...o)=>{i(s,o),gt(s)!==s&&i(gt(s),o)};let r=this;for(;r=r&&(r.parentNode||r.host);)if(r instanceof vs){n.parent=r._instance,n.provides=r._instance.provides;break}}),e}_applyStyles(e){e&&e.forEach(n=>{const i=document.createElement("style");i.textContent=n,this.shadowRoot.appendChild(i)})}}function lp(t="$style"){{const e=mn();if(!e)return Ce;const n=e.type.__cssModules;if(!n)return Ce;const i=n[t];return i||Ce}}function hp(t){const e=mn();if(!e)return;const n=e.ut=(r=t(e.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${e.uid}"]`)).forEach(s=>no(s,r))},i=()=>{const r=t(e.proxy);to(e.subTree,r),n(r)};mh(i),Kt(()=>{const r=new MutationObserver(i);r.observe(e.subTree.el.parentNode,{childList:!0}),us(()=>r.disconnect())})}function to(t,e){if(t.shapeFlag&128){const n=t.suspense;t=n.activeBranch,n.pendingBranch&&!n.isHydrating&&n.effects.push(()=>{to(n.activeBranch,e)})}for(;t.component;)t=t.component.subTree;if(t.shapeFlag&1&&t.el)no(t.el,e);else if(t.type===ge)t.children.forEach(n=>to(n,e));else if(t.type===Rn){let{el:n,anchor:i}=t;for(;n&&(no(n,e),n!==i);)n=n.nextSibling}}function no(t,e){if(t.nodeType===1){const n=t.style;for(const i in e)n.setProperty(`--${i}`,e[i])}}const tn="transition",Si="animation",_i=(t,{slots:e})=>Zh(Bo,oc(t),e);_i.displayName="Transition";const sc={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},cp=_i.props=De({},Bo.props,sc),Cn=(t,e=[])=>{ee(t)?t.forEach(n=>n(...e)):t&&t(...e)},Ga=t=>t?ee(t)?t.some(e=>e.length>1):t.length>1:!1;function oc(t){const e={};for(const D in t)D in sc||(e[D]=t[D]);if(t.css===!1)return e;const{name:n="v",type:i,duration:r,enterFromClass:s=`${n}-enter-from`,enterActiveClass:o=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:l=s,appearActiveClass:h=o,appearToClass:c=a,leaveFromClass:u=`${n}-leave-from`,leaveActiveClass:d=`${n}-leave-active`,leaveToClass:p=`${n}-leave-to`}=t,f=up(r),v=f&&f[0],_=f&&f[1],{onBeforeEnter:y,onEnter:g,onEnterCancelled:m,onLeave:S,onLeaveCancelled:P,onBeforeAppear:k=y,onAppear:x=g,onAppearCancelled:C=m}=e,M=(D,A,O)=>{nn(D,A?c:a),nn(D,A?h:o),O&&O()},I=(D,A)=>{D._isLeaving=!1,nn(D,u),nn(D,p),nn(D,d),A&&A()},N=D=>(A,O)=>{const V=D?x:g,$=()=>M(A,D,O);Cn(V,[A,$]),Fa(()=>{nn(A,D?l:s),Ht(A,D?c:a),Ga(V)||$a(A,i,v,$)})};return De(e,{onBeforeEnter(D){Cn(y,[D]),Ht(D,s),Ht(D,o)},onBeforeAppear(D){Cn(k,[D]),Ht(D,l),Ht(D,h)},onEnter:N(!1),onAppear:N(!0),onLeave(D,A){D._isLeaving=!0;const O=()=>I(D,A);Ht(D,u),lc(),Ht(D,d),Fa(()=>{D._isLeaving&&(nn(D,u),Ht(D,p),Ga(S)||$a(D,i,_,O))}),Cn(S,[D,O])},onEnterCancelled(D){M(D,!1),Cn(m,[D])},onAppearCancelled(D){M(D,!0),Cn(C,[D])},onLeaveCancelled(D){I(D),Cn(P,[D])}})}function up(t){if(t==null)return null;if(Se(t))return[Os(t.enter),Os(t.leave)];{const e=Os(t);return[e,e]}}function Os(t){return jr(t)}function Ht(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t._vtc||(t._vtc=new Set)).add(e)}function nn(t,e){e.split(/\s+/).forEach(i=>i&&t.classList.remove(i));const{_vtc:n}=t;n&&(n.delete(e),n.size||(t._vtc=void 0))}function Fa(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let dp=0;function $a(t,e,n,i){const r=t._endId=++dp,s=()=>{r===t._endId&&i()};if(n)return setTimeout(s,n);const{type:o,timeout:a,propCount:l}=ac(t,e);if(!o)return i();const h=o+"end";let c=0;const u=()=>{t.removeEventListener(h,d),s()},d=p=>{p.target===t&&++c>=l&&u()};setTimeout(()=>{c<l&&u()},a+1),t.addEventListener(h,d)}function ac(t,e){const n=window.getComputedStyle(t),i=f=>(n[f]||"").split(", "),r=i(`${tn}Delay`),s=i(`${tn}Duration`),o=Ba(r,s),a=i(`${Si}Delay`),l=i(`${Si}Duration`),h=Ba(a,l);let c=null,u=0,d=0;e===tn?o>0&&(c=tn,u=o,d=s.length):e===Si?h>0&&(c=Si,u=h,d=l.length):(u=Math.max(o,h),c=u>0?o>h?tn:Si:null,d=c?c===tn?s.length:l.length:0);const p=c===tn&&/\b(transform|all)(,|$)/.test(i(`${tn}Property`).toString());return{type:c,timeout:u,propCount:d,hasTransform:p}}function Ba(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,i)=>Ha(n)+Ha(t[i])))}function Ha(t){return Number(t.slice(0,-1).replace(",","."))*1e3}function lc(){return document.body.offsetHeight}const hc=new WeakMap,cc=new WeakMap,uc={name:"TransitionGroup",props:De({},cp,{tag:String,moveClass:String}),setup(t,{slots:e}){const n=mn(),i=$o();let r,s;return mi(()=>{if(!r.length)return;const o=t.moveClass||`${t.name||"v"}-move`;if(!mp(r[0].el,n.vnode.el,o))return;r.forEach(pp),r.forEach(gp);const a=r.filter(vp);lc(),a.forEach(l=>{const h=l.el,c=h.style;Ht(h,o),c.transform=c.webkitTransform=c.transitionDuration="";const u=h._moveCb=d=>{d&&d.target!==h||(!d||/transform$/.test(d.propertyName))&&(h.removeEventListener("transitionend",u),h._moveCb=null,nn(h,o))};h.addEventListener("transitionend",u)})}),()=>{const o=pe(t),a=oc(o);let l=o.tag||ge;r=s,s=e.default?hs(e.default()):[];for(let h=0;h<s.length;h++){const c=s[h];c.key!=null&&Ln(c,ai(c,a,i,n))}if(r)for(let h=0;h<r.length;h++){const c=r[h];Ln(c,ai(c,a,i,n)),hc.set(c,c.el.getBoundingClientRect())}return le(l,null,s)}}},fp=t=>delete t.mode;uc.props;const dc=uc;function pp(t){const e=t.el;e._moveCb&&e._moveCb(),e._enterCb&&e._enterCb()}function gp(t){cc.set(t,t.el.getBoundingClientRect())}function vp(t){const e=hc.get(t),n=cc.get(t),i=e.left-n.left,r=e.top-n.top;if(i||r){const s=t.el.style;return s.transform=s.webkitTransform=`translate(${i}px,${r}px)`,s.transitionDuration="0s",t}}function mp(t,e,n){const i=t.cloneNode();t._vtc&&t._vtc.forEach(o=>{o.split(/\s+/).forEach(a=>a&&i.classList.remove(a))}),n.split(/\s+/).forEach(o=>o&&i.classList.add(o)),i.style.display="none";const r=e.nodeType===1?e:e.parentNode;r.appendChild(i);const{hasTransform:s}=ac(i);return r.removeChild(i),s}const pn=t=>{const e=t.props["onUpdate:modelValue"]||!1;return ee(e)?n=>ti(e,n):e};function _p(t){t.target.composing=!0}function Ua(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const gn={created(t,{modifiers:{lazy:e,trim:n,number:i}},r){t._assign=pn(r);const s=i||r.props&&r.props.type==="number";Wt(t,e?"change":"input",o=>{if(o.target.composing)return;let a=t.value;n&&(a=a.trim()),s&&(a=Ur(a)),t._assign(a)}),n&&Wt(t,"change",()=>{t.value=t.value.trim()}),e||(Wt(t,"compositionstart",_p),Wt(t,"compositionend",Ua),Wt(t,"change",Ua))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,modifiers:{lazy:n,trim:i,number:r}},s){if(t._assign=pn(s),t.composing||document.activeElement===t&&t.type!=="range"&&(n||i&&t.value.trim()===e||(r||t.type==="number")&&Ur(t.value)===e))return;const o=e??"";t.value!==o&&(t.value=o)}},Xo={deep:!0,created(t,e,n){t._assign=pn(n),Wt(t,"change",()=>{const i=t._modelValue,r=hi(t),s=t.checked,o=t._assign;if(ee(i)){const a=Qr(i,r),l=a!==-1;if(s&&!l)o(i.concat(r));else if(!s&&l){const h=[...i];h.splice(a,1),o(h)}}else if($n(i)){const a=new Set(i);s?a.add(r):a.delete(r),o(a)}else o(fc(t,s))})},mounted:ja,beforeUpdate(t,e,n){t._assign=pn(n),ja(t,e,n)}};function ja(t,{value:e,oldValue:n},i){t._modelValue=e,ee(e)?t.checked=Qr(e,i.props.value)>-1:$n(e)?t.checked=e.has(i.props.value):e!==n&&(t.checked=hn(e,fc(t,!0)))}const Ko={created(t,{value:e},n){t.checked=hn(e,n.props.value),t._assign=pn(n),Wt(t,"change",()=>{t._assign(hi(t))})},beforeUpdate(t,{value:e,oldValue:n},i){t._assign=pn(i),e!==n&&(t.checked=hn(e,i.props.value))}},qo={deep:!0,created(t,{value:e,modifiers:{number:n}},i){const r=$n(e);Wt(t,"change",()=>{const s=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>n?Ur(hi(o)):hi(o));t._assign(t.multiple?r?new Set(s):s:s[0])}),t._assign=pn(i)},mounted(t,{value:e}){Wa(t,e)},beforeUpdate(t,e,n){t._assign=pn(n)},updated(t,{value:e}){Wa(t,e)}};function Wa(t,e){const n=t.multiple;if(!(n&&!ee(e)&&!$n(e))){for(let i=0,r=t.options.length;i<r;i++){const s=t.options[i],o=hi(s);if(n)ee(e)?s.selected=Qr(e,o)>-1:s.selected=e.has(o);else if(hn(hi(s),e)){t.selectedIndex!==i&&(t.selectedIndex=i);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function hi(t){return"_value"in t?t._value:t.value}function fc(t,e){const n=e?"_trueValue":"_falseValue";return n in t?t[n]:e}const pc={created(t,e,n){Cr(t,e,n,null,"created")},mounted(t,e,n){Cr(t,e,n,null,"mounted")},beforeUpdate(t,e,n,i){Cr(t,e,n,i,"beforeUpdate")},updated(t,e,n,i){Cr(t,e,n,i,"updated")}};function gc(t,e){switch(t){case"SELECT":return qo;case"TEXTAREA":return gn;default:switch(e){case"checkbox":return Xo;case"radio":return Ko;default:return gn}}}function Cr(t,e,n,i,r){const o=gc(t.tagName,n.props&&n.props.type)[r];o&&o(t,e,n,i)}function yp(){gn.getSSRProps=({value:t})=>({value:t}),Ko.getSSRProps=({value:t},e)=>{if(e.props&&hn(e.props.value,t))return{checked:!0}},Xo.getSSRProps=({value:t},e)=>{if(ee(t)){if(e.props&&Qr(t,e.props.value)>-1)return{checked:!0}}else if($n(t)){if(e.props&&t.has(e.props.value))return{checked:!0}}else if(t)return{checked:!0}},pc.getSSRProps=(t,e)=>{if(typeof e.type!="string")return;const n=gc(e.type.toUpperCase(),e.props&&e.props.type);if(n.getSSRProps)return n.getSSRProps(t,e)}}const bp=["ctrl","shift","alt","meta"],wp={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>bp.some(n=>t[`${n}Key`]&&!e.includes(n))},Lt=(t,e)=>(n,...i)=>{for(let r=0;r<e.length;r++){const s=wp[e[r]];if(s&&s(n,e))return}return t(n,...i)},Cp={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Jo=(t,e)=>n=>{if(!("key"in n))return;const i=gt(n.key);if(e.some(r=>r===i||Cp[r]===i))return t(n)},ms={beforeMount(t,{value:e},{transition:n}){t._vod=t.style.display==="none"?"":t.style.display,n&&e?n.beforeEnter(t):xi(t,e)},mounted(t,{value:e},{transition:n}){n&&e&&n.enter(t)},updated(t,{value:e,oldValue:n},{transition:i}){!e!=!n&&(i?e?(i.beforeEnter(t),xi(t,!0),i.enter(t)):i.leave(t,()=>{xi(t,!1)}):xi(t,e))},beforeUnmount(t,{value:e}){xi(t,e)}};function xi(t,e){t.style.display=e?t._vod:"none"}function Sp(){ms.getSSRProps=({value:t})=>{if(!t)return{style:{display:"none"}}}}const vc=De({patchProp:rp},zf);let Hi,za=!1;function mc(){return Hi||(Hi=Fh(vc))}function _c(){return Hi=za?Hi:$h(vc),za=!0,Hi}const io=(...t)=>{mc().render(...t)},yc=(...t)=>{_c().hydrate(...t)},bc=(...t)=>{const e=mc().createApp(...t),{mount:n}=e;return e.mount=i=>{const r=wc(i);if(!r)return;const s=e._component;!oe(s)&&!s.render&&!s.template&&(s.template=r.innerHTML),r.innerHTML="";const o=n(r,!1,r instanceof SVGElement);return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e},xp=(...t)=>{const e=_c().createApp(...t),{mount:n}=e;return e.mount=i=>{const r=wc(i);if(r)return n(r,!0,r instanceof SVGElement)},e};function wc(t){return Me(t)?document.querySelector(t):t}let Va=!1;const Ep=()=>{Va||(Va=!0,yp(),Sp())},Tp=()=>{},kp=Object.freeze(Object.defineProperty({__proto__:null,BaseTransition:Bo,Comment:qe,EffectScope:To,Fragment:ge,KeepAlive:Xd,ReactiveEffect:or,Static:Rn,Suspense:Gd,Teleport:yf,Text:Gn,Transition:_i,TransitionGroup:dc,VueElement:vs,assertNumber:Sd,callWithAsyncErrorHandling:ct,callWithErrorHandling:zt,camelize:it,capitalize:sr,cloneVNode:Gt,compatUtils:jf,compile:Tp,computed:he,createApp:bc,createBlock:Fe,createCommentVNode:ut,createElementBlock:Q,createElementVNode:q,createHydrationRenderer:$h,createPropsRestProxy:Lf,createRenderer:Fh,createSSRApp:xp,createSlots:Qd,createStaticVNode:Vo,createTextVNode:ps,createVNode:le,customRef:ah,defineAsyncComponent:Vd,defineComponent:xe,defineCustomElement:rc,defineEmits:Of,defineExpose:Af,defineProps:Mf,defineSSRCustomElement:op,get devtools(){return Jn},effect:Bu,effectScope:Gu,getCurrentInstance:mn,getCurrentScope:ko,getTransitionRawChildren:hs,guardReactiveProps:zh,h:Zh,handleError:Hn,hydrate:yc,initCustomFormatter:Ff,initDirectivesForSSR:Ep,inject:An,isMemoSame:nc,isProxy:Ao,isReactive:On,isReadonly:Dn,isRef:Be,isRuntimeOnly:Tf,isShallow:Vi,isVNode:dn,markRaw:Bn,mergeDefaults:Df,mergeProps:Vh,nextTick:vi,normalizeClass:Ze,normalizeProps:Eu,normalizeStyle:kt,onActivated:bh,onBeforeMount:Sh,onBeforeUnmount:hr,onBeforeUpdate:xh,onDeactivated:wh,onErrorCaptured:Ph,onMounted:Kt,onRenderTracked:kh,onRenderTriggered:Th,onScopeDispose:zl,onServerPrefetch:Eh,onUnmounted:us,onUpdated:mi,openBlock:W,popScopeId:Od,provide:ls,proxyRefs:No,pushScopeId:Md,queuePostFlushCb:Lo,reactive:_t,readonly:Oo,ref:ne,registerRuntimeCompiler:Ef,render:io,renderList:st,renderSlot:Bt,resolveComponent:Ge,resolveDirective:Jd,resolveDynamicComponent:ds,resolveFilter:Uf,resolveTransitionHooks:ai,setBlockTracking:qs,setDevtoolsHook:fh,setTransitionHooks:Ln,shallowReactive:rh,shallowReadonly:sh,shallowRef:pd,ssrContextKey:ec,ssrUtils:Hf,stop:Hu,toDisplayString:Ke,toHandlerKey:Gi,toHandlers:Zd,toRaw:pe,toRef:vn,toRefs:lh,transformVNodeArgs:bf,triggerRef:vd,unref:Nt,useAttrs:Nf,useCssModule:lp,useCssVars:hp,useSSRContext:tc,useSlots:Rf,useTransitionState:$o,vModelCheckbox:Xo,vModelDynamic:pc,vModelRadio:Ko,vModelSelect:qo,vModelText:gn,vShow:ms,version:ic,warn:Cd,watch:Et,watchEffect:Ud,watchPostEffect:mh,watchSyncEffect:jd,withAsyncContext:Gf,withCtx:Yt,withDefaults:If,withDirectives:un,withKeys:Jo,withMemo:$f,withModifiers:Lt,withScopeId:Ad},Symbol.toStringTag,{value:"Module"}));let Sr;const Pp=new Uint8Array(16);function Mp(){if(!Sr&&(Sr=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Sr))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Sr(Pp)}const je=[];for(let t=0;t<256;++t)je.push((t+256).toString(16).slice(1));function Op(t,e=0){return(je[t[e+0]]+je[t[e+1]]+je[t[e+2]]+je[t[e+3]]+"-"+je[t[e+4]]+je[t[e+5]]+"-"+je[t[e+6]]+je[t[e+7]]+"-"+je[t[e+8]]+je[t[e+9]]+"-"+je[t[e+10]]+je[t[e+11]]+je[t[e+12]]+je[t[e+13]]+je[t[e+14]]+je[t[e+15]]).toLowerCase()}const Ap=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ya={randomUUID:Ap};function ln(t,e,n){if(Ya.randomUUID&&!e&&!t)return Ya.randomUUID();t=t||{};const i=t.random||(t.rng||Mp)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e){n=n||0;for(let r=0;r<16;++r)e[n+r]=i[r];return e}return Op(i)}class Nn{constructor(){this.listenerMap=new Map,this._listeners=[],this.proxyMap=new Map,this.proxies=[]}get listeners(){return this._listeners.concat(this.proxies.flatMap(e=>e()))}subscribe(e,n){this.listenerMap.has(e)&&(console.warn(`Already subscribed. Unsubscribing for you.
Please check that you don't accidentally use the same token twice to register two different handlers for the same event/hook.`),this.unsubscribe(e)),this.listenerMap.set(e,n),this._listeners.push(n)}unsubscribe(e){if(this.listenerMap.has(e)){const n=this.listenerMap.get(e);this.listenerMap.delete(e);const i=this._listeners.indexOf(n);i>=0&&this._listeners.splice(i,1)}}registerProxy(e,n){this.proxyMap.has(e)&&(console.warn(`Already subscribed. Unsubscribing for you.
Please check that you don't accidentally use the same token twice to register two different proxies for the same event/hook.`),this.unregisterProxy(e)),this.proxyMap.set(e,n),this.proxies.push(n)}unregisterProxy(e){if(!this.proxyMap.has(e))return;const n=this.proxyMap.get(e);this.proxyMap.delete(e);const i=this.proxies.indexOf(n);i>=0&&this.proxies.splice(i,1)}}class Pe extends Nn{constructor(e){super(),this.entity=e}emit(e){this.listeners.forEach(n=>n(e,this.entity))}}class Qe extends Nn{constructor(e){super(),this.entity=e}emit(e){let n=!1;const i=()=>[n=!0];for(const r of Array.from(this.listeners.values()))if(r(e,i,this.entity),n)return{prevented:!0};return{prevented:!1}}}class Cc extends Nn{execute(e,n){let i=e;for(const r of this.listeners)i=r(i,n);return i}}class ft extends Cc{constructor(e){super(),this.entity=e}execute(e){return super.execute(e,this.entity)}}class Ip extends Nn{constructor(e){super(),this.entity=e}execute(e){const n=[];for(const i of this.listeners)n.push(i(e,this.entity));return n}}function Rt(){const t=Symbol(),e=new Map,n=new Set,i=(l,h)=>{h instanceof Nn&&h.registerProxy(t,()=>{var c,u;return(u=(c=e.get(l))===null||c===void 0?void 0:c.listeners)!==null&&u!==void 0?u:[]})},r=l=>{const h=new Nn;e.set(l,h),n.forEach(c=>i(l,c[l]))},s=l=>{n.add(l);for(const h of e.keys())i(h,l[h])},o=l=>{for(const h of e.keys())l[h]instanceof Nn&&l[h].unregisterProxy(t);n.delete(l)},a=()=>{n.forEach(l=>o(l)),e.clear()};return new Proxy({},{get(l,h){return h==="addTarget"?s:h==="removeTarget"?o:h==="destroy"?a:typeof h!="string"||h.startsWith("_")?l[h]:(e.has(h)||r(h),e.get(h))}})}class Xa{constructor(e,n){if(this.destructed=!1,this.events={destruct:new Pe(this)},!e||!n)throw new Error("Cannot initialize connection with null/undefined for 'from' or 'to' values");this.id=ln(),this.from=e,this.to=n,this.from.connectionCount++,this.to.connectionCount++}destruct(){this.events.destruct.emit(),this.from.connectionCount--,this.to.connectionCount--,this.destructed=!0}}class Sc{constructor(e,n){if(!e||!n)throw new Error("Cannot initialize connection with null/undefined for 'from' or 'to' values");this.id=ln(),this.from=e,this.to=n}}function ro(t,e){return Object.fromEntries(Object.entries(t).map(([n,i])=>[n,e(i)]))}class xc{constructor(){this.id=ln(),this.events={loaded:new Pe(this),beforeAddInput:new Qe(this),addInput:new Pe(this),beforeRemoveInput:new Qe(this),removeInput:new Pe(this),beforeAddOutput:new Qe(this),addOutput:new Pe(this),beforeRemoveOutput:new Qe(this),removeOutput:new Pe(this),update:new Pe(this)},this.hooks={beforeLoad:new ft(this),afterSave:new ft(this)}}get graph(){return this.graphInstance}addInput(e,n){return this.addInterface("input",e,n)}addOutput(e,n){return this.addInterface("output",e,n)}removeInput(e){return this.removeInterface("input",e)}removeOutput(e){return this.removeInterface("output",e)}registerGraph(e){this.graphInstance=e}load(e){this.hooks.beforeLoad.execute(e),this.id=e.id,this.title=e.title,Object.entries(e.inputs).forEach(([n,i])=>{this.inputs[n]&&(this.inputs[n].load(i),this.inputs[n].nodeId=this.id)}),Object.entries(e.outputs).forEach(([n,i])=>{this.outputs[n]&&(this.outputs[n].load(i),this.outputs[n].nodeId=this.id)}),this.events.loaded.emit(this)}save(){const e=ro(this.inputs,r=>r.save()),n=ro(this.outputs,r=>r.save()),i={type:this.type,id:this.id,title:this.title,inputs:e,outputs:n};return this.hooks.afterSave.execute(i)}onPlaced(){}onDestroy(){}initializeIo(){Object.entries(this.inputs).forEach(([e,n])=>this.initializeIntf("input",e,n)),Object.entries(this.outputs).forEach(([e,n])=>this.initializeIntf("output",e,n))}initializeIntf(e,n,i){i.isInput=e==="input",i.nodeId=this.id,i.events.setValue.subscribe(this,()=>this.events.update.emit({type:e,name:n,intf:i}))}addInterface(e,n,i){const r=e==="input"?this.events.beforeAddInput:this.events.beforeAddOutput,s=e==="input"?this.events.addInput:this.events.addOutput,o=e==="input"?this.inputs:this.outputs;return r.emit(i).prevented?!1:(o[n]=i,this.initializeIntf(e,n,i),s.emit(i),!0)}removeInterface(e,n){const i=e==="input"?this.events.beforeRemoveInput:this.events.beforeRemoveOutput,r=e==="input"?this.events.removeInput:this.events.removeOutput,s=e==="input"?this.inputs[n]:this.outputs[n];if(!s||i.emit(s).prevented)return!1;if(s.connectionCount>0)if(this.graphInstance)this.graphInstance.connections.filter(a=>a.from===s||a.to===s).forEach(a=>{this.graphInstance.removeConnection(a)});else throw new Error("Interface is connected, but no graph instance is specified. Unable to delete interface");return s.events.setValue.unsubscribe(this),e==="input"?delete this.inputs[n]:delete this.outputs[n],r.emit(s),!0}}let Rp=class extends xc{load(e){super.load(e)}save(){return super.save()}};function _s(t){return class extends Rp{constructor(){var e,n;super(),this.type=t.type,this.title=(e=t.title)!==null&&e!==void 0?e:t.type,this.inputs={},this.outputs={},this.calculate=t.calculate?(i,r)=>t.calculate.call(this,i,r):void 0,this.executeFactory("input",t.inputs),this.executeFactory("output",t.outputs),(n=t.onCreate)===null||n===void 0||n.call(this)}onPlaced(){var e;(e=t.onPlaced)===null||e===void 0||e.call(this)}onDestroy(){var e;(e=t.onDestroy)===null||e===void 0||e.call(this)}executeFactory(e,n){Object.keys(n||{}).forEach(i=>{const r=n[i]();e==="input"?this.addInput(i,r):this.addOutput(i,r)})}}}class cr{get nodes(){return this._nodes}get connections(){return this._connections}get loading(){return this._loading}get destroying(){return this._destroying}constructor(e,n){this.id=ln(),this.inputs=[],this.outputs=[],this.activeTransactions=0,this._nodes=[],this._connections=[],this._loading=!1,this._destroying=!1,this.events={beforeAddNode:new Qe(this),addNode:new Pe(this),beforeRemoveNode:new Qe(this),removeNode:new Pe(this),beforeAddConnection:new Qe(this),addConnection:new Pe(this),checkConnection:new Qe(this),beforeRemoveConnection:new Qe(this),removeConnection:new Pe(this)},this.hooks={save:new ft(this),load:new ft(this),checkConnection:new Ip(this)},this.nodeEvents=Rt(),this.nodeHooks=Rt(),this.connectionEvents=Rt(),this.editor=e,this.template=n,e.registerGraph(this)}addNode(e){if(!this.events.beforeAddNode.emit(e).prevented)return this.nodeEvents.addTarget(e.events),this.nodeHooks.addTarget(e.hooks),e.registerGraph(this),this._nodes.push(e),e=this.nodes.find(n=>n.id===e.id),e.onPlaced(),this.events.addNode.emit(e),e}removeNode(e){if(this.nodes.includes(e)){if(this.events.beforeRemoveNode.emit(e).prevented)return;const n=[...Object.values(e.inputs),...Object.values(e.outputs)];this.connections.filter(i=>n.includes(i.from)||n.includes(i.to)).forEach(i=>this.removeConnection(i)),this._nodes.splice(this.nodes.indexOf(e),1),this.events.removeNode.emit(e),e.onDestroy(),this.nodeEvents.removeTarget(e.events),this.nodeHooks.removeTarget(e.hooks)}}addConnection(e,n){const i=this.checkConnection(e,n);if(!i.connectionAllowed||this.events.beforeAddConnection.emit({from:e,to:n}).prevented)return;for(const s of i.connectionsInDanger){const o=this.connections.find(a=>a.id===s.id);o&&this.removeConnection(o)}const r=new Xa(i.dummyConnection.from,i.dummyConnection.to);return this.internalAddConnection(r),r}removeConnection(e){if(this.connections.includes(e)){if(this.events.beforeRemoveConnection.emit(e).prevented)return;e.destruct(),this._connections.splice(this.connections.indexOf(e),1),this.events.removeConnection.emit(e),this.connectionEvents.removeTarget(e.events)}}checkConnection(e,n){if(!e||!n)return{connectionAllowed:!1};const i=this.findNodeById(e.nodeId),r=this.findNodeById(n.nodeId);if(i&&r&&i===r)return{connectionAllowed:!1};if(e.isInput&&!n.isInput){const a=e;e=n,n=a}if(e.isInput||!n.isInput)return{connectionAllowed:!1};if(this.connections.some(a=>a.from===e&&a.to===n))return{connectionAllowed:!1};if(this.events.checkConnection.emit({from:e,to:n}).prevented)return{connectionAllowed:!1};const s=this.hooks.checkConnection.execute({from:e,to:n});if(s.some(a=>!a.connectionAllowed))return{connectionAllowed:!1};const o=Array.from(new Set(s.flatMap(a=>a.connectionsInDanger)));return{connectionAllowed:!0,dummyConnection:new Sc(e,n),connectionsInDanger:o}}findNodeInterface(e){for(const n of this.nodes){for(const i in n.inputs){const r=n.inputs[i];if(r.id===e)return r}for(const i in n.outputs){const r=n.outputs[i];if(r.id===e)return r}}}findNodeById(e){return this.nodes.find(n=>n.id===e)}load(e){try{this._loading=!0;const n=[];for(let i=this.connections.length-1;i>=0;i--)this.removeConnection(this.connections[i]);for(let i=this.nodes.length-1;i>=0;i--)this.removeNode(this.nodes[i]);this.id=e.id,this.inputs=e.inputs,this.outputs=e.outputs;for(const i of e.nodes){const r=this.editor.nodeTypes.get(i.type);if(!r){n.push(`Node type ${i.type} is not registered`);continue}const s=new r.type;this.addNode(s),s.load(i)}for(const i of e.connections){const r=this.findNodeInterface(i.from),s=this.findNodeInterface(i.to);if(r)if(s){const o=new Xa(r,s);o.id=i.id,this.internalAddConnection(o)}else{n.push(`Could not find interface with id ${i.to}`);continue}else{n.push(`Could not find interface with id ${i.from}`);continue}}return this.hooks.load.execute(e),n}finally{this._loading=!1}}save(){const e={id:this.id,nodes:this.nodes.map(n=>n.save()),connections:this.connections.map(n=>({id:n.id,from:n.from.id,to:n.to.id})),inputs:this.inputs,outputs:this.outputs};return this.hooks.save.execute(e)}destroy(){this._destroying=!0;for(const e of this.nodes)this.removeNode(e);this.editor.unregisterGraph(this)}internalAddConnection(e){this.connectionEvents.addTarget(e.events),this._connections.push(e),this.events.addConnection.emit(e)}}let Tt=class{set connectionCount(e){this._connectionCount=e,this.events.setConnectionCount.emit(e)}get connectionCount(){return this._connectionCount}set value(e){this.events.beforeSetValue.emit(e).prevented||(this._value=e,this.events.setValue.emit(e))}get value(){return this._value}constructor(e,n){this.id=ln(),this.nodeId="",this.port=!0,this.hidden=!1,this.events={setConnectionCount:new Pe(this),beforeSetValue:new Qe(this),setValue:new Pe(this),updated:new Pe(this)},this.hooks={load:new ft(this),save:new ft(this)},this._connectionCount=0,this.name=e,this._value=n}load(e){this.id=e.id,this.templateId=e.templateId,this.value=e.value,this.hooks.load.execute(e)}save(){const e={id:this.id,templateId:this.templateId,value:this.value};return this.hooks.save.execute(e)}setComponent(e){return this.component=e,this}setPort(e){return this.port=e,this}setHidden(e){return this.hidden=e,this}use(e,...n){return e(this,...n),this}};const Qi="__baklava_GraphNode-";function ci(t){return Qi+t.id}function Np(t){return class extends xc{constructor(){super(...arguments),this.type=ci(t),this._title="GraphNode",this.inputs={},this.outputs={},this.template=t,this.calculate=async(n,i)=>{if(!this.subgraph)throw new Error(`GraphNode ${this.id}: calculate called without subgraph being initialized`);if(typeof i.engine=="object"&&i.engine&&typeof i.engine.runGraph=="function"){const r=new Map;for(const l of this.subgraph.nodes)Object.values(l.inputs).forEach(h=>{h.connectionCount===0&&r.set(h.id,h.value)});Object.entries(n).forEach(([l,h])=>{const c=this.subgraph.inputs.find(u=>u.id===l);r.set(c.nodeInterfaceId,h)});const s=await i.engine.runGraph(this.subgraph,r,i.globalValues),o=new Map;s.forEach((l,h)=>{const c=this.subgraph.nodes.find(u=>u.id===h);l.forEach((u,d)=>{o.set(c.outputs[d].id,u)})});const a={};return this.subgraph.outputs.forEach(l=>{a[l.id]=o.get(l.nodeInterfaceId)}),a._calculationResults=s,a}}}get title(){return this._title}set title(n){this.template.name=n}load(n){if(!this.subgraph)throw new Error("Cannot load a graph node without a graph");if(!this.template)throw new Error("Unable to load graph node without graph template");this.subgraph.load(n.graphState),super.load(n)}save(){if(!this.subgraph)throw new Error("Cannot save a graph node without a graph");return{...super.save(),graphState:this.subgraph.save()}}onPlaced(){this.template.events.updated.subscribe(this,()=>this.initialize()),this.template.events.nameChanged.subscribe(this,n=>{this._title=n}),this.initialize()}onDestroy(){var n;this.template.events.updated.unsubscribe(this),this.template.events.nameChanged.unsubscribe(this),(n=this.subgraph)===null||n===void 0||n.destroy()}initialize(){this.subgraph&&this.subgraph.destroy(),this.subgraph=this.template.createGraph(),this._title=this.template.name,this.updateInterfaces(),this.events.update.emit(null)}updateInterfaces(){if(!this.subgraph)throw new Error("Trying to update interfaces without graph instance");for(const n of this.subgraph.inputs)n.id in this.inputs?this.inputs[n.id].name=n.name:this.addInput(n.id,new Tt(n.name,void 0));for(const n of Object.keys(this.inputs))this.subgraph.inputs.some(i=>i.id===n)||this.removeInput(n);for(const n of this.subgraph.outputs)n.id in this.outputs?this.outputs[n.id].name=n.name:this.addOutput(n.id,new Tt(n.name,void 0));for(const n of Object.keys(this.outputs))this.subgraph.outputs.some(i=>i.id===n)||this.removeOutput(n);this.addOutput("_calculationResults",new Tt("_calculationResults",void 0).setHidden(!0))}}}class ys{static fromGraph(e,n){return new ys(e.save(),n)}get name(){return this._name}set name(e){this._name=e,this.events.nameChanged.emit(e);const n=this.editor.nodeTypes.get(ci(this));n&&(n.title=e)}constructor(e,n){this.id=ln(),this._name="Subgraph",this.events={nameChanged:new Pe(this),updated:new Pe(this)},this.hooks={beforeLoad:new ft(this),afterSave:new ft(this)},this.editor=n,e.id&&(this.id=e.id),e.name&&(this._name=e.name),this.update(e)}update(e){this.nodes=e.nodes,this.connections=e.connections,this.inputs=e.inputs,this.outputs=e.outputs,this.events.updated.emit()}save(){return{id:this.id,name:this.name,nodes:this.nodes,connections:this.connections,inputs:this.inputs,outputs:this.outputs}}createGraph(e){const n=new Map,i=u=>{const d=ln();return n.set(u,d),d},r=u=>{const d=n.get(u);if(!d)throw new Error(`Unable to create graph from template: Could not map old id ${u} to new id`);return d},s=u=>ro(u,d=>({id:i(d.id),templateId:d.id,value:d.value})),o=this.nodes.map(u=>({...u,id:i(u.id),inputs:s(u.inputs),outputs:s(u.outputs)})),a=this.connections.map(u=>({id:i(u.id),from:r(u.from),to:r(u.to)})),l=this.inputs.map(u=>({id:u.id,name:u.name,nodeInterfaceId:r(u.nodeInterfaceId)})),h=this.outputs.map(u=>({id:u.id,name:u.name,nodeInterfaceId:r(u.nodeInterfaceId)})),c={id:ln(),nodes:o,connections:a,inputs:l,outputs:h};return e||(e=new cr(this.editor)),e.load(c),e.template=this,e}}let Dp=class{constructor(){this.events={loaded:new Pe(this),beforeRegisterNodeType:new Qe(this),registerNodeType:new Pe(this),beforeUnregisterNodeType:new Qe(this),unregisterNodeType:new Pe(this),beforeAddGraphTemplate:new Qe(this),addGraphTemplate:new Pe(this),beforeRemoveGraphTemplate:new Qe(this),removeGraphTemplate:new Pe(this),registerGraph:new Pe(this),unregisterGraph:new Pe(this)},this.hooks={save:new ft(this),load:new ft(this)},this.graphTemplateEvents=Rt(),this.graphTemplateHooks=Rt(),this.graphEvents=Rt(),this.graphHooks=Rt(),this.nodeEvents=Rt(),this.nodeHooks=Rt(),this.connectionEvents=Rt(),this._graphs=new Set,this._nodeTypes=new Map,this._graph=new cr(this),this._graphTemplates=[],this._loading=!1}get nodeTypes(){return this._nodeTypes}get graph(){return this._graph}get graphTemplates(){return this._graphTemplates}get graphs(){return this._graphs}get loading(){return this._loading}registerNodeType(e,n){var i,r;if(this.events.beforeRegisterNodeType.emit({type:e,options:n}).prevented)return;const s=new e;this._nodeTypes.set(s.type,{type:e,category:(i=n==null?void 0:n.category)!==null&&i!==void 0?i:"default",title:(r=n==null?void 0:n.title)!==null&&r!==void 0?r:s.title}),this.events.registerNodeType.emit({type:e,options:n})}unregisterNodeType(e){const n=typeof e=="string"?e:new e().type;if(this.nodeTypes.has(n)){if(this.events.beforeUnregisterNodeType.emit(n).prevented)return;this._nodeTypes.delete(n),this.events.unregisterNodeType.emit(n)}}addGraphTemplate(e){if(this.events.beforeAddGraphTemplate.emit(e).prevented)return;this._graphTemplates.push(e),this.graphTemplateEvents.addTarget(e.events),this.graphTemplateHooks.addTarget(e.hooks);const n=Np(e);this.registerNodeType(n,{category:"Subgraphs",title:e.name}),this.events.addGraphTemplate.emit(e)}removeGraphTemplate(e){if(this.graphTemplates.includes(e)){if(this.events.beforeRemoveGraphTemplate.emit(e).prevented)return;const n=ci(e);for(const i of[this.graph,...this.graphs.values()]){const r=i.nodes.filter(s=>s.type===n);for(const s of r)i.removeNode(s)}this.unregisterNodeType(n),this._graphTemplates.splice(this._graphTemplates.indexOf(e),1),this.graphTemplateEvents.removeTarget(e.events),this.graphTemplateHooks.removeTarget(e.hooks),this.events.removeGraphTemplate.emit(e)}}registerGraph(e){this.graphEvents.addTarget(e.events),this.graphHooks.addTarget(e.hooks),this.nodeEvents.addTarget(e.nodeEvents),this.nodeHooks.addTarget(e.nodeHooks),this.connectionEvents.addTarget(e.connectionEvents),this.events.registerGraph.emit(e),this._graphs.add(e)}unregisterGraph(e){this.graphEvents.removeTarget(e.events),this.graphHooks.removeTarget(e.hooks),this.nodeEvents.removeTarget(e.nodeEvents),this.nodeHooks.removeTarget(e.nodeHooks),this.connectionEvents.removeTarget(e.connectionEvents),this.events.unregisterGraph.emit(e),this._graphs.delete(e)}load(e){try{this._loading=!0,e=this.hooks.load.execute(e),e.graphTemplates.forEach(i=>{const r=new ys(i,this);this.addGraphTemplate(r)});const n=this._graph.load(e.graph);return this.events.loaded.emit(),n.forEach(i=>console.warn(i)),n}finally{this._loading=!1}}save(){const e={graph:this.graph.save(),graphTemplates:this.graphTemplates.map(n=>n.save())};return this.hooks.save.execute(e)}};function Lp(t,e){const n=new Map;e.graphs.forEach(i=>{i.nodes.forEach(r=>n.set(r.id,r))}),t.forEach((i,r)=>{const s=n.get(r);s&&i.forEach((o,a)=>{const l=s.outputs[a];l&&(l.value=o)})})}class Ec extends Error{constructor(){super("Cycle detected")}}function Gp(t){return typeof t=="string"}function Tc(t,e){const n=new Map,i=new Map,r=new Map;let s,o;if(t instanceof cr)s=t.nodes,o=t.connections;else{if(!e)throw new Error("Invalid argument value: expected array of connections");s=t,o=e}s.forEach(h=>{Object.values(h.inputs).forEach(c=>n.set(c.id,h.id)),Object.values(h.outputs).forEach(c=>n.set(c.id,h.id))}),s.forEach(h=>{const c=o.filter(d=>d.from&&n.get(d.from.id)===h.id),u=new Set(c.map(d=>n.get(d.to.id)).filter(Gp));i.set(h.id,u),r.set(h,c)});const a=s.slice();o.forEach(h=>{const c=a.findIndex(u=>n.get(h.to.id)===u.id);c>=0&&a.splice(c,1)});const l=[];for(;a.length>0;){const h=a.pop();l.push(h);const c=i.get(h.id);for(;c.size>0;){const u=c.values().next().value;if(c.delete(u),Array.from(i.values()).every(d=>!d.has(u))){const d=s.find(p=>p.id===u);a.push(d)}}}if(Array.from(i.values()).some(h=>h.size>0))throw new Ec;return{calculationOrder:l,connectionsFromNode:r,interfaceIdToNodeId:n}}function Fp(t,e){try{return Tc(t,e),!1}catch(n){if(n instanceof Ec)return!0;throw n}}var et;(function(t){t.Running="Running",t.Idle="Idle",t.Paused="Paused",t.Stopped="Stopped"})(et||(et={}));class $p{get status(){return this.isRunning?et.Running:this.internalStatus}constructor(e){this.editor=e,this.events={beforeRun:new Qe(this),afterRun:new Pe(this),statusChange:new Pe(this)},this.hooks={gatherCalculationData:new ft(this),transferData:new Cc},this.recalculateOrder=!0,this.internalStatus=et.Stopped,this.isRunning=!1,this.editor.nodeEvents.update.subscribe(this,(n,i)=>{i.graph&&!i.graph.loading&&i.graph.activeTransactions===0&&this.internalOnChange(i,n??void 0)}),this.editor.graphEvents.addNode.subscribe(this,(n,i)=>{this.recalculateOrder=!0,!i.loading&&i.activeTransactions===0&&this.internalOnChange()}),this.editor.graphEvents.removeNode.subscribe(this,(n,i)=>{this.recalculateOrder=!0,!i.loading&&i.activeTransactions===0&&this.internalOnChange()}),this.editor.graphEvents.addConnection.subscribe(this,(n,i)=>{this.recalculateOrder=!0,!i.loading&&i.activeTransactions===0&&this.internalOnChange()}),this.editor.graphEvents.removeConnection.subscribe(this,(n,i)=>{this.recalculateOrder=!0,!i.loading&&i.activeTransactions===0&&this.internalOnChange()}),this.editor.graphHooks.checkConnection.subscribe(this,n=>this.checkConnection(n.from,n.to))}start(){this.internalStatus===et.Stopped&&(this.internalStatus=et.Idle,this.events.statusChange.emit(this.status))}pause(){this.internalStatus===et.Idle&&(this.internalStatus=et.Paused,this.events.statusChange.emit(this.status))}resume(){this.internalStatus===et.Paused&&(this.internalStatus=et.Idle,this.events.statusChange.emit(this.status))}stop(){(this.internalStatus===et.Idle||this.internalStatus===et.Paused)&&(this.internalStatus=et.Stopped,this.events.statusChange.emit(this.status))}async runOnce(e,...n){if(this.events.beforeRun.emit(e).prevented)return null;try{this.isRunning=!0,this.events.statusChange.emit(this.status),this.recalculateOrder&&this.calculateOrder();const i=await this.execute(e,...n);return this.events.afterRun.emit(i),i}finally{this.isRunning=!1,this.events.statusChange.emit(this.status)}}checkConnection(e,n){if(e.templateId){const s=this.findInterfaceByTemplateId(this.editor.graph.nodes,e.templateId);if(!s)return{connectionAllowed:!0,connectionsInDanger:[]};e=s}if(n.templateId){const s=this.findInterfaceByTemplateId(this.editor.graph.nodes,n.templateId);if(!s)return{connectionAllowed:!0,connectionsInDanger:[]};n=s}const i=new Sc(e,n);let r=this.editor.graph.connections.slice();return n.allowMultipleConnections||(r=r.filter(s=>s.to!==n)),r.push(i),Fp(this.editor.graph.nodes,r)?{connectionAllowed:!1,connectionsInDanger:[]}:{connectionAllowed:!0,connectionsInDanger:n.allowMultipleConnections?[]:this.editor.graph.connections.filter(s=>s.to===n)}}calculateOrder(){this.recalculateOrder=!0}async calculateWithoutData(...e){const n=this.hooks.gatherCalculationData.execute(void 0);return await this.runOnce(n,...e)}validateNodeCalculationOutput(e,n){if(typeof n!="object")throw new Error(`Invalid calculation return value from node ${e.id} (type ${e.type})`);Object.keys(e.outputs).forEach(i=>{if(!(i in n))throw new Error(`Calculation return value from node ${e.id} (type ${e.type}) is missing key "${i}"`)})}internalOnChange(e,n){this.internalStatus===et.Idle&&this.onChange(this.recalculateOrder,e,n)}findInterfaceByTemplateId(e,n){for(const i of e)for(const r of[...Object.values(i.inputs),...Object.values(i.outputs)])if(r.templateId===n)return r;return null}}class Bp extends $p{constructor(e){super(e),this.order=new Map}start(){super.start(),this.recalculateOrder=!0,this.calculateWithoutData()}async runGraph(e,n,i){this.order.has(e.id)||this.order.set(e.id,Tc(e));const{calculationOrder:r,connectionsFromNode:s}=this.order.get(e.id),o=new Map;for(const a of r){if(!a.calculate)continue;const l={};Object.entries(a.inputs).forEach(([c,u])=>{if(!n.has(u.id))throw new Error(`Could not find value for interface ${u.id}
This is likely a Baklava internal issue. Please report it on GitHub.`);l[c]=n.get(u.id)});const h=await a.calculate(l,{globalValues:i,engine:this});this.validateNodeCalculationOutput(a,h),o.set(a.id,new Map(Object.entries(h))),s.has(a)&&s.get(a).forEach(c=>{var u;const d=(u=Object.entries(a.outputs).find(([,f])=>f.id===c.from.id))===null||u===void 0?void 0:u[0];if(!d)throw new Error(`Could not find key for interface ${c.from.id}
This is likely a Baklava internal issue. Please report it on GitHub.`);const p=this.hooks.transferData.execute(h[d],c);c.to.allowMultipleConnections?n.has(c.to.id)?n.get(c.to.id).push(p):n.set(c.to.id,[p]):n.set(c.to.id,p)})}return o}async execute(e){this.recalculateOrder&&(this.order.clear(),this.recalculateOrder=!1);const n=new Map;for(const i of this.editor.graph.nodes)Object.values(i.inputs).forEach(r=>{r.connectionCount===0&&n.set(r.id,r.value)});return await this.runGraph(this.editor.graph,n,e)}onChange(e){this.recalculateOrder=e||this.recalculateOrder,this.calculateWithoutData()}}let so=null;function Hp(t){so=t}function Ft(){if(!so)throw new Error("providePlugin() must be called before usePlugin()");return{viewModel:so}}function Pt(){const{viewModel:t}=Ft();return{graph:vn(t.value,"displayedGraph"),switchGraph:t.value.switchGraph}}function kc(t){const{graph:e}=Pt(),n=ne(null),i=ne(null);return{dragging:he(()=>!!n.value),onPointerDown:l=>{n.value={x:l.pageX,y:l.pageY},i.value={x:t.value.x,y:t.value.y}},onPointerMove:l=>{if(n.value){const h=l.pageX-n.value.x,c=l.pageY-n.value.y;t.value.x=i.value.x+h/e.value.scaling,t.value.y=i.value.y+c/e.value.scaling}},onPointerUp:()=>{n.value=null,i.value=null}}}function Up(){const{graph:t}=Pt();return{transform:(n,i)=>{const r=n/t.value.scaling-t.value.panning.x,s=i/t.value.scaling-t.value.panning.y;return[r,s]}}}function jp(){const{graph:t}=Pt();let e=[],n=-1,i={x:0,y:0};const r=he(()=>t.value.panning),s=kc(r),o=he(()=>({"transform-origin":"0 0",transform:`scale(${t.value.scaling}) translate(${t.value.panning.x}px, ${t.value.panning.y}px)`})),a=(p,f,v)=>{const _=[p/t.value.scaling-t.value.panning.x,f/t.value.scaling-t.value.panning.y],y=[p/v-t.value.panning.x,f/v-t.value.panning.y],g=[y[0]-_[0],y[1]-_[1]];t.value.panning.x+=g[0],t.value.panning.y+=g[1],t.value.scaling=v},l=p=>{p.preventDefault();let f=p.deltaY;p.deltaMode===1&&(f*=32);const v=t.value.scaling*(1-f/3e3);a(p.offsetX,p.offsetY,v)},h=()=>({ax:e[0].clientX,ay:e[0].clientY,bx:e[1].clientX,by:e[1].clientY});return{styles:o,...s,onPointerDown:p=>{if(e.push(p),s.onPointerDown(p),e.length===2){const{ax:f,ay:v,bx:_,by:y}=h();i={x:f+(_-f)/2,y:v+(y-v)/2}}},onPointerMove:p=>{for(let f=0;f<e.length;f++)if(p.pointerId==e[f].pointerId){e[f]=p;break}if(e.length==2){const{ax:f,ay:v,bx:_,by:y}=h(),g=f-_,m=v-y,S=Math.sqrt(g*g+m*m);if(n>0){const P=t.value.scaling*(1+(S-n)/500);a(i.x,i.y,P)}n=S}else s.onPointerMove(p)},onPointerUp:p=>{e=e.filter(f=>f.pointerId!==p.pointerId),n=-1,s.onPointerUp()},onMouseWheel:l}}var vt=(t=>(t[t.NONE=0]="NONE",t[t.ALLOWED=1]="ALLOWED",t[t.FORBIDDEN=2]="FORBIDDEN",t))(vt||{});function Wp(){const{graph:t}=Pt(),e=ne(null),n=ne(null),i=a=>{e.value&&(e.value.mx=a.offsetX/t.value.scaling-t.value.panning.x,e.value.my=a.offsetY/t.value.scaling-t.value.panning.y)},r=()=>{if(n.value){const a=t.value.connections.find(l=>l.to===n.value);n.value.isInput&&a?(e.value={status:vt.NONE,from:a.from},t.value.removeConnection(a)):e.value={status:vt.NONE,from:n.value},e.value.mx=void 0,e.value.my=void 0}},s=()=>{e.value&&n.value&&t.value.addConnection(e.value.from,e.value.to),e.value=null};return ls("hoveredOver",a=>{if(n.value=a??null,a&&e.value){e.value.to=a;const l=t.value.checkConnection(e.value.from,e.value.to);if(e.value.status=l.connectionAllowed?vt.ALLOWED:vt.FORBIDDEN,l.connectionAllowed){const h=l.connectionsInDanger.map(c=>c.id);t.value.connections.forEach(c=>{h.includes(c.id)&&(c.isInDanger=!0)})}}else!a&&e.value&&(e.value.to=void 0,e.value.status=vt.NONE,t.value.connections.forEach(l=>{l.isInDanger=!1}))}),{temporaryConnection:e,onMouseMove:i,onMouseDown:r,onMouseUp:s}}const zp=xe({setup(){const{viewModel:t}=Ft(),{graph:e}=Pt();return{styles:he(()=>{const i=t.value.settings.background,r=e.value.panning.x*e.value.scaling,s=e.value.panning.y*e.value.scaling,o=e.value.scaling*i.gridSize,a=o/i.gridDivision,l=`${o}px ${o}px, ${o}px ${o}px`,h=e.value.scaling>i.subGridVisibleThreshold?`, ${a}px ${a}px, ${a}px ${a}px`:"";return{backgroundPosition:`left ${r}px top ${s}px`,backgroundSize:`${l} ${h}`}})}}}),ke=(t,e)=>{const n=t.__vccOpts||t;for(const[i,r]of e)n[i]=r;return n};function Vp(t,e,n,i,r,s){return W(),Q("div",{class:"background",style:kt(t.styles)},null,4)}const Yp=ke(zp,[["render",Vp]]);var Ka;const Pc=typeof window<"u",Xp=t=>typeof t=="string",Kp=()=>{};Pc&&((Ka=window==null?void 0:window.navigator)!=null&&Ka.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function qp(t){return typeof t=="function"?t():Nt(t)}function Jp(t){return t}function Qp(t,e,n=!1){return e.reduce((i,r)=>(r in t&&(!n||t[r]!==void 0)&&(i[r]=t[r]),i),{})}function Zp(t){return ko()?(zl(t),!0):!1}var eg=Object.defineProperty,tg=Object.defineProperties,ng=Object.getOwnPropertyDescriptors,qa=Object.getOwnPropertySymbols,ig=Object.prototype.hasOwnProperty,rg=Object.prototype.propertyIsEnumerable,Ja=(t,e,n)=>e in t?eg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,sg=(t,e)=>{for(var n in e||(e={}))ig.call(e,n)&&Ja(t,n,e[n]);if(qa)for(var n of qa(e))rg.call(e,n)&&Ja(t,n,e[n]);return t},og=(t,e)=>tg(t,ng(e));function ag(t){if(!Be(t))return lh(t);const e=Array.isArray(t.value)?new Array(t.value.length):{};for(const n in t.value)e[n]=ah(()=>({get(){return t.value[n]},set(i){if(Array.isArray(t.value)){const r=[...t.value];r[n]=i,t.value=r}else{const r=og(sg({},t.value),{[n]:i});Object.setPrototypeOf(r,t.value),t.value=r}}}));return e}function Ai(t){var e;const n=qp(t);return(e=n==null?void 0:n.$el)!=null?e:n}const Qo=Pc?window:void 0;function Pn(...t){let e,n,i,r;if(Xp(t[0])||Array.isArray(t[0])?([n,i,r]=t,e=Qo):[e,n,i,r]=t,!e)return Kp;Array.isArray(n)||(n=[n]),Array.isArray(i)||(i=[i]);const s=[],o=()=>{s.forEach(c=>c()),s.length=0},a=(c,u,d)=>(c.addEventListener(u,d,r),()=>c.removeEventListener(u,d,r)),l=Et(()=>Ai(e),c=>{o(),c&&s.push(...n.flatMap(u=>i.map(d=>a(c,u,d))))},{immediate:!0,flush:"post"}),h=()=>{l(),o()};return Zp(h),h}function oo(t,e,n={}){const{window:i=Qo,ignore:r=[],capture:s=!0,detectIframe:o=!1}=n;if(!i)return;let a=!0,l;const h=p=>r.some(f=>{if(typeof f=="string")return Array.from(i.document.querySelectorAll(f)).some(v=>v===p.target||p.composedPath().includes(v));{const v=Ai(f);return v&&(p.target===v||p.composedPath().includes(v))}}),c=p=>{i.clearTimeout(l);const f=Ai(t);if(!(!f||f===p.target||p.composedPath().includes(f))){if(p.detail===0&&(a=!h(p)),!a){a=!0;return}e(p)}},u=[Pn(i,"click",c,{passive:!0,capture:s}),Pn(i,"pointerdown",p=>{const f=Ai(t);f&&(a=!p.composedPath().includes(f)&&!h(p))},{passive:!0}),Pn(i,"pointerup",p=>{if(p.button===0){const f=p.composedPath();p.composedPath=()=>f,l=i.setTimeout(()=>c(p),50)}},{passive:!0}),o&&Pn(i,"blur",p=>{var f;const v=Ai(t);((f=i.document.activeElement)==null?void 0:f.tagName)==="IFRAME"&&!(v!=null&&v.contains(i.document.activeElement))&&e(p)})].filter(Boolean);return()=>u.forEach(p=>p())}const Qa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Za="__vueuse_ssr_handlers__";Qa[Za]=Qa[Za]||{};var lg=Object.defineProperty,hg=Object.defineProperties,cg=Object.getOwnPropertyDescriptors,el=Object.getOwnPropertySymbols,ug=Object.prototype.hasOwnProperty,dg=Object.prototype.propertyIsEnumerable,tl=(t,e,n)=>e in t?lg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,fg=(t,e)=>{for(var n in e||(e={}))ug.call(e,n)&&tl(t,n,e[n]);if(el)for(var n of el(e))dg.call(e,n)&&tl(t,n,e[n]);return t},pg=(t,e)=>hg(t,cg(e));const Mc={x:0,y:0,pointerId:0,pressure:0,tiltX:0,tiltY:0,width:0,height:0,twist:0,pointerType:null},gg=Object.keys(Mc);function vg(t={}){const{target:e=Qo}=t,n=ne(!1),i=ne(t.initialValue||{});Object.assign(i.value,Mc,i.value);const r=s=>{n.value=!0,!(t.pointerTypes&&!t.pointerTypes.includes(s.pointerType))&&(i.value=Qp(s,gg,!1))};return e&&(Pn(e,"pointerdown",r,{passive:!0}),Pn(e,"pointermove",r,{passive:!0}),Pn(e,"pointerleave",()=>n.value=!1,{passive:!0})),pg(fg({},ag(i)),{isInside:n})}var nl;(function(t){t.UP="UP",t.RIGHT="RIGHT",t.DOWN="DOWN",t.LEFT="LEFT",t.NONE="NONE"})(nl||(nl={}));var mg=Object.defineProperty,il=Object.getOwnPropertySymbols,_g=Object.prototype.hasOwnProperty,yg=Object.prototype.propertyIsEnumerable,rl=(t,e,n)=>e in t?mg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,bg=(t,e)=>{for(var n in e||(e={}))_g.call(e,n)&&rl(t,n,e[n]);if(il)for(var n of il(e))yg.call(e,n)&&rl(t,n,e[n]);return t};const wg={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};bg({linear:Jp},wg);const Cg=xe({props:{modelValue:{type:Boolean,default:!1},items:{type:Array,required:!0},x:{type:Number,default:0},y:{type:Number,default:0},isNested:{type:Boolean,default:!1},isFlipped:{type:Object,default:()=>({x:!1,y:!1})},flippable:{type:Boolean,default:!1}},emits:["click","update:modelValue"],setup(t,{emit:e}){let n=null;const i=ne(null),r=ne(-1),s=ne(0),o=ne({x:!1,y:!1}),a=he(()=>t.flippable&&(o.value.x||t.isFlipped.x)),l=he(()=>t.flippable&&(o.value.y||t.isFlipped.y)),h=he(()=>{const _={};return t.isNested||(_.top=(l.value?t.y-s.value:t.y)+"px",_.left=t.x+"px"),_}),c=he(()=>({"--flipped-x":a.value,"--flipped-y":l.value,"--nested":t.isNested})),u=he(()=>t.items.map(_=>({..._,hover:!1})));return Et([()=>t.y,()=>t.items],()=>{var _,y,g,m;s.value=t.items.length*30;const S=((y=(_=i.value)==null?void 0:_.parentElement)==null?void 0:y.offsetWidth)??0,P=((m=(g=i.value)==null?void 0:g.parentElement)==null?void 0:m.offsetHeight)??0;o.value.x=!t.isNested&&t.x>S*.75,o.value.y=!t.isNested&&t.y+s.value>P-20}),oo(i,()=>{t.modelValue&&e("update:modelValue",!1)}),{el:i,activeMenu:r,flippedX:a,flippedY:l,styles:h,classes:c,itemsWithHoverProperty:u,onClick:_=>{!_.submenu&&_.value&&(e("click",_.value),e("update:modelValue",!1))},onChildClick:_=>{e("click",_),r.value=-1,t.isNested||e("update:modelValue",!1)},onClickOutside:oo,onMouseEnter:(_,y)=>{t.items[y].submenu&&(r.value=y,n!==null&&(clearTimeout(n),n=null))},onMouseLeave:(_,y)=>{t.items[y].submenu&&(n=window.setTimeout(()=>{r.value=-1,n=null},200))}}}}),Sg=["onMouseenter","onMouseleave","onClick"],xg={class:"flex-fill"},Eg={key:0,class:"__submenu-icon",style:{"line-height":"1em"}},Tg=q("svg",{width:"13",height:"13",viewBox:"-60 120 250 250"},[q("path",{d:"M160.875 279.5625 L70.875 369.5625 L70.875 189.5625 L160.875 279.5625 Z",stroke:"none",fill:"white"})],-1),kg=[Tg];function Pg(t,e,n,i,r,s){const o=Ge("context-menu",!0);return W(),Fe(_i,{name:"slide-fade"},{default:Yt(()=>[un(q("div",{ref:"el",class:Ze(["baklava-context-menu",t.classes]),style:kt(t.styles)},[(W(!0),Q(ge,null,st(t.itemsWithHoverProperty,(a,l)=>(W(),Q(ge,null,[a.isDivider?(W(),Q("div",{key:`d-${l}`,class:"divider"})):(W(),Q("div",{key:`i-${l}`,class:Ze(["item",{submenu:!!a.submenu,"--disabled":!!a.disabled}]),onMouseenter:h=>t.onMouseEnter(h,l),onMouseleave:h=>t.onMouseLeave(h,l),onClick:Lt(h=>t.onClick(a),["stop","prevent"])},[q("div",xg,Ke(a.label),1),a.submenu?(W(),Q("div",Eg,kg)):ut("",!0),a.submenu?(W(),Fe(o,{key:1,value:t.activeMenu===l,items:a.submenu,"is-nested":!0,"is-flipped":{x:t.flippedX,y:t.flippedY},flippable:t.flippable,onClick:t.onChildClick},null,8,["value","items","is-flipped","flippable","onClick"])):ut("",!0)],42,Sg))],64))),256))],6),[[ms,t.modelValue]])]),_:1})}const Oc=ke(Cg,[["render",Pg]]),Mg={},Og={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"16",height:"16",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},Ag=q("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),Ig=q("circle",{cx:"12",cy:"12",r:"1"},null,-1),Rg=q("circle",{cx:"12",cy:"19",r:"1"},null,-1),Ng=q("circle",{cx:"12",cy:"5",r:"1"},null,-1),Dg=[Ag,Ig,Rg,Ng];function Lg(t,e){return W(),Q("svg",Og,Dg)}const Ac=ke(Mg,[["render",Lg]]),Gg=xe({props:{node:{type:Object,required:!0},intf:{type:Object,required:!0}},setup(t){const{viewModel:e}=Ft(),n=An("hoveredOver"),i=ne(null),r=he(()=>t.intf.connectionCount>0),s=he(()=>({"--input":t.intf.isInput,"--output":!t.intf.isInput,"--connected":r.value})),o=he(()=>t.intf.component&&t.intf.connectionCount===0&&(t.intf.isInput||!t.intf.port)),a=()=>{n(t.intf)},l=()=>{n(void 0)},h=()=>{i.value&&e.value.hooks.renderInterface.execute({intf:t.intf,el:i.value})},c=()=>{const u=e.value.displayedGraph.sidebar;u.nodeId=t.node.id,u.optionName=t.intf.name,u.visible=!0};return Kt(h),mi(h),{el:i,isConnected:r,classes:s,showComponent:o,startHover:a,endHover:l,openSidebar:c}}}),Fg=["id"],$g={key:2,class:"align-middle"};function Bg(t,e,n,i,r,s){return W(),Q("div",{id:t.intf.id,ref:"el",class:Ze(["baklava-node-interface",t.classes])},[t.intf.port?(W(),Q("div",{key:0,class:"__port",onPointerover:e[0]||(e[0]=(...o)=>t.startHover&&t.startHover(...o)),onPointerout:e[1]||(e[1]=(...o)=>t.endHover&&t.endHover(...o))},null,32)):ut("",!0),t.showComponent?(W(),Fe(ds(t.intf.component),{key:1,modelValue:t.intf.value,"onUpdate:modelValue":e[2]||(e[2]=o=>t.intf.value=o),node:t.node,intf:t.intf,onOpenSidebar:t.openSidebar},null,40,["modelValue","node","intf","onOpenSidebar"])):(W(),Q("span",$g,Ke(t.intf.name),1))],10,Fg)}const sl=ke(Gg,[["render",Bg]]),Hg=["id","data-node-type"],Ug=["onPointerdown"],jg={class:"__title-label"},Wg={class:"__menu"},zg=["onKeydown"],Vg={class:"__content"},Yg={class:"__outputs"},Xg={class:"__inputs"},Kg=xe({__name:"Node",props:{node:null,selected:{type:Boolean,default:!1}},emits:["select"],setup(t,{emit:e}){const n=t,{viewModel:i}=Ft(),{graph:r,switchGraph:s}=Pt(),o=kc(vn(n.node,"position")),a=ne(null),l=ne(!1),h=ne(""),c=ne(null),u=ne(!1),d=he(()=>{const C=[{value:"rename",label:"Rename"},{value:"delete",label:"Delete"}];return n.node.type.startsWith(Qi)&&C.push({value:"editSubgraph",label:"Edit Subgraph"}),C}),p=he(()=>({"--selected":n.selected,"--dragging":o.dragging.value,"--two-column":!!n.node.twoColumn})),f=he(()=>{var C,M;return{top:`${((C=n.node.position)==null?void 0:C.y)??0}px`,left:`${((M=n.node.position)==null?void 0:M.x)??0}px`,width:`${n.node.width??200}px`}}),v=he(()=>Object.values(n.node.inputs).filter(C=>!C.hidden)),_=he(()=>Object.values(n.node.outputs).filter(C=>!C.hidden)),y=()=>{e("select")},g=C=>{o.onPointerDown(C),document.addEventListener("pointermove",o.onPointerMove),document.addEventListener("pointerup",m),y()},m=()=>{o.onPointerUp(),document.removeEventListener("pointermove",o.onPointerMove),document.removeEventListener("pointerup",m)},S=()=>{u.value=!0},P=async C=>{var M;switch(C){case"delete":r.value.removeNode(n.node);break;case"rename":h.value=n.node.title,l.value=!0,await vi(),(M=c.value)==null||M.focus();break;case"editSubgraph":s(n.node.template);break}},k=()=>{n.node.title=h.value,l.value=!1},x=()=>{a.value&&i.value.hooks.renderNode.execute({node:n.node,el:a.value})};return Kt(x),mi(x),(C,M)=>(W(),Q("div",{id:t.node.id,ref_key:"el",ref:a,class:Ze(["baklava-node",Nt(p)]),style:kt(Nt(f)),"data-node-type":t.node.type,onPointerdown:y},[q("div",{class:"__title",onPointerdown:Lt(g,["self","stop"])},[l.value?un((W(),Q("input",{key:1,ref_key:"renameInputEl",ref:c,"onUpdate:modelValue":M[1]||(M[1]=I=>h.value=I),type:"text",class:"baklava-input",placeholder:"Node Name",onBlur:k,onKeydown:Jo(k,["enter"])},null,40,zg)),[[gn,h.value]]):(W(),Q(ge,{key:0},[q("div",jg,Ke(t.node.title),1),q("div",Wg,[le(Ac,{class:"--clickable",onClick:S}),le(Oc,{modelValue:u.value,"onUpdate:modelValue":M[0]||(M[0]=I=>u.value=I),x:0,y:0,items:Nt(d),onClick:P},null,8,["modelValue","items"])])],64))],40,Ug),q("div",Vg,[q("div",Yg,[(W(!0),Q(ge,null,st(Nt(_),I=>(W(),Fe(sl,{key:I.id,node:t.node,intf:I},null,8,["node","intf"]))),128))]),q("div",Xg,[(W(!0),Q(ge,null,st(Nt(v),I=>(W(),Fe(sl,{key:I.id,node:t.node,intf:I},null,8,["node","intf"]))),128))])])],46,Hg))}}),qg=xe({props:{x1:{type:Number,required:!0},y1:{type:Number,required:!0},x2:{type:Number,required:!0},y2:{type:Number,required:!0},state:{type:Number,default:vt.NONE},isTemporary:{type:Boolean,default:!1}},setup(t){const{viewModel:e}=Ft(),{graph:n}=Pt(),i=(o,a)=>{const l=(o+n.value.panning.x)*n.value.scaling,h=(a+n.value.panning.y)*n.value.scaling;return[l,h]},r=he(()=>{const[o,a]=i(t.x1,t.y1),[l,h]=i(t.x2,t.y2);if(e.value.settings.useStraightConnections)return`M ${o} ${a} L ${l} ${h}`;{const c=.3*Math.abs(o-l);return`M ${o} ${a} C ${o+c} ${a}, ${l-c} ${h}, ${l} ${h}`}}),s=he(()=>({"--temporary":t.isTemporary,"--allowed":t.state===vt.ALLOWED,"--forbidden":t.state===vt.FORBIDDEN}));return{d:r,classes:s}}}),Jg=["d"];function Qg(t,e,n,i,r,s){return W(),Q("path",{class:Ze(["baklava-connection",t.classes]),d:t.d},null,10,Jg)}const Ic=ke(qg,[["render",Qg]]);function Zg(t){return document.getElementById(t.id)}function ui(t){const e=document.getElementById(t.id),n=e==null?void 0:e.getElementsByClassName("__port");return{node:(e==null?void 0:e.closest(".baklava-node"))??null,interface:e,port:n&&n.length>0?n[0]:null}}const ev=xe({components:{"connection-view":Ic},props:{connection:{type:Object,required:!0}},setup(t){const{graph:e}=Pt();let n;const i=ne({x1:0,y1:0,x2:0,y2:0}),r=he(()=>t.connection.isInDanger?vt.FORBIDDEN:vt.NONE),s=he(()=>{var h;return(h=e.value.findNodeById(t.connection.from.nodeId))==null?void 0:h.position}),o=he(()=>{var h;return(h=e.value.findNodeById(t.connection.to.nodeId))==null?void 0:h.position}),a=h=>h.node&&h.interface&&h.port?[h.node.offsetLeft+h.interface.offsetLeft+h.port.offsetLeft+h.port.clientWidth/2,h.node.offsetTop+h.interface.offsetTop+h.port.offsetTop+h.port.clientHeight/2]:[0,0],l=()=>{const h=ui(t.connection.from),c=ui(t.connection.to);h.node&&c.node&&(n||(n=new ResizeObserver(()=>{l()}),n.observe(h.node),n.observe(c.node)));const[u,d]=a(h),[p,f]=a(c);i.value={x1:u,y1:d,x2:p,y2:f}};return Kt(async()=>{await vi(),l()}),hr(()=>{n&&n.disconnect()}),Et([s,o],()=>l(),{deep:!0}),{d:i,state:r}}});function tv(t,e,n,i,r,s){const o=Ge("connection-view");return W(),Fe(o,{x1:t.d.x1,y1:t.d.y1,x2:t.d.x2,y2:t.d.y2,state:t.state},null,8,["x1","y1","x2","y2","state"])}const nv=ke(ev,[["render",tv]]);function Kr(t){return t.node&&t.interface&&t.port?[t.node.offsetLeft+t.interface.offsetLeft+t.port.offsetLeft+t.port.clientWidth/2,t.node.offsetTop+t.interface.offsetTop+t.port.offsetTop+t.port.clientHeight/2]:[0,0]}const iv=xe({components:{"connection-view":Ic},props:{connection:{type:Object,required:!0}},setup(t){const e=he(()=>t.connection?t.connection.status:vt.NONE);return{d:he(()=>{if(!t.connection)return{input:[0,0],output:[0,0]};const i=Kr(ui(t.connection.from)),r=t.connection.to?Kr(ui(t.connection.to)):[t.connection.mx||i[0],t.connection.my||i[1]];return t.connection.from.isInput?{input:r,output:i}:{input:i,output:r}}),status:e}}});function rv(t,e,n,i,r,s){const o=Ge("connection-view");return W(),Fe(o,{x1:t.d.input[0],y1:t.d.input[1],x2:t.d.output[0],y2:t.d.output[1],state:t.status,"is-temporary":""},null,8,["x1","y1","x2","y2","state"])}const sv=ke(iv,[["render",rv]]),ov=xe({setup(){const{graph:t}=Pt(),e=ne(null),n=ne(300),i=he(()=>{const h=t.value.sidebar.nodeId;return t.value.nodes.find(c=>c.id===h)}),r=he(()=>({width:`${n.value}px`})),s=he(()=>i.value?[...Object.values(i.value.inputs),...Object.values(i.value.outputs)].filter(c=>c.displayInSidebar&&c.component):[]),o=()=>{t.value.sidebar.visible=!1},a=()=>{window.addEventListener("mousemove",l),window.addEventListener("mouseup",()=>{window.removeEventListener("mousemove",l)},{once:!0})},l=h=>{var c,u;const d=((u=(c=e.value)==null?void 0:c.parentElement)==null?void 0:u.getBoundingClientRect().width)??500;n.value-=h.movementX,n.value<300?n.value=300:n.value>.9*d&&(n.value=.9*d)};return{el:e,graph:t,node:i,styles:r,displayedInterfaces:s,startResize:a,close:o}}}),av={class:"__header"},lv={class:"__node-name"};function hv(t,e,n,i,r,s){return W(),Q("div",{ref:"el",class:Ze(["baklava-sidebar",{"--open":t.graph.sidebar.visible}]),style:kt(t.styles)},[q("div",{class:"__resizer",onMousedown:e[0]||(e[0]=(...o)=>t.startResize&&t.startResize(...o))},null,32),q("div",av,[q("button",{tabindex:"-1",class:"__close",onClick:e[1]||(e[1]=(...o)=>t.close&&t.close(...o))},"  "),q("div",lv,[q("b",null,Ke(t.node?t.node.title:""),1)])]),(W(!0),Q(ge,null,st(t.displayedInterfaces,o=>(W(),Q("div",{key:o.id,class:"__interface"},[(W(),Fe(ds(o.component),{modelValue:o.value,"onUpdate:modelValue":a=>o.value=a,node:t.node,intf:o},null,8,["modelValue","onUpdate:modelValue","node","intf"]))]))),128))],6)}const cv=ke(ov,[["render",hv]]),uv=xe({setup(){const{viewModel:t}=Ft(),{graph:e}=Pt(),n=ne(null),i=ne(!1);let r,s=!1,o={x1:0,y1:0,x2:0,y2:0};const a=()=>{var g,m;if(!r)return;const S=new Map,P=new Map;for(const C of e.value.nodes){const M=Zg(C),I=(M==null?void 0:M.clientWidth)??0,N=(M==null?void 0:M.clientHeight)??0,D=((g=C.position)==null?void 0:g.x)??0,A=((m=C.position)==null?void 0:m.y)??0;S.set(C,{x1:D,y1:A,x2:D+I,y2:A+N}),P.set(C,M)}const k={x1:Number.MAX_SAFE_INTEGER,y1:Number.MAX_SAFE_INTEGER,x2:Number.MIN_SAFE_INTEGER,y2:Number.MIN_SAFE_INTEGER};for(const C of S.values())C.x1<k.x1&&(k.x1=C.x1),C.y1<k.y1&&(k.y1=C.y1),C.x2>k.x2&&(k.x2=C.x2),C.y2>k.y2&&(k.y2=C.y2);const x=50;k.x1-=x,k.y1-=x,k.x2+=x,k.y2+=x,o=k,r.clearRect(0,0,r.canvas.width,r.canvas.height),r.strokeStyle="white";for(const C of e.value.connections){const[M,I]=Kr(ui(C.from)),[N,D]=Kr(ui(C.to)),[A,O]=l(M,I),[V,$]=l(N,D);if(r.beginPath(),r.moveTo(A,O),t.value.settings.useStraightConnections)r.lineTo(V,$);else{const K=.3*Math.abs(A-V);r.bezierCurveTo(A+K,O,V-K,$,V,$)}r.stroke()}r.strokeStyle="lightgray";for(const[C,M]of S.entries()){const[I,N]=l(M.x1,M.y1),[D,A]=l(M.x2,M.y2);r.fillStyle=c(P.get(C)),r.beginPath(),r.rect(I,N,D-I,A-N),r.fill(),r.stroke()}if(i.value){const C=d(),[M,I]=l(C.x1,C.y1),[N,D]=l(C.x2,C.y2);r.fillStyle="rgba(255, 255, 255, 0.2)",r.fillRect(M,I,N-M,D-I)}},l=(g,m)=>[(g-o.x1)/(o.x2-o.x1)*r.canvas.clientWidth,(m-o.y1)/(o.y2-o.y1)*r.canvas.clientHeight],h=(g,m)=>[g*(o.x2-o.x1)/r.canvas.clientWidth+o.x1,m*(o.y2-o.y1)/r.canvas.clientHeight+o.y1],c=g=>{if(g){const m=g.querySelector(".__content");if(m){const P=u(m);if(P)return P}const S=u(g);if(S)return S}return"gray"},u=g=>{const m=getComputedStyle(g).backgroundColor;if(m&&m!=="rgba(0, 0, 0, 0)")return m},d=()=>{const g=n.value.parentElement.offsetWidth,m=n.value.parentElement.offsetHeight,S=g/e.value.scaling-e.value.panning.x,P=m/e.value.scaling-e.value.panning.y;return{x1:-e.value.panning.x,y1:-e.value.panning.y,x2:S,y2:P}},p=g=>{g.button===0&&(s=!0,f(g))},f=g=>{if(s){const[m,S]=h(g.offsetX,g.offsetY),P=d(),k=(P.x1-P.x2)/2,x=(P.y1-P.y2)/2;e.value.panning.x=-(m+k),e.value.panning.y=-(S+x)}},v=()=>{s=!1},_=()=>{i.value=!0},y=()=>{i.value=!1,v()};return Kt(()=>{r=n.value.getContext("2d"),r.imageSmoothingQuality="high",a()}),{canvas:n,showViewBounds:i,mousedown:p,mousemove:f,mouseup:v,mouseenter:_,mouseleave:y}}});function dv(t,e,n,i,r,s){return W(),Q("canvas",{ref:"canvas",class:"baklava-minimap",onMouseenter:e[0]||(e[0]=(...o)=>t.mouseenter&&t.mouseenter(...o)),onMouseleave:e[1]||(e[1]=(...o)=>t.mouseleave&&t.mouseleave(...o)),onMousedown:e[2]||(e[2]=Lt((...o)=>t.mousedown&&t.mousedown(...o),["self"])),onMousemove:e[3]||(e[3]=Lt((...o)=>t.mousemove&&t.mousemove(...o),["self"])),onMouseup:e[4]||(e[4]=(...o)=>t.mouseup&&t.mouseup(...o))},null,544)}const fv=ke(uv,[["render",dv]]),pv=xe({components:{ContextMenu:Oc,VerticalDots:Ac},props:{type:{type:String,required:!0},title:{type:String,required:!0}},setup(t){const{viewModel:e}=Ft(),{switchGraph:n}=Pt(),i=ne(!1),r=he(()=>t.type.startsWith(Qi));return{showContextMenu:i,hasContextMenu:r,contextMenuItems:[{label:"Edit Subgraph",value:"editSubgraph"},{label:"Delete Subgraph",value:"deleteSubgraph"}],openContextMenu:()=>{i.value=!0},onContextMenuClick:l=>{const h=t.type.substring(Qi.length),c=e.value.editor.graphTemplates.find(u=>u.id===h);if(c)switch(l){case"editSubgraph":n(c);break;case"deleteSubgraph":e.value.editor.removeGraphTemplate(c);break}}}}}),gv=["data-node-type"],vv={class:"__title"},mv={class:"__title-label"},_v={key:0,class:"__menu"};function yv(t,e,n,i,r,s){const o=Ge("vertical-dots"),a=Ge("context-menu");return W(),Q("div",{class:"baklava-node --palette","data-node-type":t.type},[q("div",vv,[q("div",mv,Ke(t.title),1),t.hasContextMenu?(W(),Q("div",_v,[le(o,{class:"--clickable",onPointerdown:e[0]||(e[0]=Lt(()=>{},["stop","prevent"])),onClick:Lt(t.openContextMenu,["stop","prevent"])},null,8,["onClick"]),le(a,{modelValue:t.showContextMenu,"onUpdate:modelValue":e[1]||(e[1]=l=>t.showContextMenu=l),x:-100,y:0,items:t.contextMenuItems,onClick:t.onContextMenuClick,onPointerdown:e[2]||(e[2]=Lt(()=>{},["stop","prevent"]))},null,8,["modelValue","items","onClick"])])):ut("",!0)])],8,gv)}const bv=ke(pv,[["render",yv]]);let xr;const wv=new Uint8Array(16);function Cv(){if(!xr&&(xr=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!xr))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return xr(wv)}const We=[];for(let t=0;t<256;++t)We.push((t+256).toString(16).slice(1));function Sv(t,e=0){return(We[t[e+0]]+We[t[e+1]]+We[t[e+2]]+We[t[e+3]]+"-"+We[t[e+4]]+We[t[e+5]]+"-"+We[t[e+6]]+We[t[e+7]]+"-"+We[t[e+8]]+We[t[e+9]]+"-"+We[t[e+10]]+We[t[e+11]]+We[t[e+12]]+We[t[e+13]]+We[t[e+14]]+We[t[e+15]]).toLowerCase()}const xv=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ol={randomUUID:xv};function Zi(t,e,n){if(ol.randomUUID&&!e&&!t)return ol.randomUUID();t=t||{};const i=t.random||(t.rng||Cv)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e){n=n||0;for(let r=0;r<16;++r)e[n+r]=i[r];return e}return Sv(i)}xe({props:{intf:{type:Object,required:!0}},setup(t){return{onClick:()=>{t.intf.callback&&t.intf.callback()}}}});xe({props:{intf:{type:Object,required:!0}}});const al=9;function Ev(t){return"validate"in t}class Tv extends Tt{constructor(e,n,i,r){super(e,n),this.min=i,this.max=r}validate(e){return(!this.min||e>=this.min)&&(!this.max||e<=this.max)}}const Zo=(t,e=3)=>{const n=ne(null),i=ne(!1),r=ne(!1),s=ne("0"),o=he(()=>{const u=t.value.value.toFixed(e);return u.length>al?t.value.value.toExponential(al-5):u}),a=u=>Number.isNaN(u)?!1:Ev(t.value)?t.value.validate(u):!0,l=u=>{a(u)&&(t.value.value=u)};return Et(s,()=>{r.value=!1}),{editMode:i,invalid:r,tempValue:s,inputEl:n,stringRepresentation:o,validate:a,setValue:l,enterEditMode:async()=>{s.value=t.value.value.toFixed(e),i.value=!0,await vi(),n.value&&n.value.focus()},leaveEditMode:()=>{const u=parseFloat(s.value);a(u)?(l(u),i.value=!1):r.value=!0}}},kv={},Pv={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},Mv=q("polyline",{points:"6 9 12 15 18 9"},null,-1),Ov=[Mv];function Av(t,e){return W(),Q("svg",Pv,Ov)}const ea=ke(kv,[["render",Av]]);xe({components:{"i-arrow":ea},props:{intf:{type:Object,required:!0}},setup(t){const e=Zo(vn(t,"intf"),0);return{...e,increment:()=>{e.setValue(t.intf.value+1)},decrement:()=>{e.setValue(t.intf.value-1)}}}});const Iv=xe({components:{"i-arrow":ea},props:{intf:{type:Object,required:!0}},setup(t){const e=Zo(vn(t,"intf"));return{...e,increment:()=>{e.setValue(t.intf.value+.1)},decrement:()=>{e.setValue(t.intf.value-.1)}}}}),Rv={class:"baklava-num-input"},Nv=["title"],Dv={class:"__value"},Lv={key:1,class:"__content"};function Gv(t,e,n,i,r,s){const o=Ge("i-arrow");return W(),Q("div",Rv,[q("div",{class:"__button --dec",onClick:e[0]||(e[0]=(...a)=>t.decrement&&t.decrement(...a))},[le(o)]),t.editMode?(W(),Q("div",Lv,[un(q("input",{ref:"inputEl","onUpdate:modelValue":e[2]||(e[2]=a=>t.tempValue=a),type:"number",class:Ze(["baklava-input",{"--invalid":t.invalid}]),style:{"text-align":"right"},onBlur:e[3]||(e[3]=(...a)=>t.leaveEditMode&&t.leaveEditMode(...a)),onKeydown:e[4]||(e[4]=Jo((...a)=>t.leaveEditMode&&t.leaveEditMode(...a),["enter"]))},null,34),[[gn,t.tempValue]])])):(W(),Q("div",{key:0,class:"__content",onClick:e[1]||(e[1]=(...a)=>t.enterEditMode&&t.enterEditMode(...a))},[q("div",{class:"__label",title:t.intf.name},Ke(t.intf.name),9,Nv),q("div",Dv,Ke(t.stringRepresentation),1)])),q("div",{class:"__button --inc",onClick:e[5]||(e[5]=(...a)=>t.increment&&t.increment(...a))},[le(o)])])}const Fv=ke(Iv,[["render",Gv]]);class ll extends Tv{constructor(){super(...arguments),this.component=Bn(Fv)}}const $v=xe({components:{"i-arrow":ea},props:{intf:{type:Object,required:!0}},setup(t){const e=ne(null),n=ne(!1),i=he(()=>t.intf.items.find(o=>typeof o=="string"?o===t.intf.value:o.value===t.intf.value)),r=he(()=>i.value?typeof i.value=="string"?i.value:i.value.text:""),s=o=>{t.intf.value=typeof o=="string"?o:o.value};return oo(e,()=>{n.value=!1}),{el:e,open:n,selectedItem:i,selectedText:r,setSelected:s}}}),Bv=["title"],Hv={class:"__selected"},Uv={class:"__text"},jv={class:"__icon"},Wv={class:"__dropdown"},zv={class:"item --header"},Vv=["onClick"];function Yv(t,e,n,i,r,s){const o=Ge("i-arrow");return W(),Q("div",{ref:"el",class:Ze(["baklava-select",{"--open":t.open}]),title:t.intf.name,onClick:e[0]||(e[0]=a=>t.open=!t.open)},[q("div",Hv,[q("div",Uv,Ke(t.selectedText),1),q("div",jv,[le(o)])]),le(_i,{name:"slide-fade"},{default:Yt(()=>[un(q("div",Wv,[q("div",zv,Ke(t.intf.name),1),(W(!0),Q(ge,null,st(t.intf.items,(a,l)=>(W(),Q("div",{key:l,class:Ze(["item",{"--active":a===t.selectedItem}]),onClick:h=>t.setSelected(a)},Ke(typeof a=="string"?a:a.text),11,Vv))),128))],512),[[ms,t.open]])]),_:1})],10,Bv)}const Xv=ke($v,[["render",Yv]]);class Kv extends Tt{constructor(e,n,i){super(e,n),this.component=Bn(Xv),this.items=i}}xe({props:{intf:{type:Object,required:!0}},setup(t){const e=ne(null),n=Zo(vn(t,"intf")),i=ne(!1),r=ne(!1),s=he(()=>Math.min(100,Math.max(0,t.intf.value*100/(t.intf.max-t.intf.min))));return{...n,el:e,percentage:s,mousedown:()=>{n.editMode.value||(r.value=!0)},mouseup:()=>{n.editMode.value||(i.value||n.enterEditMode(),r.value=!1,i.value=!1)},mousemove:c=>{if(n.editMode.value)return;const u=Math.max(t.intf.min,Math.min(t.intf.max,(t.intf.max-t.intf.min)*(c.offsetX/e.value.clientWidth)+t.intf.min));r.value&&(n.setValue(u),i.value=!0)},mouseleave:c=>{n.editMode.value||(r.value&&(c.offsetX>=e.value.clientWidth?n.setValue(t.intf.max):c.offsetX<=0&&n.setValue(t.intf.min)),r.value=!1,i.value=!1)}}}});const qv=xe({props:{intf:{type:Object,required:!0}}});function Jv(t,e,n,i,r,s){return W(),Q("div",null,Ke(t.intf.value),1)}const Qv=ke(qv,[["render",Jv]]);class Zv extends Tt{constructor(e,n){super(e,n),this.component=Bn(Qv),this.setPort(!1)}}const em=xe({props:{intf:{type:Object,required:!0},modelValue:{type:String,required:!0}},emits:["update:modelValue"],setup(t,{emit:e}){return{v:he({get:()=>t.modelValue,set:i=>{e("update:modelValue",i)}})}}}),tm=["placeholder","title"];function nm(t,e,n,i,r,s){return W(),Q("div",null,[un(q("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>t.v=o),type:"text",class:"baklava-input",placeholder:t.intf.name,title:t.intf.name},null,8,tm),[[gn,t.v]])])}const im=ke(em,[["render",nm]]);class Rc extends Tt{constructor(){super(...arguments),this.component=Bn(im)}}const er="__baklava_SubgraphInputNode",tr="__baklava_SubgraphOutputNode",Nc=_s({type:er,title:"Subgraph Input",inputs:{name:()=>new Rc("Name","Input").setPort(!1)},outputs:{placeholder:()=>new Tt("Connection",void 0)},onCreate(){this.graphInterfaceId=Zi()}}),Dc=_s({type:tr,title:"Subgraph Output",inputs:{name:()=>new Rc("Name","Output").setPort(!1),placeholder:()=>new Tt("Connection",void 0)},onCreate(){this.graphInterfaceId=Zi()}});function Lc(t,e,n){if(!e.template)return!1;if(ci(e.template)===n)return!0;const i=t.graphTemplates.find(s=>ci(s)===n);return i?i.nodes.filter(s=>s.type.startsWith(Qi)).some(s=>Lc(t,e,s.type)):!1}const rm=xe({components:{PaletteEntry:bv},setup(){const{viewModel:t}=Ft(),{x:e,y:n}=vg(),{transform:i}=Up(),r=An("editorEl"),s=ne(null),o=he(()=>{const h=Array.from(t.value.editor.nodeTypes.entries()),c=new Set(h.map(([,d])=>d.category)),u=[];for(const d of c.values()){let p=h.filter(([,f])=>f.category===d);t.value.displayedGraph.template?p=p.filter(([f])=>!Lc(t.value.editor,t.value.displayedGraph,f)):p=p.filter(([f])=>![er,tr].includes(f)),p.length>0&&u.push({name:d,nodeTypes:Object.fromEntries(p)})}return u.sort((d,p)=>d.name==="default"?-1:p.name==="default"||d.name>p.name?1:-1),u}),a=he(()=>{if(!s.value||!(r!=null&&r.value))return{};const{left:h,top:c}=r.value.getBoundingClientRect();return{top:`${n.value-c}px`,left:`${e.value-h}px`}});return{draggedNode:s,categories:o,draggedNodeStyles:a,onDragStart:(h,c)=>{s.value={type:h,nodeInformation:c};const u=()=>{const d=_t(new c.type);t.value.displayedGraph.addNode(d);const p=r.value.getBoundingClientRect(),[f,v]=i(e.value-p.left,n.value-p.top);d.position.x=f,d.position.y=v,s.value=null,document.removeEventListener("pointerup",u)};document.addEventListener("pointerup",u)},mouseX:e,mouseY:n}}}),sm={class:"baklava-node-palette"},om={key:0};function am(t,e,n,i,r,s){const o=Ge("PaletteEntry");return W(),Q(ge,null,[q("div",sm,[(W(!0),Q(ge,null,st(t.categories,a=>(W(),Q("section",{key:a.name},[a.name!=="default"?(W(),Q("h1",om,Ke(a.name),1)):ut("",!0),(W(!0),Q(ge,null,st(a.nodeTypes,(l,h)=>(W(),Fe(o,{key:h,type:h,title:l.title,onPointerdown:c=>t.onDragStart(h,l)},null,8,["type","title","onPointerdown"]))),128))]))),128))]),le(_i,{name:"fade"},{default:Yt(()=>[t.draggedNode?(W(),Q("div",{key:0,class:"baklava-dragged-node",style:kt(t.draggedNodeStyles)},[le(o,{type:t.draggedNode.type,title:t.draggedNode.nodeInformation.title},null,8,["type","title"])],4)):ut("",!0)]),_:1})],64)}const lm=ke(rm,[["render",am]]),nr="SAVE_SUBGRAPH";function hm(t,e){const n=()=>{const i=t.value;if(!i.template)throw new Error("Graph template property not set");const r=[],s=[],o=i.nodes.filter(u=>u.type===er);for(const u of o){const d=i.connections.filter(p=>p.from===u.outputs.placeholder);d.forEach(p=>{s.push({id:u.graphInterfaceId,name:u.inputs.name.value,nodeInterfaceId:p.to.id})}),r.push(...d)}const a=[],l=i.nodes.filter(u=>u.type===tr);for(const u of l){const d=i.connections.filter(p=>p.to===u.inputs.placeholder);d.forEach(p=>{a.push({id:u.graphInterfaceId,name:u.inputs.name.value,nodeInterfaceId:p.from.id})}),r.push(...d)}const h=i.connections.filter(u=>!r.includes(u)),c=i.nodes.filter(u=>u.type!==er&&u.type!==tr);i.template.update({inputs:s,outputs:a,connections:h.map(u=>({id:u.id,from:u.from.id,to:u.to.id})),nodes:c.map(u=>u.save())}),i.template.panning=i.panning,i.template.scaling=i.scaling};e.registerCommand(nr,{canExecute:()=>{var i;return t.value!==((i=t.value.editor)==null?void 0:i.graph)},execute:n})}const Gc="CREATE_SUBGRAPH",hl=[er,tr];function cm(t,e,n){const i=()=>t.value.selectedNodes.filter(s=>!hl.includes(s.type)).length>0,r=()=>{const s=t.value,o=t.value.editor;if(s.selectedNodes.length===0)return;const a=s.selectedNodes.filter(x=>!hl.includes(x.type)),l=a.flatMap(x=>Object.values(x.inputs)),h=a.flatMap(x=>Object.values(x.outputs)),c=s.connections.filter(x=>!h.includes(x.from)&&l.includes(x.to)),u=s.connections.filter(x=>h.includes(x.from)&&!l.includes(x.to)),d=s.connections.filter(x=>h.includes(x.from)&&l.includes(x.to)),p=c.map(x=>x.to),f=u.map(x=>x.from),v=new Map,_=[];for(const x of p){const C=Zi();v.set(x.id,C),_.push({id:C,nodeInterfaceId:x.id,name:x.name})}const y=[];for(const x of f){const C=Zi();v.set(x.id,C),y.push({id:C,nodeInterfaceId:x.id,name:x.name})}const g=_t(new ys({connections:d.map(x=>({id:x.id,from:x.from.id,to:x.to.id})),inputs:_,outputs:y,nodes:a.map(x=>x.save())},o));o.addGraphTemplate(g);const m=o.nodeTypes.get(ci(g));if(!m)throw new Error("Unable to create subgraph: Could not find corresponding graph node type");const S=_t(new m.type);s.addNode(S);const P=Math.round(a.map(x=>x.position.x).reduce((x,C)=>x+C,0)/a.length),k=Math.round(a.map(x=>x.position.y).reduce((x,C)=>x+C,0)/a.length);S.position.x=P,S.position.y=k,c.forEach(x=>{s.removeConnection(x),s.addConnection(x.from,S.inputs[v.get(x.to.id)])}),u.forEach(x=>{s.removeConnection(x),s.addConnection(S.outputs[v.get(x.from.id)],x.to)}),a.forEach(x=>s.removeNode(x)),e.canExecuteCommand(nr)&&e.executeCommand(nr),n(g),t.value.panning={...s.panning},t.value.scaling=s.scaling};e.registerCommand(Gc,{canExecute:i,execute:r})}const cl="DELETE_NODES";function um(t,e){e.registerCommand(cl,{canExecute:()=>t.value.selectedNodes.length>0,execute(){t.value.selectedNodes.forEach(n=>t.value.removeNode(n))}}),e.registerHotkey(["Delete"],cl)}const Fc="SWITCH_TO_MAIN_GRAPH";function dm(t,e,n){e.registerCommand(Fc,{canExecute:()=>t.value!==t.value.editor.graph,execute:()=>{e.executeCommand(nr),n(t.value.editor.graph)}})}function fm(t,e,n){um(t,e),cm(t,e,n),hm(t,e),dm(t,e,n)}class ul{constructor(e,n){this.type=e,e==="addNode"?this.nodeId=n:this.nodeState=n}undo(e){this.type==="addNode"?this.removeNode(e):this.addNode(e)}redo(e){this.type==="addNode"&&this.nodeState?this.addNode(e):this.type==="removeNode"&&this.nodeId&&this.removeNode(e)}addNode(e){const n=e.editor.nodeTypes.get(this.nodeState.type);if(!n)return;const i=new n.type;e.addNode(i),i.load(this.nodeState),this.nodeId=i.id}removeNode(e){const n=e.nodes.find(i=>i.id===this.nodeId);n&&(this.nodeState=n.save(),e.removeNode(n))}}class dl{constructor(e,n){if(this.type=e,e==="addConnection")this.connectionId=n;else{const i=n;this.connectionState={id:i.id,from:i.from.id,to:i.to.id}}}undo(e){this.type==="addConnection"?this.removeConnection(e):this.addConnection(e)}redo(e){this.type==="addConnection"&&this.connectionState?this.addConnection(e):this.type==="removeConnection"&&this.connectionId&&this.removeConnection(e)}addConnection(e){const n=e.findNodeInterface(this.connectionState.from),i=e.findNodeInterface(this.connectionState.to);!n||!i||e.addConnection(n,i)}removeConnection(e){const n=e.connections.find(i=>i.id===this.connectionId);n&&(this.connectionState={id:n.id,from:n.from.id,to:n.to.id},e.removeConnection(n))}}class pm{constructor(e){if(this.type="transaction",e.length===0)throw new Error("Can't create a transaction with no steps");this.steps=e}undo(e){for(let n=this.steps.length-1;n>=0;n--)this.steps[n].undo(e)}redo(e){for(let n=0;n<this.steps.length;n++)this.steps[n].redo(e)}}const ao="UNDO",lo="REDO",$c="START_TRANSACTION",Bc="COMMIT_TRANSACTION";function gm(t,e){const n=Symbol("HistoryToken"),i=ne(200),r=ne([]),s=ne(!1),o=ne(-1),a=ne(!1),l=ne([]),h=_=>{if(!s.value)if(a.value)l.value.push(_);else for(o.value!==r.value.length-1&&(r.value=r.value.slice(0,o.value+1)),r.value.push(_),o.value++;r.value.length>i.value;)r.value.shift()},c=()=>{a.value=!0},u=()=>{a.value=!1,l.value.length>0&&(h(new pm(l.value)),l.value=[])},d=()=>r.value.length!==0&&o.value!==-1,p=()=>{d()&&(s.value=!0,r.value[o.value--].undo(t.value),s.value=!1)},f=()=>r.value.length!==0&&o.value<r.value.length-1,v=()=>{f()&&(s.value=!0,r.value[++o.value].redo(t.value),s.value=!1)};return Et(t,(_,y)=>{y&&(y.events.addNode.unsubscribe(n),y.events.removeNode.unsubscribe(n),y.events.addConnection.unsubscribe(n),y.events.removeConnection.unsubscribe(n)),_&&(_.events.addNode.subscribe(n,g=>{h(new ul("addNode",g.id))}),_.events.removeNode.subscribe(n,g=>{h(new ul("removeNode",g.save()))}),_.events.addConnection.subscribe(n,g=>{h(new dl("addConnection",g.id))}),_.events.removeConnection.subscribe(n,g=>{h(new dl("removeConnection",g))}))},{immediate:!0}),e.registerCommand(ao,{canExecute:d,execute:p}),e.registerCommand(lo,{canExecute:f,execute:v}),e.registerCommand($c,{canExecute:()=>!a.value,execute:c}),e.registerCommand(Bc,{canExecute:()=>a.value,execute:u}),e.registerHotkey(["Control","z"],ao),e.registerHotkey(["Control","y"],lo),_t({maxSteps:i})}const ho="COPY",co="PASTE",vm="CLEAR_CLIPBOARD";function mm(t,e,n){const i=Symbol("ClipboardToken"),r=ne(""),s=ne(""),o=he(()=>!r.value),a=()=>{r.value="",s.value=""},l=()=>{const u=t.value.selectedNodes.flatMap(p=>[...Object.values(p.inputs),...Object.values(p.outputs)]),d=t.value.connections.filter(p=>u.includes(p.from)||u.includes(p.to)).map(p=>({from:p.from.id,to:p.to.id}));s.value=JSON.stringify(d),r.value=JSON.stringify(t.value.selectedNodes.map(p=>p.save()))},h=(u,d,p)=>{for(const f of u){let v;if((!p||p==="input")&&(v=Object.values(f.inputs).find(_=>_.id===d)),!v&&(!p||p==="output")&&(v=Object.values(f.outputs).find(_=>_.id===d)),v)return v}},c=()=>{if(o.value)return;const u=new Map,d=JSON.parse(r.value),p=JSON.parse(s.value),f=[],v=[],_=t.value;n.executeCommand($c);for(const y of d){const g=e.value.nodeTypes.get(y.type);if(!g){console.warn(`Node type ${y.type} not registered`);return}const m=new g.type,S=m.id;f.push(m);const P=k=>{Object.values(k).forEach(x=>{x.hooks.load.subscribe(i,C=>{const M=Zi();return u.set(C.id,M),x.id=M,x.hooks.load.unsubscribe(i),C})})};P(m.inputs),P(m.outputs),m.hooks.beforeLoad.subscribe(i,k=>{const x=k;return x.position&&(x.position.x+=10,x.position.y+=10),m.hooks.beforeLoad.unsubscribe(i),x}),_.addNode(m),m.load(y),m.id=S,u.set(y.id,S)}for(const y of p){const g=h(f,u.get(y.from),"output"),m=h(f,u.get(y.to),"input");if(!g||!m)continue;const S=_.addConnection(g,m);S&&v.push(S)}return n.executeCommand(Bc),{newNodes:f,newConnections:v}};return n.registerCommand(ho,{canExecute:()=>!0,execute:l}),n.registerHotkey(["Control","c"],ho),n.registerCommand(co,{canExecute:()=>!o.value,execute:c}),n.registerHotkey(["Control","v"],co),n.registerCommand(vm,{canExecute:()=>!0,execute:a}),_t({isEmpty:o})}const _m="OPEN_SIDEBAR";function ym(t,e){e.registerCommand(_m,{execute:n=>{t.value.sidebar.nodeId=n,t.value.sidebar.visible=!0},canExecute:()=>!0})}function bm(t,e){ym(t,e)}const wm={},Cm={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},Sm=q("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),xm=q("path",{d:"M9 13l-4 -4l4 -4m-4 4h11a4 4 0 0 1 0 8h-1"},null,-1),Em=[Sm,xm];function Tm(t,e){return W(),Q("svg",Cm,Em)}const km=ke(wm,[["render",Tm]]),Pm={},Mm={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},Om=q("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),Am=q("path",{d:"M15 13l4 -4l-4 -4m4 4h-11a4 4 0 0 0 0 8h1"},null,-1),Im=[Om,Am];function Rm(t,e){return W(),Q("svg",Mm,Im)}const Nm=ke(Pm,[["render",Rm]]),Dm={},Lm={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},Gm=q("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),Fm=q("line",{x1:"5",y1:"12",x2:"19",y2:"12"},null,-1),$m=q("line",{x1:"5",y1:"12",x2:"11",y2:"18"},null,-1),Bm=q("line",{x1:"5",y1:"12",x2:"11",y2:"6"},null,-1),Hm=[Gm,Fm,$m,Bm];function Um(t,e){return W(),Q("svg",Lm,Hm)}const jm=ke(Dm,[["render",Um]]),Wm={},zm={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},Vm=q("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),Ym=q("path",{d:"M9 5h-2a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-12a2 2 0 0 0 -2 -2h-2"},null,-1),Xm=q("rect",{x:"9",y:"3",width:"6",height:"4",rx:"2"},null,-1),Km=[Vm,Ym,Xm];function qm(t,e){return W(),Q("svg",zm,Km)}const Jm=ke(Wm,[["render",qm]]),Qm={},Zm={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},e0=q("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),t0=q("rect",{x:"8",y:"8",width:"12",height:"12",rx:"2"},null,-1),n0=q("path",{d:"M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"},null,-1),i0=[e0,t0,n0];function r0(t,e){return W(),Q("svg",Zm,i0)}const s0=ke(Qm,[["render",r0]]),o0={},a0={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},l0=q("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),h0=q("path",{d:"M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2"},null,-1),c0=q("circle",{cx:"12",cy:"14",r:"2"},null,-1),u0=q("polyline",{points:"14 4 14 8 8 8 8 4"},null,-1),d0=[l0,h0,c0,u0];function f0(t,e){return W(),Q("svg",a0,d0)}const p0=ke(o0,[["render",f0]]),g0={},v0={xmlns:"http://www.w3.org/2000/svg",class:"baklava-icon",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},m0=Vo('<path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 3h4v4h-4z"></path><path d="M3 17h4v4h-4z"></path><path d="M17 17h4v4h-4z"></path><path d="M7 17l5 -4l5 4"></path><line x1="12" y1="7" x2="12" y2="13"></line>',6),_0=[m0];function y0(t,e){return W(),Q("svg",v0,_0)}const b0=ke(g0,[["render",y0]]),w0=xe({props:{command:{type:String,required:!0},title:{type:String,required:!0},icon:{type:Object,required:!1,default:void 0}},setup(){const{viewModel:t}=Ft();return{viewModel:t}}}),C0=["disabled","title"];function S0(t,e,n,i,r,s){return W(),Q("button",{class:"baklava-toolbar-entry baklava-toolbar-button",disabled:!t.viewModel.commandHandler.canExecuteCommand(t.command),title:t.title,onClick:e[0]||(e[0]=o=>t.viewModel.commandHandler.executeCommand(t.command))},[t.icon?(W(),Fe(ds(t.icon),{key:0})):(W(),Q(ge,{key:1},[ps(Ke(t.title),1)],64))],8,C0)}const x0=ke(w0,[["render",S0]]),E0=xe({components:{ToolbarButton:x0},setup(){const{viewModel:t}=Ft();return{isSubgraph:he(()=>t.value.displayedGraph!==t.value.editor.graph),commands:[{command:ho,title:"Copy",icon:s0},{command:co,title:"Paste",icon:Jm},{command:ao,title:"Undo",icon:km},{command:lo,title:"Redo",icon:Nm},{command:Gc,title:"Create Subgraph",icon:b0}],subgraphCommands:[{command:nr,title:"Save Subgraph",icon:p0},{command:Fc,title:"Back to Main Graph",icon:jm}]}}}),T0={class:"baklava-toolbar"};function k0(t,e,n,i,r,s){const o=Ge("toolbar-button");return W(),Q("div",T0,[(W(!0),Q(ge,null,st(t.commands,a=>(W(),Fe(o,{key:a.command,command:a.command,title:a.title,icon:a.icon},null,8,["command","title","icon"]))),128)),t.isSubgraph?(W(!0),Q(ge,{key:0},st(t.subgraphCommands,a=>(W(),Fe(o,{key:a.command,command:a.command,title:a.title,icon:a.icon},null,8,["command","title","icon"]))),128)):ut("",!0)])}const P0=ke(E0,[["render",k0]]),M0=xe({components:{Background:Yp,Node:Kg,ConnectionWrapper:nv,TemporaryConnection:sv,Sidebar:cv,Minimap:fv,NodePalette:lm,Toolbar:P0},props:{viewModel:{type:Object,required:!0}},setup(t){const e=Symbol("EditorToken"),n=vn(t,"viewModel");Hp(n);const i=ne(null);ls("editorEl",i);const r=he(()=>t.viewModel.displayedGraph.nodes),s=he(()=>t.viewModel.displayedGraph.connections),o=he(()=>t.viewModel.displayedGraph.selectedNodes),a=jp(),l=Wp(),h=he(()=>({...a.styles.value})),c=ne(0);t.viewModel.editor.hooks.load.subscribe(e,g=>(c.value++,g));const u=g=>{a.onPointerMove(g),l.onMouseMove(g)},d=g=>{g.button===0&&(g.target===i.value&&(y(),a.onPointerDown(g)),l.onMouseDown())},p=g=>{a.onPointerUp(g),l.onMouseUp()},f=g=>{g.key==="Tab"&&g.preventDefault(),t.viewModel.commandHandler.handleKeyDown(g)},v=g=>{t.viewModel.commandHandler.handleKeyUp(g)},_=g=>{t.viewModel.commandHandler.pressedKeys.includes("Control")||y(),t.viewModel.displayedGraph.selectedNodes.push(g)},y=()=>{t.viewModel.displayedGraph.selectedNodes=[]};return{el:i,counter:c,nodes:r,connections:s,selectedNodes:o,nodeContainerStyle:h,onPointerMove:u,onPointerDown:d,onPointerUp:p,keyDown:f,keyUp:v,selectNode:_,temporaryConnection:l.temporaryConnection,mouseWheel:a.onMouseWheel,dragging:a.dragging}}}),O0={class:"connections-container"};function A0(t,e,n,i,r,s){const o=Ge("background"),a=Ge("toolbar"),l=Ge("node-palette"),h=Ge("connection-wrapper"),c=Ge("temporary-connection"),u=Ge("node"),d=Ge("sidebar"),p=Ge("minimap");return W(),Q("div",{ref:"el",tabindex:"-1",class:Ze(["baklava-editor",{"baklava-ignore-mouse":!!t.temporaryConnection||t.dragging,"--temporary-connection":!!t.temporaryConnection}]),onPointermove:e[0]||(e[0]=Lt((...f)=>t.onPointerMove&&t.onPointerMove(...f),["self"])),onPointerdown:e[1]||(e[1]=(...f)=>t.onPointerDown&&t.onPointerDown(...f)),onPointerup:e[2]||(e[2]=(...f)=>t.onPointerUp&&t.onPointerUp(...f)),onWheel:e[3]||(e[3]=Lt((...f)=>t.mouseWheel&&t.mouseWheel(...f),["self"])),onKeydown:e[4]||(e[4]=(...f)=>t.keyDown&&t.keyDown(...f)),onKeyup:e[5]||(e[5]=(...f)=>t.keyUp&&t.keyUp(...f))},[Bt(t.$slots,"background",{},()=>[le(o)]),Bt(t.$slots,"toolbar",{},()=>[le(a)]),Bt(t.$slots,"palette",{},()=>[le(l)]),(W(),Q("svg",O0,[(W(!0),Q(ge,null,st(t.connections,f=>(W(),Q("g",{key:f.id+t.counter.toString()},[Bt(t.$slots,"connection",{connection:f},()=>[le(h,{connection:f},null,8,["connection"])])]))),128)),Bt(t.$slots,"temporaryConnection",{temporaryConnection:t.temporaryConnection},()=>[t.temporaryConnection?(W(),Fe(c,{key:0,connection:t.temporaryConnection},null,8,["connection"])):ut("",!0)])])),q("div",{class:"node-container",style:kt(t.nodeContainerStyle)},[le(dc,{name:"fade"},{default:Yt(()=>[(W(!0),Q(ge,null,st(t.nodes,f=>Bt(t.$slots,"node",{node:f,selected:t.selectedNodes.includes(f),onSelect:v=>t.selectNode(f)},()=>[(W(),Fe(u,{key:f.id+t.counter.toString(),node:f,selected:t.selectedNodes.includes(f),onSelect:v=>t.selectNode(f)},null,8,["node","selected","onSelect"]))])),256))]),_:3})],4),Bt(t.$slots,"sidebar",{},()=>[le(d)]),Bt(t.$slots,"minimap",{},()=>[t.viewModel.settings.enableMinimap?(W(),Fe(p,{key:0})):ut("",!0)])],34)}const I0=ke(M0,[["render",A0]]);function R0(t){const e=ne([]),n=ne([]);return{pressedKeys:e,handleKeyDown:o=>{e.value.includes(o.key)||e.value.push(o.key),n.value.forEach(a=>{a.keys.every(l=>e.value.includes(l))&&t(a.commandName)})},handleKeyUp:o=>{const a=e.value.indexOf(o.key);a>=0&&e.value.splice(a,1)},registerHotkey:(o,a)=>{n.value.push({keys:o,commandName:a})}}}const N0=()=>{const t=ne(new Map),e=(s,o)=>{if(t.value.has(s))throw new Error(`Command "${s}" already exists`);t.value.set(s,o)},n=(s,o=!1,...a)=>{if(!t.value.has(s)){if(o)throw new Error(`[CommandHandler] Command ${s} not registered`);return}return t.value.get(s).execute(...a)},i=(s,o=!1,...a)=>{if(!t.value.has(s)){if(o)throw new Error(`[CommandHandler] Command ${s} not registered`);return!1}return t.value.get(s).canExecute(a)},r=R0(n);return _t({registerCommand:e,executeCommand:n,canExecuteCommand:i,...r})},D0=t=>!(t instanceof cr);function L0(t,e){return{switchGraph:i=>{let r;if(D0(i))r=new cr(t.value),i.createGraph(r),r.inputs.forEach(s=>{const o=new Nc;o.inputs.name.value=s.name,o.graphInterfaceId=s.id,r.addNode(o);const a=r.findNodeInterface(s.nodeInterfaceId);if(!a){console.warn(`Could not find target interface ${s.nodeInterfaceId} for subgraph input node`);return}r.addConnection(o.outputs.placeholder,a)}),r.outputs.forEach(s=>{const o=new Dc;o.inputs.name.value=s.name,o.graphInterfaceId=s.id,r.addNode(o);const a=r.findNodeInterface(s.nodeInterfaceId);if(!a){console.warn(`Could not find target interface ${s.nodeInterfaceId} for subgraph input node`);return}r.addConnection(a,o.inputs.placeholder)});else{if(i!==t.value.graph)throw new Error("Can only switch using 'Graph' instance when it is the root graph. Otherwise a 'GraphTemplate' must be used.");r=i}e.value&&e.value!==t.value.graph&&e.value.destroy(),r.panning=r.panning??i.panning??{x:0,y:0},r.scaling=r.scaling??i.scaling??1,r.selectedNodes=r.selectedNodes??[],r.sidebar=r.sidebar??{visible:!1,nodeId:"",optionName:""},e.value=r}}}function G0(t){t.position=t.position??{x:0,y:0},t.disablePointerEvents=!1,t.twoColumn=t.twoColumn??!1,t.width=t.width??200}function F0(t){const e=ne(t??new Dp),n=Symbol("ViewModelToken"),i=ne(null),r=sh(i),{switchGraph:s}=L0(e,i),o=he(()=>r.value&&r.value!==e.value.graph),a=_t({useStraightConnections:!1,enableMinimap:!1,background:{gridSize:100,gridDivision:5,subGridVisibleThreshold:.6}}),l=N0(),h=gm(r,l),c=mm(r,e,l),u={renderNode:new ft(null),renderInterface:new ft(null)};return fm(r,l,s),bm(r,l),Et(e,(d,p)=>{p&&(p.events.registerGraph.unsubscribe(n),p.graphEvents.beforeAddNode.unsubscribe(n),d.nodeHooks.beforeLoad.unsubscribe(n),d.nodeHooks.afterSave.unsubscribe(n),d.graphTemplateHooks.beforeLoad.unsubscribe(n),d.graphTemplateHooks.afterSave.unsubscribe(n)),d&&(d.nodeHooks.beforeLoad.subscribe(n,(f,v)=>(v.position=f.position??{x:0,y:0},v.width=f.width??200,v.twoColumn=f.twoColumn??!1,f)),d.nodeHooks.afterSave.subscribe(n,(f,v)=>(f.position=v.position,f.width=v.width,f.twoColumn=v.twoColumn,f)),d.graphTemplateHooks.beforeLoad.subscribe(n,(f,v)=>(v.panning=f.panning,v.scaling=f.scaling,f)),d.graphTemplateHooks.afterSave.subscribe(n,(f,v)=>(f.panning=v.panning,f.scaling=v.scaling,f)),d.graphEvents.beforeAddNode.subscribe(n,f=>G0(f)),e.value.registerNodeType(Nc,{category:"Subgraphs"}),e.value.registerNodeType(Dc,{category:"Subgraphs"}),s(d.graph))},{immediate:!0}),_t({editor:e,displayedGraph:r,isSubgraph:o,settings:a,commandHandler:l,history:h,clipboard:c,hooks:u,switchGraph:s})}const fl=_s({type:"DisplayNode",title:"Display",inputs:{value:()=>new Tt("Value","")},outputs:{display:()=>new Zv("Display","")},calculate({value:t}){return{display:typeof t=="number"?t.toFixed(3):String(t)}}}),pl=_s({type:"MathNode",title:"Math",inputs:{operation:()=>new Kv("Operation","Add",["Add","Subtract"]).setPort(!1),num1:()=>new ll("Num 1",1),num2:()=>new ll("Num 2",1)},outputs:{result:()=>new Tt("Result")},calculate({num1:t,num2:e,operation:n}){return n==="Add"?{result:t+e}:{result:t-e}}}),$0={class:"w-full h-scrren"},B0=xe({__name:"BaklavaJs",props:{nodes:{type:Number,default:10}},emits:["done"],setup(t,{emit:e}){const n=t,i=F0(),r=new Bp(i.editor);i.editor.registerNodeType(pl),i.editor.registerNodeType(fl);const s=Symbol();r.events.afterRun.subscribe(s,h=>{r.pause(),Lp(h,i.editor),r.resume()}),r.start();function o(h,c,u){const d=new h;return i.displayedGraph.addNode(d),d.position.x=c,d.position.y=u,d}const a=Date.now();console.log(" START",a);for(let h=0;h<n.nodes;h++){const c=300*(h+1),u=140*h,d=550*(h+1),p=140*h,f=o(pl,c,u),v=o(fl,d,p);i.displayedGraph.addConnection(f.outputs.result,v.inputs.value)}const l=Date.now()-a;return console.log(" END (between)",l),e("done",l),(h,c)=>(W(),Q("section",$0,[le(Nt(I0),{"view-model":Nt(i)},null,8,["view-model"])]))}}),H0=(t,e)=>{const n=t.__vccOpts||t;for(const[i,r]of e)n[i]=r;return n},gl=window.innerWidth,vl=window.innerHeight,U0={props:{nodes:{type:Number,default:10}},data(){return{list:[],dragItemId:null,configKonva:{width:gl,height:vl}}},mounted(){const t=Date.now();console.log(" START",t);for(let n=0;n<this.nodes;n++)this.list.push({id:Math.round(Math.random()*1e4).toString(),x:Math.random()*gl,y:Math.random()*vl,rotation:Math.random()*180,scale:Math.random()});const e=Date.now()-t;console.log(" END (between)",e),this.$emit("done",e)},methods:{handleDragstart(t){this.dragItemId=t.target.id();const e=this.list.find(i=>i.id===this.dragItemId),n=this.list.indexOf(e);this.list.splice(n,1),this.list.push(e)},handleDragend(t){this.dragItemId=null}}};function j0(t,e,n,i,r,s){const o=Ge("v-star"),a=Ge("v-layer"),l=Ge("v-stage");return W(),Q("div",null,[le(l,{ref:"stage",config:r.configKonva,onDragstart:s.handleDragstart,onDragend:s.handleDragend},{default:Yt(()=>[le(a,{ref:"layer"},{default:Yt(()=>[(W(!0),Q(ge,null,st(r.list,h=>(W(),Fe(o,{key:h.id,config:{x:h.x,y:h.y,rotation:h.rotation,id:h.id,numPoints:5,innerRadius:30,outerRadius:50,fill:"#89b717",opacity:.8,draggable:!0,scaleX:r.dragItemId===h.id?h.scale*1.2:h.scale,scaleY:r.dragItemId===h.id?h.scale*1.2:h.scale,shadowColor:"black",shadowBlur:10,shadowOffsetX:r.dragItemId===h.id?15:5,shadowOffsetY:r.dragItemId===h.id?15:5,shadowOpacity:.6}},null,8,["config"]))),128))]),_:1},512)]),_:1},8,["config","onDragstart","onDragend"])])}const W0=H0(U0,[["render",j0]]),z0={class:"w-full min-h-screen flex"},V0={class:"fixed top-[20px] left-[20px] z-9 flex gap-[8px] bg-[#121212] p-[8px] rounded"},Y0=q("option",{value:null,disabled:""}," NULL ",-1),X0=q("option",{value:"BaklavaJs"}," BaklavaJs ",-1),K0=q("option",{value:"KonvaJs"}," KonvaJs ",-1),q0=[Y0,X0,K0],J0={key:0,class:"absolute top-[calc(100%+20px)] left-0 bg-[#121212] p-[8px] rounded text-[10px]"},Q0={class:"flex flex-col gap-[8px]"},Z0=Vo('<section class="fixed max-w-[400px] top-[20px] right-[20px] z-9 flex flex-col gap-[8px] bg-[#121212] p-[8px] rounded text-[14px]"><p class="inline-flex gap-[4px]"><a href="https://github.com/newcat/baklavajs" target="_blank">https://github.com/newcat/baklavajs</a> - MIT </p><p class="inline-flex gap-[4px]"><a href="https://github.com/konvajs/konva" target="_blank">https://github.com/konvajs/konva</a> - MIT </p></section>',1),e_=xe({__name:"App",setup(t){const e=ne(null),n=ne(10),i=ne(!1),r=ne([]);return(s,o)=>(W(),Q("div",z0,[q("section",V0,[un(q("input",{"onUpdate:modelValue":o[0]||(o[0]=a=>n.value=a),type:"number"},null,512),[[gn,n.value]]),un(q("select",{"onUpdate:modelValue":o[1]||(o[1]=a=>e.value=a)},q0,512),[[qo,e.value]]),q("span",null," isRender: "+Ke(i.value),1),q("button",{onClick:o[2]||(o[2]=a=>i.value=!0)}," set true "),q("button",{onClick:o[3]||(o[3]=a=>i.value=!1)}," set false "),r.value.length?(W(),Q("div",J0,[q("ul",Q0,[(W(!0),Q(ge,null,st(r.value,(a,l)=>(W(),Q("li",{key:l,class:"inline-flex"},Ke(a),1))),128))])])):ut("",!0)]),Z0,i.value&&e.value==="BaklavaJs"?(W(),Fe(B0,{key:0,nodes:n.value,onDone:o[4]||(o[4]=a=>r.value.push(`BaklavaJs [${n.value} nodes] - ${a}ms`))},null,8,["nodes"])):ut("",!0),i.value&&e.value==="KonvaJs"?(W(),Fe(W0,{key:1,nodes:n.value,onDone:o[5]||(o[5]=a=>r.value.push(`KonvaJs [${n.value} nodes] - ${a}ms`))},null,8,["nodes"])):ut("",!0)]))}});var t_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function n_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Hc(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function i(){if(this instanceof i){var r=[null];r.push.apply(r,arguments);var s=Function.bind.apply(e,r);return new s}return e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var r=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(n,i,r.get?r:{enumerable:!0,get:function(){return t[i]}})}),n}var uo={},i_={get exports(){return uo},set exports(t){uo=t}};const r_=Hc(kp);var s_=Math.PI/180;function o_(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}const ri=typeof global<"u"?global:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},J={_global:ri,version:"8.4.3",isBrowser:o_(),isUnminified:/param/.test(function(t){}.toString()),dblClickWindow:400,getAngle(t){return J.angleDeg?t*s_:t},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return J.DD.isDragging},isDragReady(){return!!J.DD.node},releaseCanvasOnDestroy:!0,document:ri.document,_injectGlobal(t){ri.Konva=t}},Ae=t=>{J[t.prototype.getClassName()]=t};J._injectGlobal(J);class ht{constructor(e=[1,0,0,1,0,0]){this.dirty=!1,this.m=e&&e.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new ht(this.m)}copyInto(e){e.m[0]=this.m[0],e.m[1]=this.m[1],e.m[2]=this.m[2],e.m[3]=this.m[3],e.m[4]=this.m[4],e.m[5]=this.m[5]}point(e){var n=this.m;return{x:n[0]*e.x+n[2]*e.y+n[4],y:n[1]*e.x+n[3]*e.y+n[5]}}translate(e,n){return this.m[4]+=this.m[0]*e+this.m[2]*n,this.m[5]+=this.m[1]*e+this.m[3]*n,this}scale(e,n){return this.m[0]*=e,this.m[1]*=e,this.m[2]*=n,this.m[3]*=n,this}rotate(e){var n=Math.cos(e),i=Math.sin(e),r=this.m[0]*n+this.m[2]*i,s=this.m[1]*n+this.m[3]*i,o=this.m[0]*-i+this.m[2]*n,a=this.m[1]*-i+this.m[3]*n;return this.m[0]=r,this.m[1]=s,this.m[2]=o,this.m[3]=a,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(e,n){var i=this.m[0]+this.m[2]*n,r=this.m[1]+this.m[3]*n,s=this.m[2]+this.m[0]*e,o=this.m[3]+this.m[1]*e;return this.m[0]=i,this.m[1]=r,this.m[2]=s,this.m[3]=o,this}multiply(e){var n=this.m[0]*e.m[0]+this.m[2]*e.m[1],i=this.m[1]*e.m[0]+this.m[3]*e.m[1],r=this.m[0]*e.m[2]+this.m[2]*e.m[3],s=this.m[1]*e.m[2]+this.m[3]*e.m[3],o=this.m[0]*e.m[4]+this.m[2]*e.m[5]+this.m[4],a=this.m[1]*e.m[4]+this.m[3]*e.m[5]+this.m[5];return this.m[0]=n,this.m[1]=i,this.m[2]=r,this.m[3]=s,this.m[4]=o,this.m[5]=a,this}invert(){var e=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),n=this.m[3]*e,i=-this.m[1]*e,r=-this.m[2]*e,s=this.m[0]*e,o=e*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),a=e*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=n,this.m[1]=i,this.m[2]=r,this.m[3]=s,this.m[4]=o,this.m[5]=a,this}getMatrix(){return this.m}decompose(){var e=this.m[0],n=this.m[1],i=this.m[2],r=this.m[3],s=this.m[4],o=this.m[5],a=e*r-n*i;let l={x:s,y:o,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(e!=0||n!=0){var h=Math.sqrt(e*e+n*n);l.rotation=n>0?Math.acos(e/h):-Math.acos(e/h),l.scaleX=h,l.scaleY=a/h,l.skewX=(e*i+n*r)/a,l.skewY=0}else if(i!=0||r!=0){var c=Math.sqrt(i*i+r*r);l.rotation=Math.PI/2-(r>0?Math.acos(-i/c):-Math.acos(i/c)),l.scaleX=a/c,l.scaleY=c,l.skewX=0,l.skewY=(e*i+n*r)/a}return l.rotation=T._getRotation(l.rotation),l}}var a_="[object Array]",l_="[object Number]",h_="[object String]",c_="[object Boolean]",u_=Math.PI/180,d_=180/Math.PI,As="#",f_="",p_="0",g_="Konva warning: ",ml="Konva error: ",v_="rgb(",Is={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},m_=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,Er=[];const __=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(t){setTimeout(t,60)},T={_isElement(t){return!!(t&&t.nodeType==1)},_isFunction(t){return!!(t&&t.constructor&&t.call&&t.apply)},_isPlainObject(t){return!!t&&t.constructor===Object},_isArray(t){return Object.prototype.toString.call(t)===a_},_isNumber(t){return Object.prototype.toString.call(t)===l_&&!isNaN(t)&&isFinite(t)},_isString(t){return Object.prototype.toString.call(t)===h_},_isBoolean(t){return Object.prototype.toString.call(t)===c_},isObject(t){return t instanceof Object},isValidSelector(t){if(typeof t!="string")return!1;var e=t[0];return e==="#"||e==="."||e===e.toUpperCase()},_sign(t){return t===0||t>0?1:-1},requestAnimFrame(t){Er.push(t),Er.length===1&&__(function(){const e=Er;Er=[],e.forEach(function(n){n()})})},createCanvasElement(){var t=document.createElement("canvas");try{t.style=t.style||{}}catch{}return t},createImageElement(){return document.createElement("img")},_isInDocument(t){for(;t=t.parentNode;)if(t==document)return!0;return!1},_urlToImage(t,e){var n=T.createImageElement();n.onload=function(){e(n)},n.src=t},_rgbToHex(t,e,n){return((1<<24)+(t<<16)+(e<<8)+n).toString(16).slice(1)},_hexToRgb(t){t=t.replace(As,f_);var e=parseInt(t,16);return{r:e>>16&255,g:e>>8&255,b:e&255}},getRandomColor(){for(var t=(Math.random()*16777215<<0).toString(16);t.length<6;)t=p_+t;return As+t},getRGB(t){var e;return t in Is?(e=Is[t],{r:e[0],g:e[1],b:e[2]}):t[0]===As?this._hexToRgb(t.substring(1)):t.substr(0,4)===v_?(e=m_.exec(t.replace(/ /g,"")),{r:parseInt(e[1],10),g:parseInt(e[2],10),b:parseInt(e[3],10)}):{r:0,g:0,b:0}},colorToRGBA(t){return t=t||"black",T._namedColorToRBA(t)||T._hex3ColorToRGBA(t)||T._hex4ColorToRGBA(t)||T._hex6ColorToRGBA(t)||T._hex8ColorToRGBA(t)||T._rgbColorToRGBA(t)||T._rgbaColorToRGBA(t)||T._hslColorToRGBA(t)},_namedColorToRBA(t){var e=Is[t.toLowerCase()];return e?{r:e[0],g:e[1],b:e[2],a:1}:null},_rgbColorToRGBA(t){if(t.indexOf("rgb(")===0){t=t.match(/rgb\(([^)]+)\)/)[1];var e=t.split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:1}}},_rgbaColorToRGBA(t){if(t.indexOf("rgba(")===0){t=t.match(/rgba\(([^)]+)\)/)[1];var e=t.split(/ *, */).map((n,i)=>n.slice(-1)==="%"?i===3?parseInt(n)/100:parseInt(n)/100*255:Number(n));return{r:e[0],g:e[1],b:e[2],a:e[3]}}},_hex8ColorToRGBA(t){if(t[0]==="#"&&t.length===9)return{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:parseInt(t.slice(7,9),16)/255}},_hex6ColorToRGBA(t){if(t[0]==="#"&&t.length===7)return{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:1}},_hex4ColorToRGBA(t){if(t[0]==="#"&&t.length===5)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:parseInt(t[4]+t[4],16)/255}},_hex3ColorToRGBA(t){if(t[0]==="#"&&t.length===4)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:1}},_hslColorToRGBA(t){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(t)){const[e,...n]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(t),i=Number(n[0])/360,r=Number(n[1])/100,s=Number(n[2])/100;let o,a,l;if(r===0)return l=s*255,{r:Math.round(l),g:Math.round(l),b:Math.round(l),a:1};s<.5?o=s*(1+r):o=s+r-s*r;const h=2*s-o,c=[0,0,0];for(let u=0;u<3;u++)a=i+1/3*-(u-1),a<0&&a++,a>1&&a--,6*a<1?l=h+(o-h)*6*a:2*a<1?l=o:3*a<2?l=h+(o-h)*(2/3-a)*6:l=h,c[u]=l*255;return{r:Math.round(c[0]),g:Math.round(c[1]),b:Math.round(c[2]),a:1}}},haveIntersection(t,e){return!(e.x>t.x+t.width||e.x+e.width<t.x||e.y>t.y+t.height||e.y+e.height<t.y)},cloneObject(t){var e={};for(var n in t)this._isPlainObject(t[n])?e[n]=this.cloneObject(t[n]):this._isArray(t[n])?e[n]=this.cloneArray(t[n]):e[n]=t[n];return e},cloneArray(t){return t.slice(0)},degToRad(t){return t*u_},radToDeg(t){return t*d_},_degToRad(t){return T.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),T.degToRad(t)},_radToDeg(t){return T.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),T.radToDeg(t)},_getRotation(t){return J.angleDeg?T.radToDeg(t):t},_capitalize(t){return t.charAt(0).toUpperCase()+t.slice(1)},throw(t){throw new Error(ml+t)},error(t){console.error(ml+t)},warn(t){J.showWarnings&&console.warn(g_+t)},each(t,e){for(var n in t)e(n,t[n])},_inRange(t,e,n){return e<=t&&t<n},_getProjectionToSegment(t,e,n,i,r,s){var o,a,l,h=(t-n)*(t-n)+(e-i)*(e-i);if(h==0)o=t,a=e,l=(r-n)*(r-n)+(s-i)*(s-i);else{var c=((r-t)*(n-t)+(s-e)*(i-e))/h;c<0?(o=t,a=e,l=(t-r)*(t-r)+(e-s)*(e-s)):c>1?(o=n,a=i,l=(n-r)*(n-r)+(i-s)*(i-s)):(o=t+c*(n-t),a=e+c*(i-e),l=(o-r)*(o-r)+(a-s)*(a-s))}return[o,a,l]},_getProjectionToLine(t,e,n){var i=T.cloneObject(t),r=Number.MAX_VALUE;return e.forEach(function(s,o){if(!(!n&&o===e.length-1)){var a=e[(o+1)%e.length],l=T._getProjectionToSegment(s.x,s.y,a.x,a.y,t.x,t.y),h=l[0],c=l[1],u=l[2];u<r&&(i.x=h,i.y=c,r=u)}}),i},_prepareArrayForTween(t,e,n){var i,r=[],s=[];if(t.length>e.length){var o=e;e=t,t=o}for(i=0;i<t.length;i+=2)r.push({x:t[i],y:t[i+1]});for(i=0;i<e.length;i+=2)s.push({x:e[i],y:e[i+1]});var a=[];return s.forEach(function(l){var h=T._getProjectionToLine(l,r,n);a.push(h.x),a.push(h.y)}),a},_prepareToStringify(t){var e;t.visitedByCircularReferenceRemoval=!0;for(var n in t)if(t.hasOwnProperty(n)&&t[n]&&typeof t[n]=="object"){if(e=Object.getOwnPropertyDescriptor(t,n),t[n].visitedByCircularReferenceRemoval||T._isElement(t[n]))if(e.configurable)delete t[n];else return null;else if(T._prepareToStringify(t[n])===null)if(e.configurable)delete t[n];else return null}return delete t.visitedByCircularReferenceRemoval,t},_assign(t,e){for(var n in e)t[n]=e[n];return t},_getFirstPointerId(t){return t.touches?t.changedTouches[0].identifier:t.pointerId||999},releaseCanvas(...t){J.releaseCanvasOnDestroy&&t.forEach(e=>{e.width=0,e.height=0})},drawRoundedRectPath(t,e,n,i){let r=0,s=0,o=0,a=0;typeof i=="number"?r=s=o=a=Math.min(i,e/2,n/2):(r=Math.min(i[0]||0,e/2,n/2),s=Math.min(i[1]||0,e/2,n/2),a=Math.min(i[2]||0,e/2,n/2),o=Math.min(i[3]||0,e/2,n/2)),t.moveTo(r,0),t.lineTo(e-s,0),t.arc(e-s,s,s,Math.PI*3/2,0,!1),t.lineTo(e,n-a),t.arc(e-a,n-a,a,0,Math.PI/2,!1),t.lineTo(o,n),t.arc(o,n-o,o,Math.PI/2,Math.PI,!1),t.lineTo(0,r),t.arc(r,r,r,Math.PI,Math.PI*3/2,!1)}};function _n(t){return T._isString(t)?'"'+t+'"':Object.prototype.toString.call(t)==="[object Number]"||T._isBoolean(t)?t:Object.prototype.toString.call(t)}function Uc(t){return t>255?255:t<0?0:Math.round(t)}function U(){if(J.isUnminified)return function(t,e){return T._isNumber(t)||T.warn(_n(t)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),t}}function ta(t){if(J.isUnminified)return function(e,n){let i=T._isNumber(e),r=T._isArray(e)&&e.length==t;return!i&&!r&&T.warn(_n(e)+' is a not valid value for "'+n+'" attribute. The value should be a number or Array<number>('+t+")"),e}}function na(){if(J.isUnminified)return function(t,e){var n=T._isNumber(t),i=t==="auto";return n||i||T.warn(_n(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),t}}function yi(){if(J.isUnminified)return function(t,e){return T._isString(t)||T.warn(_n(t)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),t}}function jc(){if(J.isUnminified)return function(t,e){const n=T._isString(t),i=Object.prototype.toString.call(t)==="[object CanvasGradient]"||t&&t.addColorStop;return n||i||T.warn(_n(t)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),t}}function y_(){if(J.isUnminified)return function(t,e){const n=Int8Array?Object.getPrototypeOf(Int8Array):null;return n&&t instanceof n||(T._isArray(t)?t.forEach(function(i){T._isNumber(i)||T.warn('"'+e+'" attribute has non numeric element '+i+". Make sure that all elements are numbers.")}):T.warn(_n(t)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),t}}function Mt(){if(J.isUnminified)return function(t,e){var n=t===!0||t===!1;return n||T.warn(_n(t)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),t}}function b_(t){if(J.isUnminified)return function(e,n){return e==null||T.isObject(e)||T.warn(_n(e)+' is a not valid value for "'+n+'" attribute. The value should be an object with properties '+t),e}}var Ei="get",Ti="set";const b={addGetterSetter(t,e,n,i,r){b.addGetter(t,e,n),b.addSetter(t,e,i,r),b.addOverloadedGetterSetter(t,e)},addGetter(t,e,n){var i=Ei+T._capitalize(e);t.prototype[i]=t.prototype[i]||function(){var r=this.attrs[e];return r===void 0?n:r}},addSetter(t,e,n,i){var r=Ti+T._capitalize(e);t.prototype[r]||b.overWriteSetter(t,e,n,i)},overWriteSetter(t,e,n,i){var r=Ti+T._capitalize(e);t.prototype[r]=function(s){return n&&s!==void 0&&s!==null&&(s=n.call(this,s,e)),this._setAttr(e,s),i&&i.call(this),this}},addComponentsGetterSetter(t,e,n,i,r){var s=n.length,o=T._capitalize,a=Ei+o(e),l=Ti+o(e),h,c;t.prototype[a]=function(){var d={};for(h=0;h<s;h++)c=n[h],d[c]=this.getAttr(e+o(c));return d};var u=b_(n);t.prototype[l]=function(d){var p=this.attrs[e],f;i&&(d=i.call(this,d)),u&&u.call(this,d,e);for(f in d)d.hasOwnProperty(f)&&this._setAttr(e+o(f),d[f]);return d||n.forEach(v=>{this._setAttr(e+o(v),void 0)}),this._fireChangeEvent(e,p,d),r&&r.call(this),this},b.addOverloadedGetterSetter(t,e)},addOverloadedGetterSetter(t,e){var n=T._capitalize(e),i=Ti+n,r=Ei+n;t.prototype[e]=function(){return arguments.length?(this[i](arguments[0]),this):this[r]()}},addDeprecatedGetterSetter(t,e,n,i){T.error("Adding deprecated "+e);var r=Ei+T._capitalize(e),s=e+" property is deprecated and will be removed soon. Look at Konva change log for more information.";t.prototype[r]=function(){T.error(s);var o=this.attrs[e];return o===void 0?n:o},b.addSetter(t,e,i,function(){T.error(s)}),b.addOverloadedGetterSetter(t,e)},backCompat(t,e){T.each(e,function(n,i){var r=t.prototype[i],s=Ei+T._capitalize(n),o=Ti+T._capitalize(n);function a(){r.apply(this,arguments),T.error('"'+n+'" method is deprecated and will be removed soon. Use ""'+i+'" instead.')}t.prototype[n]=a,t.prototype[s]=a,t.prototype[o]=a})},afterSetFilter(){this._filterUpToDate=!1}};function w_(t){var e=[],n=t.length,i=T,r,s;for(r=0;r<n;r++)s=t[r],i._isNumber(s)?s=Math.round(s*1e3)/1e3:i._isString(s)||(s=s+""),e.push(s);return e}var _l=",",C_="(",S_=")",x_="([",E_="])",T_=";",k_="()",P_="=",yl=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],M_=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"];const O_=100;class bs{constructor(e){this.canvas=e,J.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,n){var i=this.traceArr,r=i.length,s="",o,a,l,h;for(o=0;o<r;o++)a=i[o],l=a.method,l?(h=a.args,s+=l,e?s+=k_:T._isArray(h[0])?s+=x_+h.join(_l)+E_:(n&&(h=h.map(c=>typeof c=="number"?Math.floor(c):c)),s+=C_+h.join(_l)+S_)):(s+=a.property,e||(s+=P_+a.val)),s+=T_;return s}clearTrace(){this.traceArr=[]}_trace(e){var n=this.traceArr,i;n.push(e),i=n.length,i>=O_&&n.shift()}reset(){var e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){var n=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,n.getWidth()/n.pixelRatio,n.getHeight()/n.pixelRatio)}_applyLineCap(e){const n=e.attrs.lineCap;n&&this.setAttr("lineCap",n)}_applyOpacity(e){var n=e.getAbsoluteOpacity();n!==1&&this.setAttr("globalAlpha",n)}_applyLineJoin(e){const n=e.attrs.lineJoin;n&&this.setAttr("lineJoin",n)}setAttr(e,n){this._context[e]=n}arc(e,n,i,r,s,o){this._context.arc(e,n,i,r,s,o)}arcTo(e,n,i,r,s){this._context.arcTo(e,n,i,r,s)}beginPath(){this._context.beginPath()}bezierCurveTo(e,n,i,r,s,o){this._context.bezierCurveTo(e,n,i,r,s,o)}clearRect(e,n,i,r){this._context.clearRect(e,n,i,r)}clip(){this._context.clip()}closePath(){this._context.closePath()}createImageData(e,n){var i=arguments;if(i.length===2)return this._context.createImageData(e,n);if(i.length===1)return this._context.createImageData(e)}createLinearGradient(e,n,i,r){return this._context.createLinearGradient(e,n,i,r)}createPattern(e,n){return this._context.createPattern(e,n)}createRadialGradient(e,n,i,r,s,o){return this._context.createRadialGradient(e,n,i,r,s,o)}drawImage(e,n,i,r,s,o,a,l,h){var c=arguments,u=this._context;c.length===3?u.drawImage(e,n,i):c.length===5?u.drawImage(e,n,i,r,s):c.length===9&&u.drawImage(e,n,i,r,s,o,a,l,h)}ellipse(e,n,i,r,s,o,a,l){this._context.ellipse(e,n,i,r,s,o,a,l)}isPointInPath(e,n,i,r){return i?this._context.isPointInPath(i,e,n,r):this._context.isPointInPath(e,n,r)}fill(e){e?this._context.fill(e):this._context.fill()}fillRect(e,n,i,r){this._context.fillRect(e,n,i,r)}strokeRect(e,n,i,r){this._context.strokeRect(e,n,i,r)}fillText(e,n,i,r){r?this._context.fillText(e,n,i,r):this._context.fillText(e,n,i)}measureText(e){return this._context.measureText(e)}getImageData(e,n,i,r){return this._context.getImageData(e,n,i,r)}lineTo(e,n){this._context.lineTo(e,n)}moveTo(e,n){this._context.moveTo(e,n)}rect(e,n,i,r){this._context.rect(e,n,i,r)}putImageData(e,n,i){this._context.putImageData(e,n,i)}quadraticCurveTo(e,n,i,r){this._context.quadraticCurveTo(e,n,i,r)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,n){this._context.scale(e,n)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,n,i,r,s,o){this._context.setTransform(e,n,i,r,s,o)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,n,i,r){this._context.strokeText(e,n,i,r)}transform(e,n,i,r,s,o){this._context.transform(e,n,i,r,s,o)}translate(e,n){this._context.translate(e,n)}_enableTrace(){var e=this,n=yl.length,i=this.setAttr,r,s,o=function(a){var l=e[a],h;e[a]=function(){return s=w_(Array.prototype.slice.call(arguments,0)),h=l.apply(e,arguments),e._trace({method:a,args:s}),h}};for(r=0;r<n;r++)o(yl[r]);e.setAttr=function(){i.apply(e,arguments);var a=arguments[0],l=arguments[1];(a==="shadowOffsetX"||a==="shadowOffsetY"||a==="shadowBlur")&&(l=l/this.canvas.getPixelRatio()),e._trace({property:a,val:l})}}_applyGlobalCompositeOperation(e){const n=e.attrs.globalCompositeOperation;var i=!n||n==="source-over";i||this.setAttr("globalCompositeOperation",n)}}M_.forEach(function(t){Object.defineProperty(bs.prototype,t,{get(){return this._context[t]},set(e){this._context[t]=e}})});class A_ extends bs{constructor(e){super(e),this._context=e._canvas.getContext("2d")}_fillColor(e){var n=e.fill();this.setAttr("fillStyle",n),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){var n=e._getLinearGradient();n&&(this.setAttr("fillStyle",n),e._fillFunc(this))}_fillRadialGradient(e){const n=e._getRadialGradient();n&&(this.setAttr("fillStyle",n),e._fillFunc(this))}_fill(e){const n=e.fill(),i=e.getFillPriority();if(n&&i==="color"){this._fillColor(e);return}const r=e.getFillPatternImage();if(r&&i==="pattern"){this._fillPattern(e);return}const s=e.getFillLinearGradientColorStops();if(s&&i==="linear-gradient"){this._fillLinearGradient(e);return}const o=e.getFillRadialGradientColorStops();if(o&&i==="radial-gradient"){this._fillRadialGradient(e);return}n?this._fillColor(e):r?this._fillPattern(e):s?this._fillLinearGradient(e):o&&this._fillRadialGradient(e)}_strokeLinearGradient(e){const n=e.getStrokeLinearGradientStartPoint(),i=e.getStrokeLinearGradientEndPoint(),r=e.getStrokeLinearGradientColorStops(),s=this.createLinearGradient(n.x,n.y,i.x,i.y);if(r){for(var o=0;o<r.length;o+=2)s.addColorStop(r[o],r[o+1]);this.setAttr("strokeStyle",s)}}_stroke(e){var n=e.dash(),i=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!i){this.save();var r=this.getCanvas().getPixelRatio();this.setTransform(r,0,0,r,0,0)}this._applyLineCap(e),n&&e.dashEnabled()&&(this.setLineDash(n),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)");var s=e.getStrokeLinearGradientColorStops();s?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),i||this.restore()}}_applyShadow(e){var n,i,r,s=(n=e.getShadowRGBA())!==null&&n!==void 0?n:"black",o=(i=e.getShadowBlur())!==null&&i!==void 0?i:5,a=(r=e.getShadowOffset())!==null&&r!==void 0?r:{x:0,y:0},l=e.getAbsoluteScale(),h=this.canvas.getPixelRatio(),c=l.x*h,u=l.y*h;this.setAttr("shadowColor",s),this.setAttr("shadowBlur",o*Math.min(Math.abs(c),Math.abs(u))),this.setAttr("shadowOffsetX",a.x*c),this.setAttr("shadowOffsetY",a.y*u)}}class I_ extends bs{constructor(e){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){const s=e.getStrokeScaleEnabled();if(!s){this.save();var n=this.getCanvas().getPixelRatio();this.setTransform(n,0,0,n,0,0)}this._applyLineCap(e);var i=e.hitStrokeWidth(),r=i==="auto"?e.strokeWidth():i;this.setAttr("lineWidth",r),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),s||this.restore()}}}var Tr;function R_(){if(Tr)return Tr;var t=T.createCanvasElement(),e=t.getContext("2d");return Tr=function(){var n=J._global.devicePixelRatio||1,i=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return n/i}(),T.releaseCanvas(t),Tr}class ws{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;var n=e||{},i=n.pixelRatio||J.pixelRatio||R_();this.pixelRatio=i,this._canvas=T.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){var n=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/n,this.getHeight()/n)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";var n=this.pixelRatio,i=this.getContext()._context;i.scale(n,n)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";var n=this.pixelRatio,i=this.getContext()._context;i.scale(n,n)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,n){this.setWidth(e||0),this.setHeight(n||0)}toDataURL(e,n){try{return this._canvas.toDataURL(e,n)}catch{try{return this._canvas.toDataURL()}catch(r){return T.error("Unable to get data URL. "+r.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}b.addGetterSetter(ws,"pixelRatio",void 0,U());class si extends ws{constructor(e={width:0,height:0}){super(e),this.context=new A_(this),this.setSize(e.width,e.height)}}class ia extends ws{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.context=new I_(this),this.setSize(e.width,e.height)}}const me={get isDragging(){var t=!1;return me._dragElements.forEach(e=>{e.dragStatus==="dragging"&&(t=!0)}),t},justDragged:!1,get node(){var t;return me._dragElements.forEach(e=>{t=e.node}),t},_dragElements:new Map,_drag(t){const e=[];me._dragElements.forEach((n,i)=>{const{node:r}=n,s=r.getStage();s.setPointersPositions(t),n.pointerId===void 0&&(n.pointerId=T._getFirstPointerId(t));const o=s._changedPointerPositions.find(h=>h.id===n.pointerId);if(o){if(n.dragStatus!=="dragging"){var a=r.dragDistance(),l=Math.max(Math.abs(o.x-n.startPointerPos.x),Math.abs(o.y-n.startPointerPos.y));if(l<a||(r.startDrag({evt:t}),!r.isDragging()))return}r._setDragPosition(t,n),e.push(r)}}),e.forEach(n=>{n.fire("dragmove",{type:"dragmove",target:n,evt:t},!0)})},_endDragBefore(t){const e=[];me._dragElements.forEach(n=>{const{node:i}=n,r=i.getStage();if(t&&r.setPointersPositions(t),!r._changedPointerPositions.find(a=>a.id===n.pointerId))return;(n.dragStatus==="dragging"||n.dragStatus==="stopped")&&(me.justDragged=!0,J._mouseListenClick=!1,J._touchListenClick=!1,J._pointerListenClick=!1,n.dragStatus="stopped");const o=n.node.getLayer()||n.node instanceof J.Stage&&n.node;o&&e.indexOf(o)===-1&&e.push(o)}),e.forEach(n=>{n.draw()})},_endDragAfter(t){me._dragElements.forEach((e,n)=>{e.dragStatus==="stopped"&&e.node.fire("dragend",{type:"dragend",target:e.node,evt:t},!0),e.dragStatus!=="dragging"&&me._dragElements.delete(n)})}};J.isBrowser&&(window.addEventListener("mouseup",me._endDragBefore,!0),window.addEventListener("touchend",me._endDragBefore,!0),window.addEventListener("mousemove",me._drag),window.addEventListener("touchmove",me._drag),window.addEventListener("mouseup",me._endDragAfter,!1),window.addEventListener("touchend",me._endDragAfter,!1));var Fr="absoluteOpacity",kr="allEventListeners",Ut="absoluteTransform",bl="absoluteScale",Sn="canvas",N_="Change",D_="children",L_="konva",fo="listening",wl="mouseenter",Cl="mouseleave",Sl="set",xl="Shape",$r=" ",El="stage",rn="transform",G_="Stage",po="visible",F_=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join($r);let $_=1;class H{constructor(e){this._id=$_++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){(e===rn||e===Ut)&&this._cache.get(e)?this._cache.get(e).dirty=!0:e?this._cache.delete(e):this._cache.clear()}_getCache(e,n){var i=this._cache.get(e),r=e===rn||e===Ut,s=i===void 0||r&&i.dirty===!0;return s&&(i=n.call(this),this._cache.set(e,i)),i}_calculate(e,n,i){if(!this._attachedDepsListeners.get(e)){const r=n.map(s=>s+"Change.konva").join($r);this.on(r,()=>{this._clearCache(e)}),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,i)}_getCanvasCache(){return this._cache.get(Sn)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===Ut&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(Sn)){const{scene:e,filter:n,hit:i}=this._cache.get(Sn);T.releaseCanvas(e,n,i),this._cache.delete(Sn)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){var n=e||{},i={};(n.x===void 0||n.y===void 0||n.width===void 0||n.height===void 0)&&(i=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()}));var r=Math.ceil(n.width||i.width),s=Math.ceil(n.height||i.height),o=n.pixelRatio,a=n.x===void 0?Math.floor(i.x):n.x,l=n.y===void 0?Math.floor(i.y):n.y,h=n.offset||0,c=n.drawBorder||!1,u=n.hitCanvasPixelRatio||1;if(!r||!s){T.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}r+=h*2+1,s+=h*2+1,a-=h,l-=h;var d=new si({pixelRatio:o,width:r,height:s}),p=new si({pixelRatio:o,width:0,height:0}),f=new ia({pixelRatio:u,width:r,height:s}),v=d.getContext(),_=f.getContext();return f.isCache=!0,d.isCache=!0,this._cache.delete(Sn),this._filterUpToDate=!1,n.imageSmoothingEnabled===!1&&(d.getContext()._context.imageSmoothingEnabled=!1,p.getContext()._context.imageSmoothingEnabled=!1),v.save(),_.save(),v.translate(-a,-l),_.translate(-a,-l),this._isUnderCache=!0,this._clearSelfAndDescendantCache(Fr),this._clearSelfAndDescendantCache(bl),this.drawScene(d,this),this.drawHit(f,this),this._isUnderCache=!1,v.restore(),_.restore(),c&&(v.save(),v.beginPath(),v.rect(0,0,r,s),v.closePath(),v.setAttr("strokeStyle","red"),v.setAttr("lineWidth",5),v.stroke(),v.restore()),this._cache.set(Sn,{scene:d,filter:p,hit:f,x:a,y:l}),this._requestDraw(),this}isCached(){return this._cache.has(Sn)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,n){var i=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],r,s,o,a,l=this.getAbsoluteTransform(n);return i.forEach(function(h){var c=l.point(h);r===void 0&&(r=o=c.x,s=a=c.y),r=Math.min(r,c.x),s=Math.min(s,c.y),o=Math.max(o,c.x),a=Math.max(a,c.y)}),{x:r,y:s,width:o-r,height:a-s}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);const n=this._getCanvasCache();e.translate(n.x,n.y);var i=this._getCachedSceneCanvas(),r=i.pixelRatio;e.drawImage(i._canvas,0,0,i.width/r,i.height/r),e.restore()}_drawCachedHitCanvas(e){var n=this._getCanvasCache(),i=n.hit;e.save(),e.translate(n.x,n.y),e.drawImage(i._canvas,0,0,i.width/i.pixelRatio,i.height/i.pixelRatio),e.restore()}_getCachedSceneCanvas(){var e=this.filters(),n=this._getCanvasCache(),i=n.scene,r=n.filter,s=r.getContext(),o,a,l,h;if(e){if(!this._filterUpToDate){var c=i.pixelRatio;r.setSize(i.width/i.pixelRatio,i.height/i.pixelRatio);try{for(o=e.length,s.clear(),s.drawImage(i._canvas,0,0,i.getWidth()/c,i.getHeight()/c),a=s.getImageData(0,0,r.getWidth(),r.getHeight()),l=0;l<o;l++){if(h=e[l],typeof h!="function"){T.error("Filter should be type of function, but got "+typeof h+" instead. Please check correct filters");continue}h.call(this,a),s.putImageData(a,0,0)}}catch(u){T.error("Unable to apply filter. "+u.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return r}return i}on(e,n){if(this._cache&&this._cache.delete(kr),arguments.length===3)return this._delegate.apply(this,arguments);var i=e.split($r),r=i.length,s,o,a,l,h;for(s=0;s<r;s++)o=i[s],a=o.split("."),l=a[0],h=a[1]||"",this.eventListeners[l]||(this.eventListeners[l]=[]),this.eventListeners[l].push({name:h,handler:n});return this}off(e,n){var i=(e||"").split($r),r=i.length,s,o,a,l,h,c;if(this._cache&&this._cache.delete(kr),!e)for(o in this.eventListeners)this._off(o);for(s=0;s<r;s++)if(a=i[s],l=a.split("."),h=l[0],c=l[1],h)this.eventListeners[h]&&this._off(h,c,n);else for(o in this.eventListeners)this._off(o,c,n);return this}dispatchEvent(e){var n={target:this,type:e.type,evt:e};return this.fire(e.type,n),this}addEventListener(e,n){return this.on(e,function(i){n.call(this,i.evt)}),this}removeEventListener(e){return this.off(e),this}_delegate(e,n,i){var r=this;this.on(e,function(s){for(var o=s.target.findAncestors(n,!0,r),a=0;a<o.length;a++)s=T.cloneObject(s),s.currentTarget=o[a],i.call(o[a],s)})}remove(){return this.isDragging()&&this.stopDrag(),me._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Ut),this._clearSelfAndDescendantCache(Fr),this._clearSelfAndDescendantCache(bl),this._clearSelfAndDescendantCache(El),this._clearSelfAndDescendantCache(po),this._clearSelfAndDescendantCache(fo)}_remove(){this._clearCaches();var e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){var n="get"+T._capitalize(e);return T._isFunction(this[n])?this[n]():this.attrs[e]}getAncestors(){for(var e=this.getParent(),n=[];e;)n.push(e),e=e.getParent();return n}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges(()=>{var n,i;if(!e)return this;for(n in e)n!==D_&&(i=Sl+T._capitalize(n),T._isFunction(this[i])?this[i](e[n]):this._setAttr(n,e[n]))}),this}isListening(){return this._getCache(fo,this._isListening)}_isListening(e){if(!this.listening())return!1;const i=this.getParent();return i&&i!==e&&this!==e?i._isListening(e):!0}isVisible(){return this._getCache(po,this._isVisible)}_isVisible(e){if(!this.visible())return!1;const i=this.getParent();return i&&i!==e&&this!==e?i._isVisible(e):!0}shouldDrawHit(e,n=!1){if(e)return this._isVisible(e)&&this._isListening(e);var i=this.getLayer(),r=!1;me._dragElements.forEach(o=>{o.dragStatus==="dragging"&&(o.node.nodeType==="Stage"||o.node.getLayer()===i)&&(r=!0)});var s=!n&&!J.hitOnDragEnabled&&r;return this.isListening()&&this.isVisible()&&!s}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){var e=this.getDepth(),n=this,i=0,r,s,o,a;function l(h){for(r=[],s=h.length,o=0;o<s;o++)a=h[o],i++,a.nodeType!==xl&&(r=r.concat(a.getChildren().slice())),a._id===n._id&&(o=s);r.length>0&&r[0].getDepth()<=e&&l(r)}return n.nodeType!==G_&&l(n.getStage().getChildren()),i}getDepth(){for(var e=0,n=this.parent;n;)e++,n=n.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(rn),this._clearSelfAndDescendantCache(Ut)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges(()=>{this.x(e.x),this.y(e.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){if(!this.getStage())return null;var e=this.getStage().getPointerPosition();if(!e)return null;var n=this.getAbsoluteTransform().copy();return n.invert(),n.point(e)}getAbsolutePosition(e){let n=!1,i=this.parent;for(;i;){if(i.isCached()){n=!0;break}i=i.parent}n&&!e&&(e=!0);var r=this.getAbsoluteTransform(e).getMatrix(),s=new ht,o=this.offset();return s.m=r.slice(),s.translate(o.x,o.y),s.getTranslation()}setAbsolutePosition(e){var n=this._clearTransform();this.attrs.x=n.x,this.attrs.y=n.y,delete n.x,delete n.y,this._clearCache(rn);var i=this._getAbsoluteTransform().copy();return i.invert(),i.translate(e.x,e.y),e={x:this.attrs.x+i.getTranslation().x,y:this.attrs.y+i.getTranslation().y},this._setTransform(n),this.setPosition({x:e.x,y:e.y}),this._clearCache(rn),this._clearSelfAndDescendantCache(Ut),this}_setTransform(e){var n;for(n in e)this.attrs[n]=e[n]}_clearTransform(){var e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){var n=e.x,i=e.y,r=this.x(),s=this.y();return n!==void 0&&(r+=n),i!==void 0&&(s+=i),this.setPosition({x:r,y:s}),this}_eachAncestorReverse(e,n){var i=[],r=this.getParent(),s,o;if(!(n&&n._id===this._id)){for(i.unshift(this);r&&(!n||r._id!==n._id);)i.unshift(r),r=r.parent;for(s=i.length,o=0;o<s;o++)e(i[o])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return T.warn("Node has no parent. moveToTop function is ignored."),!1;var e=this.index,n=this.parent.getChildren().length;return e<n-1?(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return T.warn("Node has no parent. moveUp function is ignored."),!1;var e=this.index,n=this.parent.getChildren().length;return e<n-1?(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return T.warn("Node has no parent. moveDown function is ignored."),!1;var e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return T.warn("Node has no parent. moveToBottom function is ignored."),!1;var e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(e){if(!this.parent)return T.warn("Node has no parent. zIndex parameter is ignored."),this;(e<0||e>=this.parent.children.length)&&T.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");var n=this.index;return this.parent.children.splice(n,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(Fr,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){var e=this.opacity(),n=this.getParent();return n&&!n._isUnderCache&&(e*=n.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){var e={},n=this.getAttrs(),i,r,s,o,a;e.attrs={};for(i in n)r=n[i],a=T.isObject(r)&&!T._isPlainObject(r)&&!T._isArray(r),!a&&(s=typeof this[i]=="function"&&this[i],delete n[i],o=s?s.call(this):null,n[i]=r,o!==r&&(e.attrs[i]=r));return e.className=this.getClassName(),T._prepareToStringify(e)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,n,i){var r=[];n&&this._isMatch(e)&&r.push(this);for(var s=this.parent;s;){if(s===i)return r;s._isMatch(e)&&r.push(s),s=s.parent}return r}isAncestorOf(e){return!1}findAncestor(e,n,i){return this.findAncestors(e,n,i)[0]}_isMatch(e){if(!e)return!1;if(typeof e=="function")return e(this);var n=e.replace(/ /g,"").split(","),i=n.length,r,s;for(r=0;r<i;r++)if(s=n[r],T.isValidSelector(s)||(T.warn('Selector "'+s+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),T.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),T.warn("Konva is awesome, right?")),s.charAt(0)==="#"){if(this.id()===s.slice(1))return!0}else if(s.charAt(0)==="."){if(this.hasName(s.slice(1)))return!0}else if(this.className===s||this.nodeType===s)return!0;return!1}getLayer(){var e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(El,this._getStage)}_getStage(){var e=this.getParent();if(e)return e.getStage()}fire(e,n={},i){return n.target=n.target||this,i?this._fireAndBubble(e,n):this._fire(e,n),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(Ut,this._getAbsoluteTransform)}_getAbsoluteTransform(e){var n;if(e)return n=new ht,this._eachAncestorReverse(function(r){var s=r.transformsEnabled();s==="all"?n.multiply(r.getTransform()):s==="position"&&n.translate(r.x()-r.offsetX(),r.y()-r.offsetY())},e),n;n=this._cache.get(Ut)||new ht,this.parent?this.parent.getAbsoluteTransform().copyInto(n):n.reset();var i=this.transformsEnabled();if(i==="all")n.multiply(this.getTransform());else if(i==="position"){const r=this.attrs.x||0,s=this.attrs.y||0,o=this.attrs.offsetX||0,a=this.attrs.offsetY||0;n.translate(r-o,s-a)}return n.dirty=!1,n}getAbsoluteScale(e){for(var n=this;n;)n._isUnderCache&&(e=n),n=n.getParent();const r=this.getAbsoluteTransform(e).decompose();return{x:r.scaleX,y:r.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(rn,this._getTransform)}_getTransform(){var e,n,i=this._cache.get(rn)||new ht;i.reset();var r=this.x(),s=this.y(),o=J.getAngle(this.rotation()),a=(e=this.attrs.scaleX)!==null&&e!==void 0?e:1,l=(n=this.attrs.scaleY)!==null&&n!==void 0?n:1,h=this.attrs.skewX||0,c=this.attrs.skewY||0,u=this.attrs.offsetX||0,d=this.attrs.offsetY||0;return(r!==0||s!==0)&&i.translate(r,s),o!==0&&i.rotate(o),(h!==0||c!==0)&&i.skew(h,c),(a!==1||l!==1)&&i.scale(a,l),(u!==0||d!==0)&&i.translate(-1*u,-1*d),i.dirty=!1,i}clone(e){var n=T.cloneObject(this.attrs),i,r,s,o,a;for(i in e)n[i]=e[i];var l=new this.constructor(n);for(i in this.eventListeners)for(r=this.eventListeners[i],s=r.length,o=0;o<s;o++)a=r[o],a.name.indexOf(L_)<0&&(l.eventListeners[i]||(l.eventListeners[i]=[]),l.eventListeners[i].push(a));return l}_toKonvaCanvas(e){e=e||{};var n=this.getClientRect(),i=this.getStage(),r=e.x!==void 0?e.x:Math.floor(n.x),s=e.y!==void 0?e.y:Math.floor(n.y),o=e.pixelRatio||1,a=new si({width:e.width||Math.ceil(n.width)||(i?i.width():0),height:e.height||Math.ceil(n.height)||(i?i.height():0),pixelRatio:o}),l=a.getContext();return e.imageSmoothingEnabled===!1&&(l._context.imageSmoothingEnabled=!1),l.save(),(r||s)&&l.translate(-1*r,-1*s),this.drawScene(a),l.restore(),a}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){e=e||{};var n=e.mimeType||null,i=e.quality||null,r=this._toKonvaCanvas(e).toDataURL(n,i);return e.callback&&e.callback(r),r}toImage(e){return new Promise((n,i)=>{try{const r=e==null?void 0:e.callback;r&&delete e.callback,T._urlToImage(this.toDataURL(e),function(s){n(s),r==null||r(s)})}catch(r){i(r)}})}toBlob(e){return new Promise((n,i)=>{try{const r=e==null?void 0:e.callback;r&&delete e.callback,this.toCanvas(e).toBlob(s=>{n(s),r==null||r(s)})}catch(r){i(r)}})}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():J.dragDistance}_off(e,n,i){var r=this.eventListeners[e],s,o,a;for(s=0;s<r.length;s++)if(o=r[s].name,a=r[s].handler,(o!=="konva"||n==="konva")&&(!n||o===n)&&(!i||i===a)){if(r.splice(s,1),r.length===0){delete this.eventListeners[e];break}s--}}_fireChangeEvent(e,n,i){this._fire(e+N_,{oldVal:n,newVal:i})}addName(e){if(!this.hasName(e)){var n=this.name(),i=n?n+" "+e:e;this.name(i)}return this}hasName(e){if(!e)return!1;const n=this.name();if(!n)return!1;var i=(n||"").split(/\s/g);return i.indexOf(e)!==-1}removeName(e){var n=(this.name()||"").split(/\s/g),i=n.indexOf(e);return i!==-1&&(n.splice(i,1),this.name(n.join(" "))),this}setAttr(e,n){var i=this[Sl+T._capitalize(e)];return T._isFunction(i)?i.call(this,n):this._setAttr(e,n),this}_requestDraw(){if(J.autoDrawEnabled){const e=this.getLayer()||this.getStage();e==null||e.batchDraw()}}_setAttr(e,n){var i=this.attrs[e];i===n&&!T.isObject(n)||(n==null?delete this.attrs[e]:this.attrs[e]=n,this._shouldFireChangeEvents&&this._fireChangeEvent(e,i,n),this._requestDraw())}_setComponentAttr(e,n,i){var r;i!==void 0&&(r=this.attrs[e],r||(this.attrs[e]=this.getAttr(e)),this.attrs[e][n]=i,this._fireChangeEvent(e,r,i))}_fireAndBubble(e,n,i){n&&this.nodeType===xl&&(n.target=this);var r=(e===wl||e===Cl)&&(i&&(this===i||this.isAncestorOf&&this.isAncestorOf(i))||this.nodeType==="Stage"&&!i);if(!r){this._fire(e,n);var s=(e===wl||e===Cl)&&i&&i.isAncestorOf&&i.isAncestorOf(this)&&!i.isAncestorOf(this.parent);(n&&!n.cancelBubble||!n)&&this.parent&&this.parent.isListening()&&!s&&(i&&i.parent?this._fireAndBubble.call(this.parent,e,n,i):this._fireAndBubble.call(this.parent,e,n))}}_getProtoListeners(e){let n=this._cache.get(kr);if(!n){n={};let r=Object.getPrototypeOf(this);for(;r;){if(!r.eventListeners){r=Object.getPrototypeOf(r);continue}for(var i in r.eventListeners){const s=r.eventListeners[i],o=n[i]||[];n[i]=s.concat(o)}r=Object.getPrototypeOf(r)}this._cache.set(kr,n)}return n[e]}_fire(e,n){n=n||{},n.currentTarget=this,n.type=e;const i=this._getProtoListeners(e);if(i)for(var r=0;r<i.length;r++)i[r].handler.call(this,n);const s=this.eventListeners[e];if(s)for(var r=0;r<s.length;r++)s[r].handler.call(this,n)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){var n=e?e.pointerId:void 0,i=this.getStage(),r=this.getAbsolutePosition(),s=i._getPointerById(n)||i._changedPointerPositions[0]||r;me._dragElements.set(this._id,{node:this,startPointerPos:s,offset:{x:s.x-r.x,y:s.y-r.y},dragStatus:"ready",pointerId:n})}startDrag(e,n=!0){me._dragElements.has(this._id)||this._createDragElement(e);const i=me._dragElements.get(this._id);i.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},n)}_setDragPosition(e,n){const i=this.getStage()._getPointerById(n.pointerId);if(i){var r={x:i.x-n.offset.x,y:i.y-n.offset.y},s=this.dragBoundFunc();if(s!==void 0){const o=s.call(this,r,e);o?r=o:T.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==r.x||this._lastPos.y!==r.y)&&(this.setAbsolutePosition(r),this._requestDraw()),this._lastPos=r}}stopDrag(e){const n=me._dragElements.get(this._id);n&&(n.dragStatus="stopped"),me._endDragBefore(e),me._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){const e=me._dragElements.get(this._id);return e?e.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(e){var n=e.evt.button!==void 0,i=!n||J.dragButtons.indexOf(e.evt.button)>=0;if(i&&!this.isDragging()){var r=!1;me._dragElements.forEach(s=>{this.isAncestorOf(s.node)&&(r=!0)}),r||this._createDragElement(e)}})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{this._dragCleanup();var e=this.getStage();if(!e)return;const n=me._dragElements.get(this._id),i=n&&n.dragStatus==="dragging",r=n&&n.dragStatus==="ready";i?this.stopDrag():r&&me._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(e={x:0,y:0}){const n=this.getStage();if(!n)return!1;const i={x:-e.x,y:-e.y,width:n.width()+2*e.x,height:n.height()+2*e.y};return T.haveIntersection(i,this.getClientRect())}static create(e,n){return T._isString(e)&&(e=JSON.parse(e)),this._createNode(e,n)}static _createNode(e,n){var i=H.prototype.getClassName.call(e),r=e.children,s,o,a;n&&(e.attrs.container=n),J[i]||(T.warn('Can not find a node with class name "'+i+'". Fallback to "Shape".'),i="Shape");const l=J[i];if(s=new l(e.attrs),r)for(o=r.length,a=0;a<o;a++)s.add(H._createNode(r[a]));return s}}H.prototype.nodeType="Node";H.prototype._attrsAffectingSize=[];H.prototype.eventListeners={};H.prototype.on.call(H.prototype,F_,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(rn),this._clearSelfAndDescendantCache(Ut)});H.prototype.on.call(H.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(po)});H.prototype.on.call(H.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(fo)});H.prototype.on.call(H.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(Fr)});const Ee=b.addGetterSetter;Ee(H,"zIndex");Ee(H,"absolutePosition");Ee(H,"position");Ee(H,"x",0,U());Ee(H,"y",0,U());Ee(H,"globalCompositeOperation","source-over",yi());Ee(H,"opacity",1,U());Ee(H,"name","",yi());Ee(H,"id","",yi());Ee(H,"rotation",0,U());b.addComponentsGetterSetter(H,"scale",["x","y"]);Ee(H,"scaleX",1,U());Ee(H,"scaleY",1,U());b.addComponentsGetterSetter(H,"skew",["x","y"]);Ee(H,"skewX",0,U());Ee(H,"skewY",0,U());b.addComponentsGetterSetter(H,"offset",["x","y"]);Ee(H,"offsetX",0,U());Ee(H,"offsetY",0,U());Ee(H,"dragDistance",null,U());Ee(H,"width",0,U());Ee(H,"height",0,U());Ee(H,"listening",!0,Mt());Ee(H,"preventDefault",!0,Mt());Ee(H,"filters",null,function(t){return this._filterUpToDate=!1,t});Ee(H,"visible",!0,Mt());Ee(H,"transformsEnabled","all",yi());Ee(H,"size");Ee(H,"dragBoundFunc");Ee(H,"draggable",!1,Mt());b.backCompat(H,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});class dt extends H{constructor(){super(...arguments),this.children=[]}getChildren(e){if(!e)return this.children||[];const n=this.children||[];var i=[];return n.forEach(function(r){e(r)&&i.push(r)}),i}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.destroy()}),this.children=[],this._requestDraw(),this}add(...e){if(e.length===0)return this;if(e.length>1){for(var n=0;n<e.length;n++)this.add(e[n]);return this}const i=e[0];return i.getParent()?(i.moveTo(this),this):(this._validateAdd(i),i.index=this.getChildren().length,i.parent=this,i._clearCaches(),this.getChildren().push(i),this._fire("add",{child:i}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){var n=this._generalFind(e,!0);return n.length>0?n[0]:void 0}_generalFind(e,n){var i=[];return this._descendants(r=>{const s=r._isMatch(e);return s&&i.push(r),!!(s&&n)}),i}_descendants(e){let n=!1;const i=this.getChildren();for(const r of i){if(n=e(r),n)return!0;if(r.hasChildren()&&(n=r._descendants(e),n))return!0}return!1}toObject(){var e=H.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach(n=>{e.children.push(n.toObject())}),e}isAncestorOf(e){for(var n=e.getParent();n;){if(n._id===this._id)return!0;n=n.getParent()}return!1}clone(e){var n=H.prototype.clone.call(this,e);return this.getChildren().forEach(function(i){n.add(i.clone())}),n}getAllIntersections(e){var n=[];return this.find("Shape").forEach(function(i){i.isVisible()&&i.intersects(e)&&n.push(i)}),n}_clearSelfAndDescendantCache(e){var n;super._clearSelfAndDescendantCache(e),!this.isCached()&&((n=this.children)===null||n===void 0||n.forEach(function(i){i._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;(e=this.children)===null||e===void 0||e.forEach(function(n,i){n.index=i}),this._requestDraw()}drawScene(e,n){var i=this.getLayer(),r=e||i&&i.getCanvas(),s=r&&r.getContext(),o=this._getCanvasCache(),a=o&&o.scene,l=r&&r.isCache;if(!this.isVisible()&&!l)return this;if(a){s.save();var h=this.getAbsoluteTransform(n).getMatrix();s.transform(h[0],h[1],h[2],h[3],h[4],h[5]),this._drawCachedSceneCanvas(s),s.restore()}else this._drawChildren("drawScene",r,n);return this}drawHit(e,n){if(!this.shouldDrawHit(n))return this;var i=this.getLayer(),r=e||i&&i.hitCanvas,s=r&&r.getContext(),o=this._getCanvasCache(),a=o&&o.hit;if(a){s.save();var l=this.getAbsoluteTransform(n).getMatrix();s.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this._drawCachedHitCanvas(s),s.restore()}else this._drawChildren("drawHit",r,n);return this}_drawChildren(e,n,i){var r,s=n&&n.getContext(),o=this.clipWidth(),a=this.clipHeight(),l=this.clipFunc(),h=o&&a||l;const c=i===this;if(h){s.save();var u=this.getAbsoluteTransform(i),d=u.getMatrix();if(s.transform(d[0],d[1],d[2],d[3],d[4],d[5]),s.beginPath(),l)l.call(this,s,this);else{var p=this.clipX(),f=this.clipY();s.rect(p,f,o,a)}s.clip(),d=u.copy().invert().getMatrix(),s.transform(d[0],d[1],d[2],d[3],d[4],d[5])}var v=!c&&this.globalCompositeOperation()!=="source-over"&&e==="drawScene";v&&(s.save(),s._applyGlobalCompositeOperation(this)),(r=this.children)===null||r===void 0||r.forEach(function(_){_[e](n,i)}),v&&s.restore(),h&&s.restore()}getClientRect(e){var n;e=e||{};var i=e.skipTransform,r=e.relativeTo,s,o,a,l,h={x:1/0,y:1/0,width:0,height:0},c=this;(n=this.children)===null||n===void 0||n.forEach(function(v){if(v.visible()){var _=v.getClientRect({relativeTo:c,skipShadow:e.skipShadow,skipStroke:e.skipStroke});_.width===0&&_.height===0||(s===void 0?(s=_.x,o=_.y,a=_.x+_.width,l=_.y+_.height):(s=Math.min(s,_.x),o=Math.min(o,_.y),a=Math.max(a,_.x+_.width),l=Math.max(l,_.y+_.height)))}});for(var u=this.find("Shape"),d=!1,p=0;p<u.length;p++){var f=u[p];if(f._isVisible(this)){d=!0;break}}return d&&s!==void 0?h={x:s,y:o,width:a-s,height:l-o}:h={x:0,y:0,width:0,height:0},i?h:this._transformedRect(h,r)}}b.addComponentsGetterSetter(dt,"clip",["x","y","width","height"]);b.addGetterSetter(dt,"clipX",void 0,U());b.addGetterSetter(dt,"clipY",void 0,U());b.addGetterSetter(dt,"clipWidth",void 0,U());b.addGetterSetter(dt,"clipHeight",void 0,U());b.addGetterSetter(dt,"clipFunc");const ir=new Map,Wc=J._global.PointerEvent!==void 0;function Rs(t){return ir.get(t)}function ra(t){return{evt:t,pointerId:t.pointerId}}function zc(t,e){return ir.get(t)===e}function Vc(t,e){Ui(t),e.getStage()&&(ir.set(t,e),Wc&&e._fire("gotpointercapture",ra(new PointerEvent("gotpointercapture"))))}function Ui(t,e){const n=ir.get(t);if(!n)return;const i=n.getStage();i&&i.content,ir.delete(t),Wc&&n._fire("lostpointercapture",ra(new PointerEvent("lostpointercapture")))}var B_="Stage",H_="string",Tl="px",U_="mouseout",Yc="mouseleave",Xc="mouseover",Kc="mouseenter",qc="mousemove",Jc="mousedown",Qc="mouseup",Ii="pointermove",Ri="pointerdown",Qn="pointerup",Ni="pointercancel",j_="lostpointercapture",Pr="pointerout",Mr="pointerleave",Or="pointerover",Ar="pointerenter",go="contextmenu",Zc="touchstart",eu="touchend",tu="touchmove",nu="touchcancel",vo="wheel",W_=5,z_=[[Kc,"_pointerenter"],[Jc,"_pointerdown"],[qc,"_pointermove"],[Qc,"_pointerup"],[Yc,"_pointerleave"],[Zc,"_pointerdown"],[tu,"_pointermove"],[eu,"_pointerup"],[nu,"_pointercancel"],[Xc,"_pointerover"],[vo,"_wheel"],[go,"_contextmenu"],[Ri,"_pointerdown"],[Ii,"_pointermove"],[Qn,"_pointerup"],[Ni,"_pointercancel"],[j_,"_lostpointercapture"]];const Ns={mouse:{[Pr]:U_,[Mr]:Yc,[Or]:Xc,[Ar]:Kc,[Ii]:qc,[Ri]:Jc,[Qn]:Qc,[Ni]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[Pr]:"touchout",[Mr]:"touchleave",[Or]:"touchover",[Ar]:"touchenter",[Ii]:tu,[Ri]:Zc,[Qn]:eu,[Ni]:nu,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[Pr]:Pr,[Mr]:Mr,[Or]:Or,[Ar]:Ar,[Ii]:Ii,[Ri]:Ri,[Qn]:Qn,[Ni]:Ni,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},Di=t=>t.indexOf("pointer")>=0?"pointer":t.indexOf("touch")>=0?"touch":"mouse",Kn=t=>{const e=Di(t);if(e==="pointer")return J.pointerEventsEnabled&&Ns.pointer;if(e==="touch")return Ns.touch;if(e==="mouse")return Ns.mouse};function kl(t={}){return(t.clipFunc||t.clipWidth||t.clipHeight)&&T.warn("Stage does not support clipping. Please use clip for Layers or Groups."),t}const V_="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);",Br=[];class Cs extends dt{constructor(e){super(kl(e)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),Br.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{kl(this.attrs)}),this._checkVisibility()}_validateAdd(e){const n=e.getType()==="Layer",i=e.getType()==="FastLayer";n||i||T.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const e=this.visible()?"":"none";this.content.style.display=e}setContainer(e){if(typeof e===H_){if(e.charAt(0)==="."){var n=e.slice(1);e=document.getElementsByClassName(n)[0]}else{var i;e.charAt(0)!=="#"?i=e:i=e.slice(1),e=document.getElementById(i)}if(!e)throw"Can not find container in document with id "+i}return this._setAttr("container",e),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),e.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){var e=this.children,n=e.length,i;for(i=0;i<n;i++)e[i].clear();return this}clone(e){return e||(e={}),e.container=typeof document<"u"&&document.createElement("div"),dt.prototype.clone.call(this,e)}destroy(){super.destroy();var e=this.content;e&&T._isInDocument(e)&&this.container().removeChild(e);var n=Br.indexOf(this);return n>-1&&Br.splice(n,1),T.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const e=this._pointerPositions[0]||this._changedPointerPositions[0];return e?{x:e.x,y:e.y}:(T.warn(V_),null)}_getPointerById(e){return this._pointerPositions.find(n=>n.id===e)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(e){e=e||{},e.x=e.x||0,e.y=e.y||0,e.width=e.width||this.width(),e.height=e.height||this.height();var n=new si({width:e.width,height:e.height,pixelRatio:e.pixelRatio||1}),i=n.getContext()._context,r=this.children;return(e.x||e.y)&&i.translate(-1*e.x,-1*e.y),r.forEach(function(s){if(s.isVisible()){var o=s._toKonvaCanvas(e);i.drawImage(o._canvas,e.x,e.y,o.getWidth()/o.getPixelRatio(),o.getHeight()/o.getPixelRatio())}}),n}getIntersection(e){if(!e)return null;var n=this.children,i=n.length,r=i-1,s;for(s=r;s>=0;s--){const o=n[s].getIntersection(e);if(o)return o}return null}_resizeDOM(){var e=this.width(),n=this.height();this.content&&(this.content.style.width=e+Tl,this.content.style.height=n+Tl),this.bufferCanvas.setSize(e,n),this.bufferHitCanvas.setSize(e,n),this.children.forEach(i=>{i.setSize({width:e,height:n}),i.draw()})}add(e,...n){if(arguments.length>1){for(var i=0;i<arguments.length;i++)this.add(arguments[i]);return this}super.add(e);var r=this.children.length;return r>W_&&T.warn("The stage has "+r+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),e.setSize({width:this.width(),height:this.height()}),e.draw(),J.isBrowser&&this.content.appendChild(e.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(e){return zc(e,this)}setPointerCapture(e){Vc(e,this)}releaseCapture(e){Ui(e)}getLayers(){return this.children}_bindContentEvents(){J.isBrowser&&z_.forEach(([e,n])=>{this.content.addEventListener(e,i=>{this[n](i)},{passive:!1})})}_pointerenter(e){this.setPointersPositions(e);const n=Kn(e.type);this._fire(n.pointerenter,{evt:e,target:this,currentTarget:this})}_pointerover(e){this.setPointersPositions(e);const n=Kn(e.type);this._fire(n.pointerover,{evt:e,target:this,currentTarget:this})}_getTargetShape(e){let n=this[e+"targetShape"];return n&&!n.getStage()&&(n=null),n}_pointerleave(e){const n=Kn(e.type),i=Di(e.type);if(n){this.setPointersPositions(e);var r=this._getTargetShape(i),s=!me.isDragging||J.hitOnDragEnabled;r&&s?(r._fireAndBubble(n.pointerout,{evt:e}),r._fireAndBubble(n.pointerleave,{evt:e}),this._fire(n.pointerleave,{evt:e,target:this,currentTarget:this}),this[i+"targetShape"]=null):s&&(this._fire(n.pointerleave,{evt:e,target:this,currentTarget:this}),this._fire(n.pointerout,{evt:e,target:this,currentTarget:this})),this.pointerPos=void 0,this._pointerPositions=[]}}_pointerdown(e){const n=Kn(e.type),i=Di(e.type);if(n){this.setPointersPositions(e);var r=!1;this._changedPointerPositions.forEach(s=>{var o=this.getIntersection(s);if(me.justDragged=!1,J["_"+i+"ListenClick"]=!0,!(o&&o.isListening()))return;J.capturePointerEventsEnabled&&o.setPointerCapture(s.id),this[i+"ClickStartShape"]=o,o._fireAndBubble(n.pointerdown,{evt:e,pointerId:s.id}),r=!0;const l=e.type.indexOf("touch")>=0;o.preventDefault()&&e.cancelable&&l&&e.preventDefault()}),r||this._fire(n.pointerdown,{evt:e,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}}_pointermove(e){const n=Kn(e.type),i=Di(e.type);if(!n)return;me.isDragging&&me.node.preventDefault()&&e.cancelable&&e.preventDefault(),this.setPointersPositions(e);var r=!me.isDragging||J.hitOnDragEnabled;if(!r)return;var s={};let o=!1;var a=this._getTargetShape(i);this._changedPointerPositions.forEach(l=>{const h=Rs(l.id)||this.getIntersection(l),c=l.id,u={evt:e,pointerId:c};var d=a!==h;if(d&&a&&(a._fireAndBubble(n.pointerout,Object.assign({},u),h),a._fireAndBubble(n.pointerleave,Object.assign({},u),h)),h){if(s[h._id])return;s[h._id]=!0}h&&h.isListening()?(o=!0,d&&(h._fireAndBubble(n.pointerover,Object.assign({},u),a),h._fireAndBubble(n.pointerenter,Object.assign({},u),a),this[i+"targetShape"]=h),h._fireAndBubble(n.pointermove,Object.assign({},u))):a&&(this._fire(n.pointerover,{evt:e,target:this,currentTarget:this,pointerId:c}),this[i+"targetShape"]=null)}),o||this._fire(n.pointermove,{evt:e,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(e){const n=Kn(e.type),i=Di(e.type);if(!n)return;this.setPointersPositions(e);const r=this[i+"ClickStartShape"],s=this[i+"ClickEndShape"];var o={};let a=!1;this._changedPointerPositions.forEach(l=>{const h=Rs(l.id)||this.getIntersection(l);if(h){if(h.releaseCapture(l.id),o[h._id])return;o[h._id]=!0}const c=l.id,u={evt:e,pointerId:c};let d=!1;J["_"+i+"InDblClickWindow"]?(d=!0,clearTimeout(this[i+"DblTimeout"])):me.justDragged||(J["_"+i+"InDblClickWindow"]=!0,clearTimeout(this[i+"DblTimeout"])),this[i+"DblTimeout"]=setTimeout(function(){J["_"+i+"InDblClickWindow"]=!1},J.dblClickWindow),h&&h.isListening()?(a=!0,this[i+"ClickEndShape"]=h,h._fireAndBubble(n.pointerup,Object.assign({},u)),J["_"+i+"ListenClick"]&&r&&r===h&&(h._fireAndBubble(n.pointerclick,Object.assign({},u)),d&&s&&s===h&&h._fireAndBubble(n.pointerdblclick,Object.assign({},u)))):(this[i+"ClickEndShape"]=null,J["_"+i+"ListenClick"]&&this._fire(n.pointerclick,{evt:e,target:this,currentTarget:this,pointerId:c}),d&&this._fire(n.pointerdblclick,{evt:e,target:this,currentTarget:this,pointerId:c}))}),a||this._fire(n.pointerup,{evt:e,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),J["_"+i+"ListenClick"]=!1,e.cancelable&&i!=="touch"&&e.preventDefault()}_contextmenu(e){this.setPointersPositions(e);var n=this.getIntersection(this.getPointerPosition());n&&n.isListening()?n._fireAndBubble(go,{evt:e}):this._fire(go,{evt:e,target:this,currentTarget:this})}_wheel(e){this.setPointersPositions(e);var n=this.getIntersection(this.getPointerPosition());n&&n.isListening()?n._fireAndBubble(vo,{evt:e}):this._fire(vo,{evt:e,target:this,currentTarget:this})}_pointercancel(e){this.setPointersPositions(e);const n=Rs(e.pointerId)||this.getIntersection(this.getPointerPosition());n&&n._fireAndBubble(Qn,ra(e)),Ui(e.pointerId)}_lostpointercapture(e){Ui(e.pointerId)}setPointersPositions(e){var n=this._getContentPosition(),i=null,r=null;e=e||window.event,e.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(e.touches,s=>{this._pointerPositions.push({id:s.identifier,x:(s.clientX-n.left)/n.scaleX,y:(s.clientY-n.top)/n.scaleY})}),Array.prototype.forEach.call(e.changedTouches||e.touches,s=>{this._changedPointerPositions.push({id:s.identifier,x:(s.clientX-n.left)/n.scaleX,y:(s.clientY-n.top)/n.scaleY})})):(i=(e.clientX-n.left)/n.scaleX,r=(e.clientY-n.top)/n.scaleY,this.pointerPos={x:i,y:r},this._pointerPositions=[{x:i,y:r,id:T._getFirstPointerId(e)}],this._changedPointerPositions=[{x:i,y:r,id:T._getFirstPointerId(e)}])}_setPointerPosition(e){T.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(e)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};var e=this.content.getBoundingClientRect();return{top:e.top,left:e.left,scaleX:e.width/this.content.clientWidth||1,scaleY:e.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new si({width:this.width(),height:this.height()}),this.bufferHitCanvas=new ia({pixelRatio:1,width:this.width(),height:this.height()}),!!J.isBrowser){var e=this.container();if(!e)throw"Stage has no container. A container is required.";e.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),e.appendChild(this.content),this._resizeDOM()}}cache(){return T.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(e){e.batchDraw()}),this}}Cs.prototype.nodeType=B_;Ae(Cs);b.addGetterSetter(Cs,"container");var iu="hasShadow",ru="shadowRGBA",su="patternImage",ou="linearGradient",au="radialGradient";let Ir;function Ds(){return Ir||(Ir=T.createCanvasElement().getContext("2d"),Ir)}const ji={};function Y_(t){t.fill()}function X_(t){t.stroke()}function K_(t){t.fill()}function q_(t){t.stroke()}function J_(){this._clearCache(iu)}function Q_(){this._clearCache(ru)}function Z_(){this._clearCache(su)}function ey(){this._clearCache(ou)}function ty(){this._clearCache(au)}class F extends H{constructor(e){super(e);let n;for(;n=T.getRandomColor(),!(n&&!(n in ji)););this.colorKey=n,ji[n]=this}getContext(){return T.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return T.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(iu,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(su,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){var e=Ds();const n=e.createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(n&&n.setTransform){const i=new ht;i.translate(this.fillPatternX(),this.fillPatternY()),i.rotate(J.getAngle(this.fillPatternRotation())),i.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),i.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const r=i.getMatrix(),s=typeof DOMMatrix>"u"?{a:r[0],b:r[1],c:r[2],d:r[3],e:r[4],f:r[5]}:new DOMMatrix(r);n.setTransform(s)}return n}}_getLinearGradient(){return this._getCache(ou,this.__getLinearGradient)}__getLinearGradient(){var e=this.fillLinearGradientColorStops();if(e){for(var n=Ds(),i=this.fillLinearGradientStartPoint(),r=this.fillLinearGradientEndPoint(),s=n.createLinearGradient(i.x,i.y,r.x,r.y),o=0;o<e.length;o+=2)s.addColorStop(e[o],e[o+1]);return s}}_getRadialGradient(){return this._getCache(au,this.__getRadialGradient)}__getRadialGradient(){var e=this.fillRadialGradientColorStops();if(e){for(var n=Ds(),i=this.fillRadialGradientStartPoint(),r=this.fillRadialGradientEndPoint(),s=n.createRadialGradient(i.x,i.y,this.fillRadialGradientStartRadius(),r.x,r.y,this.fillRadialGradientEndRadius()),o=0;o<e.length;o+=2)s.addColorStop(e[o],e[o+1]);return s}}getShadowRGBA(){return this._getCache(ru,this._getShadowRGBA)}_getShadowRGBA(){if(this.hasShadow()){var e=T.colorToRGBA(this.shadowColor());if(e)return"rgba("+e.r+","+e.g+","+e.b+","+e.a*(this.shadowOpacity()||1)+")"}}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const e=this.hitStrokeWidth();return e==="auto"?this.hasStroke():this.strokeEnabled()&&!!e}intersects(e){var n=this.getStage(),i=n.bufferHitCanvas,r;return i.getContext().clear(),this.drawHit(i,null,!0),r=i.context.getImageData(Math.round(e.x),Math.round(e.y),1,1).data,r[3]>0}destroy(){return H.prototype.destroy.call(this),delete ji[this.colorKey],delete this.colorKey,this}_useBufferCanvas(e){var n;if(!this.getStage()||!((n=this.attrs.perfectDrawEnabled)!==null&&n!==void 0?n:!0))return!1;const r=e||this.hasFill(),s=this.hasStroke(),o=this.getAbsoluteOpacity()!==1;if(r&&s&&o)return!0;const a=this.hasShadow(),l=this.shadowForStrokeEnabled();return!!(r&&s&&a&&l)}setStrokeHitEnabled(e){T.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),e?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){var e=this.size();return{x:this._centroid?-e.width/2:0,y:this._centroid?-e.height/2:0,width:e.width,height:e.height}}getClientRect(e={}){const n=e.skipTransform,i=e.relativeTo,r=this.getSelfRect(),o=!e.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,a=r.width+o,l=r.height+o,h=!e.skipShadow&&this.hasShadow(),c=h?this.shadowOffsetX():0,u=h?this.shadowOffsetY():0,d=a+Math.abs(c),p=l+Math.abs(u),f=h&&this.shadowBlur()||0,v=d+f*2,_=p+f*2,y={width:v,height:_,x:-(o/2+f)+Math.min(c,0)+r.x,y:-(o/2+f)+Math.min(u,0)+r.y};return n?y:this._transformedRect(y,i)}drawScene(e,n){var i=this.getLayer(),r=e||i.getCanvas(),s=r.getContext(),o=this._getCanvasCache(),a=this.getSceneFunc(),l=this.hasShadow(),h,c,u,d=r.isCache,p=n===this;if(!this.isVisible()&&!p)return this;if(o){s.save();var f=this.getAbsoluteTransform(n).getMatrix();return s.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this._drawCachedSceneCanvas(s),s.restore(),this}if(!a)return this;if(s.save(),this._useBufferCanvas()&&!d){h=this.getStage(),c=h.bufferCanvas,u=c.getContext(),u.clear(),u.save(),u._applyLineJoin(this);var v=this.getAbsoluteTransform(n).getMatrix();u.transform(v[0],v[1],v[2],v[3],v[4],v[5]),a.call(this,u,this),u.restore();var _=c.pixelRatio;l&&s._applyShadow(this),s._applyOpacity(this),s._applyGlobalCompositeOperation(this),s.drawImage(c._canvas,0,0,c.width/_,c.height/_)}else{if(s._applyLineJoin(this),!p){var v=this.getAbsoluteTransform(n).getMatrix();s.transform(v[0],v[1],v[2],v[3],v[4],v[5]),s._applyOpacity(this),s._applyGlobalCompositeOperation(this)}l&&s._applyShadow(this),a.call(this,s,this)}return s.restore(),this}drawHit(e,n,i=!1){if(!this.shouldDrawHit(n,i))return this;var r=this.getLayer(),s=e||r.hitCanvas,o=s&&s.getContext(),a=this.hitFunc()||this.sceneFunc(),l=this._getCanvasCache(),h=l&&l.hit;if(this.colorKey||T.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),h){o.save();var c=this.getAbsoluteTransform(n).getMatrix();return o.transform(c[0],c[1],c[2],c[3],c[4],c[5]),this._drawCachedHitCanvas(o),o.restore(),this}if(!a)return this;if(o.save(),o._applyLineJoin(this),!(this===n)){var d=this.getAbsoluteTransform(n).getMatrix();o.transform(d[0],d[1],d[2],d[3],d[4],d[5])}return a.call(this,o,this),o.restore(),this}drawHitFromCache(e=0){var n=this._getCanvasCache(),i=this._getCachedSceneCanvas(),r=n.hit,s=r.getContext(),o=r.getWidth(),a=r.getHeight(),l,h,c,u,d,p;s.clear(),s.drawImage(i._canvas,0,0,o,a);try{for(l=s.getImageData(0,0,o,a),h=l.data,c=h.length,u=T._hexToRgb(this.colorKey),d=0;d<c;d+=4)p=h[d+3],p>e?(h[d]=u.r,h[d+1]=u.g,h[d+2]=u.b,h[d+3]=255):h[d+3]=0;s.putImageData(l,0,0)}catch(f){T.error("Unable to draw hit graph from cached scene canvas. "+f.message)}return this}hasPointerCapture(e){return zc(e,this)}setPointerCapture(e){Vc(e,this)}releaseCapture(e){Ui(e)}}F.prototype._fillFunc=Y_;F.prototype._strokeFunc=X_;F.prototype._fillFuncHit=K_;F.prototype._strokeFuncHit=q_;F.prototype._centroid=!1;F.prototype.nodeType="Shape";Ae(F);F.prototype.eventListeners={};F.prototype.on.call(F.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",J_);F.prototype.on.call(F.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",Q_);F.prototype.on.call(F.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",Z_);F.prototype.on.call(F.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",ey);F.prototype.on.call(F.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",ty);b.addGetterSetter(F,"stroke",void 0,jc());b.addGetterSetter(F,"strokeWidth",2,U());b.addGetterSetter(F,"fillAfterStrokeEnabled",!1);b.addGetterSetter(F,"hitStrokeWidth","auto",na());b.addGetterSetter(F,"strokeHitEnabled",!0,Mt());b.addGetterSetter(F,"perfectDrawEnabled",!0,Mt());b.addGetterSetter(F,"shadowForStrokeEnabled",!0,Mt());b.addGetterSetter(F,"lineJoin");b.addGetterSetter(F,"lineCap");b.addGetterSetter(F,"sceneFunc");b.addGetterSetter(F,"hitFunc");b.addGetterSetter(F,"dash");b.addGetterSetter(F,"dashOffset",0,U());b.addGetterSetter(F,"shadowColor",void 0,yi());b.addGetterSetter(F,"shadowBlur",0,U());b.addGetterSetter(F,"shadowOpacity",1,U());b.addComponentsGetterSetter(F,"shadowOffset",["x","y"]);b.addGetterSetter(F,"shadowOffsetX",0,U());b.addGetterSetter(F,"shadowOffsetY",0,U());b.addGetterSetter(F,"fillPatternImage");b.addGetterSetter(F,"fill",void 0,jc());b.addGetterSetter(F,"fillPatternX",0,U());b.addGetterSetter(F,"fillPatternY",0,U());b.addGetterSetter(F,"fillLinearGradientColorStops");b.addGetterSetter(F,"strokeLinearGradientColorStops");b.addGetterSetter(F,"fillRadialGradientStartRadius",0);b.addGetterSetter(F,"fillRadialGradientEndRadius",0);b.addGetterSetter(F,"fillRadialGradientColorStops");b.addGetterSetter(F,"fillPatternRepeat","repeat");b.addGetterSetter(F,"fillEnabled",!0);b.addGetterSetter(F,"strokeEnabled",!0);b.addGetterSetter(F,"shadowEnabled",!0);b.addGetterSetter(F,"dashEnabled",!0);b.addGetterSetter(F,"strokeScaleEnabled",!0);b.addGetterSetter(F,"fillPriority","color");b.addComponentsGetterSetter(F,"fillPatternOffset",["x","y"]);b.addGetterSetter(F,"fillPatternOffsetX",0,U());b.addGetterSetter(F,"fillPatternOffsetY",0,U());b.addComponentsGetterSetter(F,"fillPatternScale",["x","y"]);b.addGetterSetter(F,"fillPatternScaleX",1,U());b.addGetterSetter(F,"fillPatternScaleY",1,U());b.addComponentsGetterSetter(F,"fillLinearGradientStartPoint",["x","y"]);b.addComponentsGetterSetter(F,"strokeLinearGradientStartPoint",["x","y"]);b.addGetterSetter(F,"fillLinearGradientStartPointX",0);b.addGetterSetter(F,"strokeLinearGradientStartPointX",0);b.addGetterSetter(F,"fillLinearGradientStartPointY",0);b.addGetterSetter(F,"strokeLinearGradientStartPointY",0);b.addComponentsGetterSetter(F,"fillLinearGradientEndPoint",["x","y"]);b.addComponentsGetterSetter(F,"strokeLinearGradientEndPoint",["x","y"]);b.addGetterSetter(F,"fillLinearGradientEndPointX",0);b.addGetterSetter(F,"strokeLinearGradientEndPointX",0);b.addGetterSetter(F,"fillLinearGradientEndPointY",0);b.addGetterSetter(F,"strokeLinearGradientEndPointY",0);b.addComponentsGetterSetter(F,"fillRadialGradientStartPoint",["x","y"]);b.addGetterSetter(F,"fillRadialGradientStartPointX",0);b.addGetterSetter(F,"fillRadialGradientStartPointY",0);b.addComponentsGetterSetter(F,"fillRadialGradientEndPoint",["x","y"]);b.addGetterSetter(F,"fillRadialGradientEndPointX",0);b.addGetterSetter(F,"fillRadialGradientEndPointY",0);b.addGetterSetter(F,"fillPatternRotation",0);b.backCompat(F,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});var ny="#",iy="beforeDraw",ry="draw",lu=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],sy=lu.length;class Un extends dt{constructor(e){super(e),this.canvas=new si,this.hitCanvas=new ia({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(e){return this.getContext().clear(e),this.getHitCanvas().getContext().clear(e),this}setZIndex(e){super.setZIndex(e);var n=this.getStage();return n&&n.content&&(n.content.removeChild(this.getNativeCanvasElement()),e<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[e+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){H.prototype.moveToTop.call(this);var e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){var e=H.prototype.moveUp.call(this);if(!e)return!1;var n=this.getStage();return!n||!n.content?!1:(n.content.removeChild(this.getNativeCanvasElement()),this.index<n.children.length-1?n.content.insertBefore(this.getNativeCanvasElement(),n.children[this.index+1].getCanvas()._canvas):n.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(H.prototype.moveDown.call(this)){var e=this.getStage();if(e){var n=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),n[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(H.prototype.moveToBottom.call(this)){var e=this.getStage();if(e){var n=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),n[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){var e=this.getNativeCanvasElement();return H.prototype.remove.call(this),e&&e.parentNode&&T._isInDocument(e)&&e.parentNode.removeChild(e),this}getStage(){return this.parent}setSize({width:e,height:n}){return this.canvas.setSize(e,n),this.hitCanvas.setSize(e,n),this._setSmoothEnabled(),this}_validateAdd(e){var n=e.getType();n!=="Group"&&n!=="Shape"&&T.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(e){return e=e||{},e.width=e.width||this.getWidth(),e.height=e.height||this.getHeight(),e.x=e.x!==void 0?e.x:this.x(),e.y=e.y!==void 0?e.y:this.y(),H.prototype._toKonvaCanvas.call(this,e)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){T.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){T.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,T.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(e){if(!this.isListening()||!this.isVisible())return null;for(var n=1,i=!1;;){for(let r=0;r<sy;r++){const s=lu[r],o=this._getIntersection({x:e.x+s.x*n,y:e.y+s.y*n}),a=o.shape;if(a)return a;if(i=!!o.antialiased,!o.antialiased)break}if(i)n+=1;else return null}}_getIntersection(e){const n=this.hitCanvas.pixelRatio,i=this.hitCanvas.context.getImageData(Math.round(e.x*n),Math.round(e.y*n),1,1).data,r=i[3];if(r===255){const s=T._rgbToHex(i[0],i[1],i[2]),o=ji[ny+s];return o?{shape:o}:{antialiased:!0}}else if(r>0)return{antialiased:!0};return{}}drawScene(e,n){var i=this.getLayer(),r=e||i&&i.getCanvas();return this._fire(iy,{node:this}),this.clearBeforeDraw()&&r.getContext().clear(),dt.prototype.drawScene.call(this,r,n),this._fire(ry,{node:this}),this}drawHit(e,n){var i=this.getLayer(),r=e||i&&i.hitCanvas;return i&&i.clearBeforeDraw()&&i.getHitCanvas().getContext().clear(),dt.prototype.drawHit.call(this,r,n),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(e){T.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(e)}getHitGraphEnabled(e){return T.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!(!this.parent||!this.parent.content)){var e=this.parent,n=!!this.hitCanvas._canvas.parentNode;n?e.content.removeChild(this.hitCanvas._canvas):e.content.appendChild(this.hitCanvas._canvas)}}destroy(){return T.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}Un.prototype.nodeType="Layer";Ae(Un);b.addGetterSetter(Un,"imageSmoothingEnabled",!0);b.addGetterSetter(Un,"clearBeforeDraw",!0);b.addGetterSetter(Un,"hitGraphEnabled",!0,Mt());class sa extends Un{constructor(e){super(e),this.listening(!1),T.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}sa.prototype.nodeType="FastLayer";Ae(sa);class di extends dt{_validateAdd(e){var n=e.getType();n!=="Group"&&n!=="Shape"&&T.throw("You may only add groups and shapes to groups.")}}di.prototype.nodeType="Group";Ae(di);var Ls=function(){return ri.performance&&ri.performance.now?function(){return ri.performance.now()}:function(){return new Date().getTime()}}();class mt{constructor(e,n){this.id=mt.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Ls(),frameRate:0},this.func=e,this.setLayers(n)}setLayers(e){var n=[];return e?e.length>0?n=e:n=[e]:n=[],this.layers=n,this}getLayers(){return this.layers}addLayer(e){var n=this.layers,i=n.length,r;for(r=0;r<i;r++)if(n[r]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){var e=mt,n=e.animations,i=n.length,r;for(r=0;r<i;r++)if(n[r].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Ls(),mt._addAnimation(this),this}stop(){return mt._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){var n=e.id,i=this.animations,r=i.length,s;for(s=0;s<r;s++)if(i[s].id===n){this.animations.splice(s,1);break}}static _runFrames(){var e={},n=this.animations,i,r,s,o,a,l,h,c,u;for(o=0;o<n.length;o++)if(i=n[o],r=i.layers,s=i.func,i._updateFrameObject(Ls()),l=r.length,s?u=s.call(i,i.frame)!==!1:u=!0,!!u)for(a=0;a<l;a++)h=r[a],h._id!==void 0&&(e[h._id]=h);for(c in e)e.hasOwnProperty(c)&&e[c].batchDraw()}static _animationLoop(){var e=mt;e.animations.length?(e._runFrames(),T.requestAnimFrame(e._animationLoop)):e.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,T.requestAnimFrame(this._animationLoop))}}mt.animations=[];mt.animIdCounter=0;mt.animRunning=!1;var oy={node:1,duration:1,easing:1,onFinish:1,yoyo:1},ay=1,Pl=2,Ml=3,ly=0,Ol=["fill","stroke","shadowColor"];class hy{constructor(e,n,i,r,s,o,a){this.prop=e,this.propFunc=n,this.begin=r,this._pos=r,this.duration=o,this._change=0,this.prevPos=0,this.yoyo=a,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=i,this._change=s-this.begin,this.pause()}fire(e){var n=this[e];n&&n()}setTime(e){e>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():e<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=e,this.update())}getTime(){return this._time}setPosition(e){this.prevPos=this._pos,this.propFunc(e),this._pos=e}getPosition(e){return e===void 0&&(e=this._time),this.func(e,this.begin,this._change,this.duration)}play(){this.state=Pl,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=Ml,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(e){this.pause(),this._time=e,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){var e=this.getTimer()-this._startTime;this.state===Pl?this.setTime(e):this.state===Ml&&this.setTime(this.duration-e)}pause(){this.state=ay,this.fire("onPause")}getTimer(){return new Date().getTime()}}class Le{constructor(e){var n=this,i=e.node,r=i._id,s,o=e.easing||Wi.Linear,a=!!e.yoyo,l;typeof e.duration>"u"?s=.3:e.duration===0?s=.001:s=e.duration,this.node=i,this._id=ly++;var h=i.getLayer()||(i instanceof J.Stage?i.getLayers():null);h||T.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new mt(function(){n.tween.onEnterFrame()},h),this.tween=new hy(l,function(c){n._tweenFunc(c)},o,0,1,s*1e3,a),this._addListeners(),Le.attrs[r]||(Le.attrs[r]={}),Le.attrs[r][this._id]||(Le.attrs[r][this._id]={}),Le.tweens[r]||(Le.tweens[r]={});for(l in e)oy[l]===void 0&&this._addAttr(l,e[l]);this.reset(),this.onFinish=e.onFinish,this.onReset=e.onReset,this.onUpdate=e.onUpdate}_addAttr(e,n){var i=this.node,r=i._id,s,o,a,l,h,c,u,d;if(a=Le.tweens[r][e],a&&delete Le.attrs[r][a][e],s=i.getAttr(e),T._isArray(n))if(o=[],h=Math.max(n.length,s.length),e==="points"&&n.length!==s.length&&(n.length>s.length?(u=s,s=T._prepareArrayForTween(s,n,i.closed())):(c=n,n=T._prepareArrayForTween(n,s,i.closed()))),e.indexOf("fill")===0)for(l=0;l<h;l++)if(l%2===0)o.push(n[l]-s[l]);else{var p=T.colorToRGBA(s[l]);d=T.colorToRGBA(n[l]),s[l]=p,o.push({r:d.r-p.r,g:d.g-p.g,b:d.b-p.b,a:d.a-p.a})}else for(l=0;l<h;l++)o.push(n[l]-s[l]);else Ol.indexOf(e)!==-1?(s=T.colorToRGBA(s),d=T.colorToRGBA(n),o={r:d.r-s.r,g:d.g-s.g,b:d.b-s.b,a:d.a-s.a}):o=n-s;Le.attrs[r][this._id][e]={start:s,diff:o,end:n,trueEnd:c,trueStart:u},Le.tweens[r][e]=this._id}_tweenFunc(e){var n=this.node,i=Le.attrs[n._id][this._id],r,s,o,a,l,h,c,u;for(r in i){if(s=i[r],o=s.start,a=s.diff,u=s.end,T._isArray(o))if(l=[],c=Math.max(o.length,u.length),r.indexOf("fill")===0)for(h=0;h<c;h++)h%2===0?l.push((o[h]||0)+a[h]*e):l.push("rgba("+Math.round(o[h].r+a[h].r*e)+","+Math.round(o[h].g+a[h].g*e)+","+Math.round(o[h].b+a[h].b*e)+","+(o[h].a+a[h].a*e)+")");else for(h=0;h<c;h++)l.push((o[h]||0)+a[h]*e);else Ol.indexOf(r)!==-1?l="rgba("+Math.round(o.r+a.r*e)+","+Math.round(o.g+a.g*e)+","+Math.round(o.b+a.b*e)+","+(o.a+a.a*e)+")":l=o+a*e;n.setAttr(r,l)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{var e=this.node,n=Le.attrs[e._id][this._id];n.points&&n.points.trueEnd&&e.setAttr("points",n.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{var e=this.node,n=Le.attrs[e._id][this._id];n.points&&n.points.trueStart&&e.points(n.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(e){return this.tween.seek(e*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){var e=this.node._id,n=this._id,i=Le.tweens[e],r;this.pause();for(r in i)delete Le.tweens[e][r];delete Le.attrs[e][n]}}Le.attrs={};Le.tweens={};H.prototype.to=function(t){var e=t.onFinish;t.node=this,t.onFinish=function(){this.destroy(),e&&e()};var n=new Le(t);n.play()};const Wi={BackEaseIn(t,e,n,i){var r=1.70158;return n*(t/=i)*t*((r+1)*t-r)+e},BackEaseOut(t,e,n,i){var r=1.70158;return n*((t=t/i-1)*t*((r+1)*t+r)+1)+e},BackEaseInOut(t,e,n,i){var r=1.70158;return(t/=i/2)<1?n/2*(t*t*(((r*=1.525)+1)*t-r))+e:n/2*((t-=2)*t*(((r*=1.525)+1)*t+r)+2)+e},ElasticEaseIn(t,e,n,i,r,s){var o=0;return t===0?e:(t/=i)===1?e+n:(s||(s=i*.3),!r||r<Math.abs(n)?(r=n,o=s/4):o=s/(2*Math.PI)*Math.asin(n/r),-(r*Math.pow(2,10*(t-=1))*Math.sin((t*i-o)*(2*Math.PI)/s))+e)},ElasticEaseOut(t,e,n,i,r,s){var o=0;return t===0?e:(t/=i)===1?e+n:(s||(s=i*.3),!r||r<Math.abs(n)?(r=n,o=s/4):o=s/(2*Math.PI)*Math.asin(n/r),r*Math.pow(2,-10*t)*Math.sin((t*i-o)*(2*Math.PI)/s)+n+e)},ElasticEaseInOut(t,e,n,i,r,s){var o=0;return t===0?e:(t/=i/2)===2?e+n:(s||(s=i*(.3*1.5)),!r||r<Math.abs(n)?(r=n,o=s/4):o=s/(2*Math.PI)*Math.asin(n/r),t<1?-.5*(r*Math.pow(2,10*(t-=1))*Math.sin((t*i-o)*(2*Math.PI)/s))+e:r*Math.pow(2,-10*(t-=1))*Math.sin((t*i-o)*(2*Math.PI)/s)*.5+n+e)},BounceEaseOut(t,e,n,i){return(t/=i)<1/2.75?n*(7.5625*t*t)+e:t<2/2.75?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e},BounceEaseIn(t,e,n,i){return n-Wi.BounceEaseOut(i-t,0,n,i)+e},BounceEaseInOut(t,e,n,i){return t<i/2?Wi.BounceEaseIn(t*2,0,n,i)*.5+e:Wi.BounceEaseOut(t*2-i,0,n,i)*.5+n*.5+e},EaseIn(t,e,n,i){return n*(t/=i)*t+e},EaseOut(t,e,n,i){return-n*(t/=i)*(t-2)+e},EaseInOut(t,e,n,i){return(t/=i/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e},StrongEaseIn(t,e,n,i){return n*(t/=i)*t*t*t*t+e},StrongEaseOut(t,e,n,i){return n*((t=t/i-1)*t*t*t*t+1)+e},StrongEaseInOut(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t*t*t+e:n/2*((t-=2)*t*t*t*t+2)+e},Linear(t,e,n,i){return n*t/i+e}},Al=T._assign(J,{Util:T,Transform:ht,Node:H,Container:dt,Stage:Cs,stages:Br,Layer:Un,FastLayer:sa,Group:di,DD:me,Shape:F,shapes:ji,Animation:mt,Tween:Le,Easings:Wi,Context:bs,Canvas:ws});class qt extends F{_sceneFunc(e){var n=J.getAngle(this.angle()),i=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,n,i),e.arc(0,0,this.innerRadius(),n,0,!i),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){const e=this.innerRadius(),n=this.outerRadius(),i=this.clockwise(),r=J.getAngle(i?360-this.angle():this.angle()),s=Math.cos(Math.min(r,Math.PI)),o=1,a=Math.sin(Math.min(Math.max(Math.PI,r),3*Math.PI/2)),l=Math.sin(Math.min(r,Math.PI/2)),h=s*(s>0?e:n),c=o*n,u=a*(a>0?e:n),d=l*(l>0?n:e);return{x:h,y:i?-1*d:u,width:c-h,height:d-u}}}qt.prototype._centroid=!0;qt.prototype.className="Arc";qt.prototype._attrsAffectingSize=["innerRadius","outerRadius"];Ae(qt);b.addGetterSetter(qt,"innerRadius",0,U());b.addGetterSetter(qt,"outerRadius",0,U());b.addGetterSetter(qt,"angle",0,U());b.addGetterSetter(qt,"clockwise",!1,Mt());function mo(t,e,n,i,r,s,o){var a=Math.sqrt(Math.pow(n-t,2)+Math.pow(i-e,2)),l=Math.sqrt(Math.pow(r-n,2)+Math.pow(s-i,2)),h=o*a/(a+l),c=o*l/(a+l),u=n-h*(r-t),d=i-h*(s-e),p=n+c*(r-t),f=i+c*(s-e);return[u,d,p,f]}function Il(t,e){var n=t.length,i=[],r,s;for(r=2;r<n-2;r+=2)s=mo(t[r-2],t[r-1],t[r],t[r+1],t[r+2],t[r+3],e),!isNaN(s[0])&&(i.push(s[0]),i.push(s[1]),i.push(t[r]),i.push(t[r+1]),i.push(s[2]),i.push(s[3]));return i}class Jt extends F{constructor(e){super(e),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(e){var n=this.points(),i=n.length,r=this.tension(),s=this.closed(),o=this.bezier(),a,l,h;if(i){if(e.beginPath(),e.moveTo(n[0],n[1]),r!==0&&i>4){for(a=this.getTensionPoints(),l=a.length,h=s?0:4,s||e.quadraticCurveTo(a[0],a[1],a[2],a[3]);h<l-2;)e.bezierCurveTo(a[h++],a[h++],a[h++],a[h++],a[h++],a[h++]);s||e.quadraticCurveTo(a[l-2],a[l-1],n[i-2],n[i-1])}else if(o)for(h=2;h<i;)e.bezierCurveTo(n[h++],n[h++],n[h++],n[h++],n[h++],n[h++]);else for(h=2;h<i;h+=2)e.lineTo(n[h],n[h+1]);s?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():Il(this.points(),this.tension())}_getTensionPointsClosed(){var e=this.points(),n=e.length,i=this.tension(),r=mo(e[n-2],e[n-1],e[0],e[1],e[2],e[3],i),s=mo(e[n-4],e[n-3],e[n-2],e[n-1],e[0],e[1],i),o=Il(e,i),a=[r[2],r[3]].concat(o).concat([s[0],s[1],e[n-2],e[n-1],s[2],s[3],r[0],r[1],e[0],e[1]]);return a}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){var e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};this.tension()!==0?e=[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:e=this.points();for(var n=e[0],i=e[0],r=e[1],s=e[1],o,a,l=0;l<e.length/2;l++)o=e[l*2],a=e[l*2+1],n=Math.min(n,o),i=Math.max(i,o),r=Math.min(r,a),s=Math.max(s,a);return{x:n,y:r,width:i-n,height:s-r}}}Jt.prototype.className="Line";Jt.prototype._attrsAffectingSize=["points","bezier","tension"];Ae(Jt);b.addGetterSetter(Jt,"closed",!1);b.addGetterSetter(Jt,"bezier",!1);b.addGetterSetter(Jt,"tension",0,U());b.addGetterSetter(Jt,"points",[],y_());class we extends F{constructor(e){super(e),this.dataArray=[],this.pathLength=0,this.dataArray=we.parsePathData(this.data()),this.pathLength=0;for(var n=0;n<this.dataArray.length;++n)this.pathLength+=this.dataArray[n].pathLength;this.on("dataChange.konva",function(){this.dataArray=we.parsePathData(this.data()),this.pathLength=0;for(var i=0;i<this.dataArray.length;++i)this.pathLength+=this.dataArray[i].pathLength})}_sceneFunc(e){var n=this.dataArray;e.beginPath();for(var i=!1,r=0;r<n.length;r++){var s=n[r].command,o=n[r].points;switch(s){case"L":e.lineTo(o[0],o[1]);break;case"M":e.moveTo(o[0],o[1]);break;case"C":e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]);break;case"Q":e.quadraticCurveTo(o[0],o[1],o[2],o[3]);break;case"A":var a=o[0],l=o[1],h=o[2],c=o[3],u=o[4],d=o[5],p=o[6],f=o[7],v=h>c?h:c,_=h>c?1:h/c,y=h>c?c/h:1;e.translate(a,l),e.rotate(p),e.scale(_,y),e.arc(0,0,v,u,u+d,1-f),e.scale(1/_,1/y),e.rotate(-p),e.translate(-a,-l);break;case"z":i=!0,e.closePath();break}}!i&&!this.hasFill()?e.strokeShape(this):e.fillStrokeShape(this)}getSelfRect(){var e=[];this.dataArray.forEach(function(h){if(h.command==="A"){var c=h.points[4],u=h.points[5],d=h.points[4]+u,p=Math.PI/180;if(Math.abs(c-d)<p&&(p=Math.abs(c-d)),u<0)for(let f=c-p;f>d;f-=p){const v=we.getPointOnEllipticalArc(h.points[0],h.points[1],h.points[2],h.points[3],f,0);e.push(v.x,v.y)}else for(let f=c+p;f<d;f+=p){const v=we.getPointOnEllipticalArc(h.points[0],h.points[1],h.points[2],h.points[3],f,0);e.push(v.x,v.y)}}else if(h.command==="C")for(let f=0;f<=1;f+=.01){const v=we.getPointOnCubicBezier(f,h.start.x,h.start.y,h.points[0],h.points[1],h.points[2],h.points[3],h.points[4],h.points[5]);e.push(v.x,v.y)}else e=e.concat(h.points)});for(var n=e[0],i=e[0],r=e[1],s=e[1],o,a,l=0;l<e.length/2;l++)o=e[l*2],a=e[l*2+1],isNaN(o)||(n=Math.min(n,o),i=Math.max(i,o)),isNaN(a)||(r=Math.min(r,a),s=Math.max(s,a));return{x:n,y:r,width:i-n,height:s-r}}getLength(){return this.pathLength}getPointAtLength(e){var n,i=0,r=this.dataArray.length;if(!r)return null;for(;i<r&&e>this.dataArray[i].pathLength;)e-=this.dataArray[i].pathLength,++i;if(i===r)return n=this.dataArray[i-1].points.slice(-2),{x:n[0],y:n[1]};if(e<.01)return n=this.dataArray[i].points.slice(0,2),{x:n[0],y:n[1]};var s=this.dataArray[i],o=s.points;switch(s.command){case"L":return we.getPointOnLine(e,s.start.x,s.start.y,o[0],o[1]);case"C":return we.getPointOnCubicBezier(e/s.pathLength,s.start.x,s.start.y,o[0],o[1],o[2],o[3],o[4],o[5]);case"Q":return we.getPointOnQuadraticBezier(e/s.pathLength,s.start.x,s.start.y,o[0],o[1],o[2],o[3]);case"A":var a=o[0],l=o[1],h=o[2],c=o[3],u=o[4],d=o[5],p=o[6];return u+=d*e/s.pathLength,we.getPointOnEllipticalArc(a,l,h,c,u,p)}return null}static getLineLength(e,n,i,r){return Math.sqrt((i-e)*(i-e)+(r-n)*(r-n))}static getPointOnLine(e,n,i,r,s,o,a){o===void 0&&(o=n),a===void 0&&(a=i);var l=(s-i)/(r-n+1e-8),h=Math.sqrt(e*e/(1+l*l));r<n&&(h*=-1);var c=l*h,u;if(r===n)u={x:o,y:a+c};else if((a-i)/(o-n+1e-8)===l)u={x:o+h,y:a+c};else{var d,p,f=this.getLineLength(n,i,r,s),v=(o-n)*(r-n)+(a-i)*(s-i);v=v/(f*f),d=n+v*(r-n),p=i+v*(s-i);var _=this.getLineLength(o,a,d,p),y=Math.sqrt(e*e-_*_);h=Math.sqrt(y*y/(1+l*l)),r<n&&(h*=-1),c=l*h,u={x:d+h,y:p+c}}return u}static getPointOnCubicBezier(e,n,i,r,s,o,a,l,h){function c(_){return _*_*_}function u(_){return 3*_*_*(1-_)}function d(_){return 3*_*(1-_)*(1-_)}function p(_){return(1-_)*(1-_)*(1-_)}var f=l*c(e)+o*u(e)+r*d(e)+n*p(e),v=h*c(e)+a*u(e)+s*d(e)+i*p(e);return{x:f,y:v}}static getPointOnQuadraticBezier(e,n,i,r,s,o,a){function l(p){return p*p}function h(p){return 2*p*(1-p)}function c(p){return(1-p)*(1-p)}var u=o*l(e)+r*h(e)+n*c(e),d=a*l(e)+s*h(e)+i*c(e);return{x:u,y:d}}static getPointOnEllipticalArc(e,n,i,r,s,o){var a=Math.cos(o),l=Math.sin(o),h={x:i*Math.cos(s),y:r*Math.sin(s)};return{x:e+(h.x*a-h.y*l),y:n+(h.x*l+h.y*a)}}static parsePathData(e){if(!e)return[];var n=e,i=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];n=n.replace(new RegExp(" ","g"),",");for(var r=0;r<i.length;r++)n=n.replace(new RegExp(i[r],"g"),"|"+i[r]);var s=n.split("|"),o=[],a=[],l=0,h=0,c=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,u;for(r=1;r<s.length;r++){var d=s[r],p=d.charAt(0);for(d=d.slice(1),a.length=0;u=c.exec(d);)a.push(u[0]);for(var f=[],v=0,_=a.length;v<_;v++){if(a[v]==="00"){f.push(0,0);continue}var y=parseFloat(a[v]);isNaN(y)?f.push(0):f.push(y)}for(;f.length>0&&!isNaN(f[0]);){var g=null,m=[],S=l,P=h,k,x,C,M,I,N,D,A,O,V;switch(p){case"l":l+=f.shift(),h+=f.shift(),g="L",m.push(l,h);break;case"L":l=f.shift(),h=f.shift(),m.push(l,h);break;case"m":var $=f.shift(),K=f.shift();if(l+=$,h+=K,g="M",o.length>2&&o[o.length-1].command==="z"){for(var ie=o.length-2;ie>=0;ie--)if(o[ie].command==="M"){l=o[ie].points[0]+$,h=o[ie].points[1]+K;break}}m.push(l,h),p="l";break;case"M":l=f.shift(),h=f.shift(),g="M",m.push(l,h),p="L";break;case"h":l+=f.shift(),g="L",m.push(l,h);break;case"H":l=f.shift(),g="L",m.push(l,h);break;case"v":h+=f.shift(),g="L",m.push(l,h);break;case"V":h=f.shift(),g="L",m.push(l,h);break;case"C":m.push(f.shift(),f.shift(),f.shift(),f.shift()),l=f.shift(),h=f.shift(),m.push(l,h);break;case"c":m.push(l+f.shift(),h+f.shift(),l+f.shift(),h+f.shift()),l+=f.shift(),h+=f.shift(),g="C",m.push(l,h);break;case"S":x=l,C=h,k=o[o.length-1],k.command==="C"&&(x=l+(l-k.points[2]),C=h+(h-k.points[3])),m.push(x,C,f.shift(),f.shift()),l=f.shift(),h=f.shift(),g="C",m.push(l,h);break;case"s":x=l,C=h,k=o[o.length-1],k.command==="C"&&(x=l+(l-k.points[2]),C=h+(h-k.points[3])),m.push(x,C,l+f.shift(),h+f.shift()),l+=f.shift(),h+=f.shift(),g="C",m.push(l,h);break;case"Q":m.push(f.shift(),f.shift()),l=f.shift(),h=f.shift(),m.push(l,h);break;case"q":m.push(l+f.shift(),h+f.shift()),l+=f.shift(),h+=f.shift(),g="Q",m.push(l,h);break;case"T":x=l,C=h,k=o[o.length-1],k.command==="Q"&&(x=l+(l-k.points[0]),C=h+(h-k.points[1])),l=f.shift(),h=f.shift(),g="Q",m.push(x,C,l,h);break;case"t":x=l,C=h,k=o[o.length-1],k.command==="Q"&&(x=l+(l-k.points[0]),C=h+(h-k.points[1])),l+=f.shift(),h+=f.shift(),g="Q",m.push(x,C,l,h);break;case"A":M=f.shift(),I=f.shift(),N=f.shift(),D=f.shift(),A=f.shift(),O=l,V=h,l=f.shift(),h=f.shift(),g="A",m=this.convertEndpointToCenterParameterization(O,V,l,h,D,A,M,I,N);break;case"a":M=f.shift(),I=f.shift(),N=f.shift(),D=f.shift(),A=f.shift(),O=l,V=h,l+=f.shift(),h+=f.shift(),g="A",m=this.convertEndpointToCenterParameterization(O,V,l,h,D,A,M,I,N);break}o.push({command:g||p,points:m,start:{x:S,y:P},pathLength:this.calcLength(S,P,g||p,m)})}(p==="z"||p==="Z")&&o.push({command:"z",points:[],start:void 0,pathLength:0})}return o}static calcLength(e,n,i,r){var s,o,a,l,h=we;switch(i){case"L":return h.getLineLength(e,n,r[0],r[1]);case"C":for(s=0,o=h.getPointOnCubicBezier(0,e,n,r[0],r[1],r[2],r[3],r[4],r[5]),l=.01;l<=1;l+=.01)a=h.getPointOnCubicBezier(l,e,n,r[0],r[1],r[2],r[3],r[4],r[5]),s+=h.getLineLength(o.x,o.y,a.x,a.y),o=a;return s;case"Q":for(s=0,o=h.getPointOnQuadraticBezier(0,e,n,r[0],r[1],r[2],r[3]),l=.01;l<=1;l+=.01)a=h.getPointOnQuadraticBezier(l,e,n,r[0],r[1],r[2],r[3]),s+=h.getLineLength(o.x,o.y,a.x,a.y),o=a;return s;case"A":s=0;var c=r[4],u=r[5],d=r[4]+u,p=Math.PI/180;if(Math.abs(c-d)<p&&(p=Math.abs(c-d)),o=h.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],c,0),u<0)for(l=c-p;l>d;l-=p)a=h.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],l,0),s+=h.getLineLength(o.x,o.y,a.x,a.y),o=a;else for(l=c+p;l<d;l+=p)a=h.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],l,0),s+=h.getLineLength(o.x,o.y,a.x,a.y),o=a;return a=h.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],d,0),s+=h.getLineLength(o.x,o.y,a.x,a.y),s}return 0}static convertEndpointToCenterParameterization(e,n,i,r,s,o,a,l,h){var c=h*(Math.PI/180),u=Math.cos(c)*(e-i)/2+Math.sin(c)*(n-r)/2,d=-1*Math.sin(c)*(e-i)/2+Math.cos(c)*(n-r)/2,p=u*u/(a*a)+d*d/(l*l);p>1&&(a*=Math.sqrt(p),l*=Math.sqrt(p));var f=Math.sqrt((a*a*(l*l)-a*a*(d*d)-l*l*(u*u))/(a*a*(d*d)+l*l*(u*u)));s===o&&(f*=-1),isNaN(f)&&(f=0);var v=f*a*d/l,_=f*-l*u/a,y=(e+i)/2+Math.cos(c)*v-Math.sin(c)*_,g=(n+r)/2+Math.sin(c)*v+Math.cos(c)*_,m=function(I){return Math.sqrt(I[0]*I[0]+I[1]*I[1])},S=function(I,N){return(I[0]*N[0]+I[1]*N[1])/(m(I)*m(N))},P=function(I,N){return(I[0]*N[1]<I[1]*N[0]?-1:1)*Math.acos(S(I,N))},k=P([1,0],[(u-v)/a,(d-_)/l]),x=[(u-v)/a,(d-_)/l],C=[(-1*u-v)/a,(-1*d-_)/l],M=P(x,C);return S(x,C)<=-1&&(M=Math.PI),S(x,C)>=1&&(M=0),o===0&&M>0&&(M=M-2*Math.PI),o===1&&M<0&&(M=M+2*Math.PI),[y,g,a,l,k,M,c,o]}}we.prototype.className="Path";we.prototype._attrsAffectingSize=["data"];Ae(we);b.addGetterSetter(we,"data");class jn extends Jt{_sceneFunc(e){super._sceneFunc(e);var n=Math.PI*2,i=this.points(),r=i,s=this.tension()!==0&&i.length>4;s&&(r=this.getTensionPoints());var o=this.pointerLength(),a=i.length,l,h;if(s){const d=[r[r.length-4],r[r.length-3],r[r.length-2],r[r.length-1],i[a-2],i[a-1]],p=we.calcLength(r[r.length-4],r[r.length-3],"C",d),f=we.getPointOnQuadraticBezier(Math.min(1,1-o/p),d[0],d[1],d[2],d[3],d[4],d[5]);l=i[a-2]-f.x,h=i[a-1]-f.y}else l=i[a-2]-i[a-4],h=i[a-1]-i[a-3];var c=(Math.atan2(h,l)+n)%n,u=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(i[a-2],i[a-1]),e.rotate(c),e.moveTo(0,0),e.lineTo(-o,u/2),e.lineTo(-o,-u/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(i[0],i[1]),s?(l=(r[0]+r[2])/2-i[0],h=(r[1]+r[3])/2-i[1]):(l=i[2]-i[0],h=i[3]-i[1]),e.rotate((Math.atan2(-h,-l)+n)%n),e.moveTo(0,0),e.lineTo(-o,u/2),e.lineTo(-o,-u/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){var n=this.dashEnabled();n&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),n&&(this.attrs.dashEnabled=!0)}getSelfRect(){const e=super.getSelfRect(),n=this.pointerWidth()/2;return{x:e.x-n,y:e.y-n,width:e.width+n*2,height:e.height+n*2}}}jn.prototype.className="Arrow";Ae(jn);b.addGetterSetter(jn,"pointerLength",10,U());b.addGetterSetter(jn,"pointerWidth",10,U());b.addGetterSetter(jn,"pointerAtBeginning",!1);b.addGetterSetter(jn,"pointerAtEnding",!0);class bi extends F{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}}bi.prototype._centroid=!0;bi.prototype.className="Circle";bi.prototype._attrsAffectingSize=["radius"];Ae(bi);b.addGetterSetter(bi,"radius",0,U());class yn extends F{_sceneFunc(e){var n=this.radiusX(),i=this.radiusY();e.beginPath(),e.save(),n!==i&&e.scale(1,i/n),e.arc(0,0,n,0,Math.PI*2,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}}yn.prototype.className="Ellipse";yn.prototype._centroid=!0;yn.prototype._attrsAffectingSize=["radiusX","radiusY"];Ae(yn);b.addComponentsGetterSetter(yn,"radius",["x","y"]);b.addGetterSetter(yn,"radiusX",0,U());b.addGetterSetter(yn,"radiusY",0,U());class yt extends F{constructor(e){super(e),this.on("imageChange.konva",()=>{this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const e=this.image();e&&e.complete||e&&e.readyState===4||e&&e.addEventListener&&e.addEventListener("load",()=>{this._requestDraw()})}_useBufferCanvas(){return super._useBufferCanvas(!0)}_sceneFunc(e){const n=this.getWidth(),i=this.getHeight(),r=this.cornerRadius(),s=this.attrs.image;let o;if(s){const a=this.attrs.cropWidth,l=this.attrs.cropHeight;a&&l?o=[s,this.cropX(),this.cropY(),a,l,0,0,n,i]:o=[s,0,0,n,i]}(this.hasFill()||this.hasStroke()||r)&&(e.beginPath(),r?T.drawRoundedRectPath(e,n,i,r):e.rect(0,0,n,i),e.closePath(),e.fillStrokeShape(this)),s&&(r&&e.clip(),e.drawImage.apply(e,o))}_hitFunc(e){var n=this.width(),i=this.height(),r=this.cornerRadius();e.beginPath(),r?T.drawRoundedRectPath(e,n,i,r):e.rect(0,0,n,i),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,n;return(e=this.attrs.width)!==null&&e!==void 0?e:(n=this.image())===null||n===void 0?void 0:n.width}getHeight(){var e,n;return(e=this.attrs.height)!==null&&e!==void 0?e:(n=this.image())===null||n===void 0?void 0:n.height}static fromURL(e,n,i=null){var r=T.createImageElement();r.onload=function(){var s=new yt({image:r});n(s)},r.onerror=i,r.crossOrigin="Anonymous",r.src=e}}yt.prototype.className="Image";Ae(yt);b.addGetterSetter(yt,"cornerRadius",0,ta(4));b.addGetterSetter(yt,"image");b.addComponentsGetterSetter(yt,"crop",["x","y","width","height"]);b.addGetterSetter(yt,"cropX",0,U());b.addGetterSetter(yt,"cropY",0,U());b.addGetterSetter(yt,"cropWidth",0,U());b.addGetterSetter(yt,"cropHeight",0,U());var hu=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],cy="Change.konva",uy="none",_o="up",yo="right",bo="down",wo="left",dy=hu.length;class oa extends di{constructor(e){super(e),this.on("add.konva",function(n){this._addListeners(n.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(e){var n=this,i,r=function(){n._sync()};for(i=0;i<dy;i++)e.on(hu[i]+cy,r)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){var e=this.getText(),n=this.getTag(),i,r,s,o,a,l,h;if(e&&n){switch(i=e.width(),r=e.height(),s=n.pointerDirection(),o=n.pointerWidth(),h=n.pointerHeight(),a=0,l=0,s){case _o:a=i/2,l=-1*h;break;case yo:a=i+o,l=r/2;break;case bo:a=i/2,l=r+h;break;case wo:a=-1*o,l=r/2;break}n.setAttrs({x:-1*a,y:-1*l,width:i,height:r}),e.setAttrs({x:-1*a,y:-1*l})}}}oa.prototype.className="Label";Ae(oa);class Wn extends F{_sceneFunc(e){var n=this.width(),i=this.height(),r=this.pointerDirection(),s=this.pointerWidth(),o=this.pointerHeight(),a=this.cornerRadius();let l=0,h=0,c=0,u=0;typeof a=="number"?l=h=c=u=Math.min(a,n/2,i/2):(l=Math.min(a[0]||0,n/2,i/2),h=Math.min(a[1]||0,n/2,i/2),u=Math.min(a[2]||0,n/2,i/2),c=Math.min(a[3]||0,n/2,i/2)),e.beginPath(),e.moveTo(l,0),r===_o&&(e.lineTo((n-s)/2,0),e.lineTo(n/2,-1*o),e.lineTo((n+s)/2,0)),e.lineTo(n-h,0),e.arc(n-h,h,h,Math.PI*3/2,0,!1),r===yo&&(e.lineTo(n,(i-o)/2),e.lineTo(n+s,i/2),e.lineTo(n,(i+o)/2)),e.lineTo(n,i-u),e.arc(n-u,i-u,u,0,Math.PI/2,!1),r===bo&&(e.lineTo((n+s)/2,i),e.lineTo(n/2,i+o),e.lineTo((n-s)/2,i)),e.lineTo(c,i),e.arc(c,i-c,c,Math.PI/2,Math.PI,!1),r===wo&&(e.lineTo(0,(i+o)/2),e.lineTo(-1*s,i/2),e.lineTo(0,(i-o)/2)),e.lineTo(0,l),e.arc(l,l,l,Math.PI,Math.PI*3/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){var e=0,n=0,i=this.pointerWidth(),r=this.pointerHeight(),s=this.pointerDirection(),o=this.width(),a=this.height();return s===_o?(n-=r,a+=r):s===bo?a+=r:s===wo?(e-=i*1.5,o+=i):s===yo&&(o+=i*1.5),{x:e,y:n,width:o,height:a}}}Wn.prototype.className="Tag";Ae(Wn);b.addGetterSetter(Wn,"pointerDirection",uy);b.addGetterSetter(Wn,"pointerWidth",0,U());b.addGetterSetter(Wn,"pointerHeight",0,U());b.addGetterSetter(Wn,"cornerRadius",0,ta(4));class ur extends F{_sceneFunc(e){var n=this.cornerRadius(),i=this.width(),r=this.height();e.beginPath(),n?T.drawRoundedRectPath(e,i,r,n):e.rect(0,0,i,r),e.closePath(),e.fillStrokeShape(this)}}ur.prototype.className="Rect";Ae(ur);b.addGetterSetter(ur,"cornerRadius",0,ta(4));class zn extends F{_sceneFunc(e){const n=this._getPoints();e.beginPath(),e.moveTo(n[0].x,n[0].y);for(var i=1;i<n.length;i++)e.lineTo(n[i].x,n[i].y);e.closePath(),e.fillStrokeShape(this)}_getPoints(){const e=this.attrs.sides,n=this.attrs.radius||0,i=[];for(var r=0;r<e;r++)i.push({x:n*Math.sin(r*2*Math.PI/e),y:-1*n*Math.cos(r*2*Math.PI/e)});return i}getSelfRect(){const e=this._getPoints();var n=e[0].x,i=e[0].y,r=e[0].x,s=e[0].y;return e.forEach(o=>{n=Math.min(n,o.x),i=Math.max(i,o.x),r=Math.min(r,o.y),s=Math.max(s,o.y)}),{x:n,y:r,width:i-n,height:s-r}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}zn.prototype.className="RegularPolygon";zn.prototype._centroid=!0;zn.prototype._attrsAffectingSize=["radius"];Ae(zn);b.addGetterSetter(zn,"radius",0,U());b.addGetterSetter(zn,"sides",0,U());var Rl=Math.PI*2;class Vn extends F{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,Rl,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),Rl,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}Vn.prototype.className="Ring";Vn.prototype._centroid=!0;Vn.prototype._attrsAffectingSize=["innerRadius","outerRadius"];Ae(Vn);b.addGetterSetter(Vn,"innerRadius",0,U());b.addGetterSetter(Vn,"outerRadius",0,U());class $t extends F{constructor(e){super(e),this._updated=!0,this.anim=new mt(()=>{var n=this._updated;return this._updated=!1,n}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(e){var n=this.animation(),i=this.frameIndex(),r=i*4,s=this.animations()[n],o=this.frameOffsets(),a=s[r+0],l=s[r+1],h=s[r+2],c=s[r+3],u=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,h,c),e.closePath(),e.fillStrokeShape(this)),u)if(o){var d=o[n],p=i*2;e.drawImage(u,a,l,h,c,d[p+0],d[p+1],h,c)}else e.drawImage(u,a,l,h,c,0,0,h,c)}_hitFunc(e){var n=this.animation(),i=this.frameIndex(),r=i*4,s=this.animations()[n],o=this.frameOffsets(),a=s[r+2],l=s[r+3];if(e.beginPath(),o){var h=o[n],c=i*2;e.rect(h[c+0],h[c+1],a,l)}else e.rect(0,0,a,l);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){var e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.frameRate())}start(){if(!this.isRunning()){var e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){var e=this.frameIndex(),n=this.animation(),i=this.animations(),r=i[n],s=r.length/4;e<s-1?this.frameIndex(e+1):this.frameIndex(0)}}$t.prototype.className="Sprite";Ae($t);b.addGetterSetter($t,"animation");b.addGetterSetter($t,"animations");b.addGetterSetter($t,"frameOffsets");b.addGetterSetter($t,"image");b.addGetterSetter($t,"frameIndex",0,U());b.addGetterSetter($t,"frameRate",17,U());b.backCompat($t,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});class bn extends F{_sceneFunc(e){var n=this.innerRadius(),i=this.outerRadius(),r=this.numPoints();e.beginPath(),e.moveTo(0,0-i);for(var s=1;s<r*2;s++){var o=s%2===0?i:n,a=o*Math.sin(s*Math.PI/r),l=-1*o*Math.cos(s*Math.PI/r);e.lineTo(a,l)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}bn.prototype.className="Star";bn.prototype._centroid=!0;bn.prototype._attrsAffectingSize=["innerRadius","outerRadius"];Ae(bn);b.addGetterSetter(bn,"numPoints",5,U());b.addGetterSetter(bn,"innerRadius",0,U());b.addGetterSetter(bn,"outerRadius",0,U());function cu(t){return Array.from(t)}var qn="auto",fy="center",ki="justify",py="Change.konva",gy="2d",Nl="-",uu="left",vy="text",my="Text",_y="top",yy="bottom",Dl="middle",du="normal",by="px ",Rr=" ",wy="right",Cy="word",Sy="char",Ll="none",Gs="",fu=["fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],xy=fu.length;function Ey(t){return t.split(",").map(e=>{e=e.trim();const n=e.indexOf(" ")>=0,i=e.indexOf('"')>=0||e.indexOf("'")>=0;return n&&!i&&(e=`"${e}"`),e}).join(", ")}var Nr;function Fs(){return Nr||(Nr=T.createCanvasElement().getContext(gy),Nr)}function Ty(t){t.fillText(this._partialText,this._partialTextX,this._partialTextY)}function ky(t){t.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function Py(t){return t=t||{},!t.fillLinearGradientColorStops&&!t.fillRadialGradientColorStops&&!t.fillPatternImage&&(t.fill=t.fill||"black"),t}class Oe extends F{constructor(e){super(Py(e)),this._partialTextX=0,this._partialTextY=0;for(var n=0;n<xy;n++)this.on(fu[n]+py,this._setTextData);this._setTextData()}_sceneFunc(e){var n=this.textArr,i=n.length;if(this.text()){var r=this.padding(),s=this.fontSize(),o=this.lineHeight()*s,a=this.verticalAlign(),l=0,h=this.align(),c=this.getWidth(),u=this.letterSpacing(),d=this.fill(),p=this.textDecoration(),f=p.indexOf("underline")!==-1,v=p.indexOf("line-through")!==-1,_,y=0,y=o/2,g=0,m=0;for(e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",Dl),e.setAttr("textAlign",uu),a===Dl?l=(this.getHeight()-i*o-r*2)/2:a===yy&&(l=this.getHeight()-i*o-r*2),e.translate(r,l+r),_=0;_<i;_++){var g=0,m=0,S=n[_],P=S.text,k=S.width,x=S.lastInParagraph,C,M,I;if(e.save(),h===wy?g+=c-k-r*2:h===fy&&(g+=(c-k-r*2)/2),f){e.save(),e.beginPath(),e.moveTo(g,y+m+Math.round(s/2)),C=P.split(" ").length-1,M=C===0,I=h===ki&&!x?c-r*2:k,e.lineTo(g+Math.round(I),y+m+Math.round(s/2)),e.lineWidth=s/15;const $=this._getLinearGradient();e.strokeStyle=$||d,e.stroke(),e.restore()}if(v){e.save(),e.beginPath(),e.moveTo(g,y+m),C=P.split(" ").length-1,M=C===0,I=h===ki&&x&&!M?c-r*2:k,e.lineTo(g+Math.round(I),y+m),e.lineWidth=s/15;const $=this._getLinearGradient();e.strokeStyle=$||d,e.stroke(),e.restore()}if(u!==0||h===ki){C=P.split(" ").length-1;for(var N=cu(P),D=0;D<N.length;D++){var A=N[D];A===" "&&!x&&h===ki&&(g+=(c-r*2-k)/C),this._partialTextX=g,this._partialTextY=y+m,this._partialText=A,e.fillStrokeShape(this),g+=this.measureSize(A).width+u}}else this._partialTextX=g,this._partialTextY=y+m,this._partialText=P,e.fillStrokeShape(this);e.restore(),i>1&&(y+=o)}}}_hitFunc(e){var n=this.getWidth(),i=this.getHeight();e.beginPath(),e.rect(0,0,n,i),e.closePath(),e.fillStrokeShape(this)}setText(e){var n=T._isString(e)?e:e==null?"":e+"";return this._setAttr(vy,n),this}getWidth(){var e=this.attrs.width===qn||this.attrs.width===void 0;return e?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){var e=this.attrs.height===qn||this.attrs.height===void 0;return e?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return T.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var n=Fs(),i=this.fontSize(),r;return n.save(),n.font=this._getContextFont(),r=n.measureText(e),n.restore(),{width:r.width,height:i}}_getContextFont(){return this.fontStyle()+Rr+this.fontVariant()+Rr+(this.fontSize()+by)+Ey(this.fontFamily())}_addTextLine(e){this.align()===ki&&(e=e.trim());var i=this._getTextWidth(e);return this.textArr.push({text:e,width:i,lastInParagraph:!1})}_getTextWidth(e){var n=this.letterSpacing(),i=e.length;return Fs().measureText(e).width+(i?n*(i-1):0)}_setTextData(){var e=this.text().split(`
`),n=+this.fontSize(),i=0,r=this.lineHeight()*n,s=this.attrs.width,o=this.attrs.height,a=s!==qn&&s!==void 0,l=o!==qn&&o!==void 0,h=this.padding(),c=s-h*2,u=o-h*2,d=0,p=this.wrap(),f=p!==Ll,v=p!==Sy&&f,_=this.ellipsis();this.textArr=[],Fs().font=this._getContextFont();for(var y=_?this._getTextWidth(Gs):0,g=0,m=e.length;g<m;++g){var S=e[g],P=this._getTextWidth(S);if(a&&P>c)for(;S.length>0;){for(var k=0,x=S.length,C="",M=0;k<x;){var I=k+x>>>1,N=S.slice(0,I+1),D=this._getTextWidth(N)+y;D<=c?(k=I+1,C=N,M=D):x=I}if(C){if(v){var A,O=S[C.length],V=O===Rr||O===Nl;V&&M<=c?A=C.length:A=Math.max(C.lastIndexOf(Rr),C.lastIndexOf(Nl))+1,A>0&&(k=A,C=C.slice(0,k),M=this._getTextWidth(C))}C=C.trimRight(),this._addTextLine(C),i=Math.max(i,M),d+=r;var $=this._shouldHandleEllipsis(d);if($){this._tryToAddEllipsisToLastLine();break}if(S=S.slice(k),S=S.trimLeft(),S.length>0&&(P=this._getTextWidth(S),P<=c)){this._addTextLine(S),d+=r,i=Math.max(i,P);break}}else break}else this._addTextLine(S),d+=r,i=Math.max(i,P),this._shouldHandleEllipsis(d)&&g<m-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),l&&d+r>u)break}this.textHeight=n,this.textWidth=i}_shouldHandleEllipsis(e){var n=+this.fontSize(),i=this.lineHeight()*n,r=this.attrs.height,s=r!==qn&&r!==void 0,o=this.padding(),a=r-o*2,l=this.wrap(),h=l!==Ll;return!h||s&&e+i>a}_tryToAddEllipsisToLastLine(){var e=this.attrs.width,n=e!==qn&&e!==void 0,i=this.padding(),r=e-i*2,s=this.ellipsis(),o=this.textArr[this.textArr.length-1];if(!(!o||!s)){if(n){var a=this._getTextWidth(o.text+Gs)<r;a||(o.text=o.text.slice(0,o.text.length-3))}this.textArr.splice(this.textArr.length-1,1),this._addTextLine(o.text+Gs)}}getStrokeScaleEnabled(){return!0}}Oe.prototype._fillFunc=Ty;Oe.prototype._strokeFunc=ky;Oe.prototype.className=my;Oe.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];Ae(Oe);b.overWriteSetter(Oe,"width",na());b.overWriteSetter(Oe,"height",na());b.addGetterSetter(Oe,"fontFamily","Arial");b.addGetterSetter(Oe,"fontSize",12,U());b.addGetterSetter(Oe,"fontStyle",du);b.addGetterSetter(Oe,"fontVariant",du);b.addGetterSetter(Oe,"padding",0,U());b.addGetterSetter(Oe,"align",uu);b.addGetterSetter(Oe,"verticalAlign",_y);b.addGetterSetter(Oe,"lineHeight",1,U());b.addGetterSetter(Oe,"wrap",Cy);b.addGetterSetter(Oe,"ellipsis",!1,Mt());b.addGetterSetter(Oe,"letterSpacing",0,U());b.addGetterSetter(Oe,"text","",yi());b.addGetterSetter(Oe,"textDecoration","");var My="",pu="normal";function gu(t){t.fillText(this.partialText,0,0)}function vu(t){t.strokeText(this.partialText,0,0)}class He extends F{constructor(e){super(e),this.dummyCanvas=T.createCanvasElement(),this.dataArray=[],this.dataArray=we.parsePathData(this.attrs.data),this.on("dataChange.konva",function(){this.dataArray=we.parsePathData(this.attrs.data),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();var n=this.textDecoration(),i=this.fill(),r=this.fontSize(),s=this.glyphInfo;n==="underline"&&e.beginPath();for(var o=0;o<s.length;o++){e.save();var a=s[o].p0;e.translate(a.x,a.y),e.rotate(s[o].rotation),this.partialText=s[o].text,e.fillStrokeShape(this),n==="underline"&&(o===0&&e.moveTo(0,r/2+1),e.lineTo(r,r/2+1)),e.restore()}n==="underline"&&(e.strokeStyle=i,e.lineWidth=r/20,e.stroke()),e.restore()}_hitFunc(e){e.beginPath();var n=this.glyphInfo;if(n.length>=1){var i=n[0].p0;e.moveTo(i.x,i.y)}for(var r=0;r<n.length;r++){var s=n[r].p1;e.lineTo(s.x,s.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return T.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return Oe.prototype.setText.call(this,e)}_getContextFont(){return Oe.prototype._getContextFont.call(this)}_getTextSize(e){var n=this.dummyCanvas,i=n.getContext("2d");i.save(),i.font=this._getContextFont();var r=i.measureText(e);return i.restore(),{width:r.width,height:parseInt(this.attrs.fontSize,10)}}_setTextData(){var e=this,n=this._getTextSize(this.attrs.text),i=this.letterSpacing(),r=this.align(),s=this.kerningFunc();this.textWidth=n.width,this.textHeight=n.height;var o=Math.max(this.textWidth+((this.attrs.text||"").length-1)*i,0);this.glyphInfo=[];for(var a=0,l=0;l<e.dataArray.length;l++)e.dataArray[l].pathLength>0&&(a+=e.dataArray[l].pathLength);var h=0;r==="center"&&(h=Math.max(0,a/2-o/2)),r==="right"&&(h=Math.max(0,a-o));for(var c=cu(this.text()),u=this.text().split(" ").length-1,d,p,f,v=-1,_=0,y=function(){_=0;for(var D=e.dataArray,A=v+1;A<D.length;A++){if(D[A].pathLength>0)return v=A,D[A];D[A].command==="M"&&(d={x:D[A].points[0],y:D[A].points[1]})}return{}},g=function(D){var A=e._getTextSize(D).width+i;D===" "&&r==="justify"&&(A+=(a-o)/u);var O=0,V=0;for(p=void 0;Math.abs(A-O)/A>.01&&V<20;){V++;for(var $=O;f===void 0;)f=y(),f&&$+f.pathLength<A&&($+=f.pathLength,f=void 0);if(Object.keys(f).length===0||d===void 0)return;var K=!1;switch(f.command){case"L":we.getLineLength(d.x,d.y,f.points[0],f.points[1])>A?p=we.getPointOnLine(A,d.x,d.y,f.points[0],f.points[1],d.x,d.y):f=void 0;break;case"A":var ie=f.points[4],ue=f.points[5],Z=f.points[4]+ue;_===0?_=ie+1e-8:A>O?_+=Math.PI/180*ue/Math.abs(ue):_-=Math.PI/360*ue/Math.abs(ue),(ue<0&&_<Z||ue>=0&&_>Z)&&(_=Z,K=!0),p=we.getPointOnEllipticalArc(f.points[0],f.points[1],f.points[2],f.points[3],_,f.points[6]);break;case"C":_===0?A>f.pathLength?_=1e-8:_=A/f.pathLength:A>O?_+=(A-O)/f.pathLength/2:_=Math.max(_-(O-A)/f.pathLength/2,0),_>1&&(_=1,K=!0),p=we.getPointOnCubicBezier(_,f.start.x,f.start.y,f.points[0],f.points[1],f.points[2],f.points[3],f.points[4],f.points[5]);break;case"Q":_===0?_=A/f.pathLength:A>O?_+=(A-O)/f.pathLength:_-=(O-A)/f.pathLength,_>1&&(_=1,K=!0),p=we.getPointOnQuadraticBezier(_,f.start.x,f.start.y,f.points[0],f.points[1],f.points[2],f.points[3]);break}p!==void 0&&(O=we.getLineLength(d.x,d.y,p.x,p.y)),K&&(K=!1,f=void 0)}},m="C",S=e._getTextSize(m).width+i,P=h/S-1,k=0;k<P&&(g(m),!(d===void 0||p===void 0));k++)d=p;for(var x=0;x<c.length&&(g(c[x]),!(d===void 0||p===void 0));x++){var C=we.getLineLength(d.x,d.y,p.x,p.y),M=0;if(s)try{M=s(c[x-1],c[x])*this.fontSize()}catch{M=0}d.x+=M,p.x+=M,this.textWidth+=M;var I=we.getPointOnLine(M+C/2,d.x,d.y,p.x,p.y),N=Math.atan2(p.y-d.y,p.x-d.x);this.glyphInfo.push({transposeX:I.x,transposeY:I.y,text:c[x],rotation:N,p0:d,p1:p}),d=p}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};var e=[];this.glyphInfo.forEach(function(c){e.push(c.p0.x),e.push(c.p0.y),e.push(c.p1.x),e.push(c.p1.y)});for(var n=e[0]||0,i=e[0]||0,r=e[1]||0,s=e[1]||0,o,a,l=0;l<e.length/2;l++)o=e[l*2],a=e[l*2+1],n=Math.min(n,o),i=Math.max(i,o),r=Math.min(r,a),s=Math.max(s,a);var h=this.fontSize();return{x:n-h/2,y:r-h/2,width:i-n+h,height:s-r+h}}destroy(){return T.releaseCanvas(this.dummyCanvas),super.destroy()}}He.prototype._fillFunc=gu;He.prototype._strokeFunc=vu;He.prototype._fillFuncHit=gu;He.prototype._strokeFuncHit=vu;He.prototype.className="TextPath";He.prototype._attrsAffectingSize=["text","fontSize","data"];Ae(He);b.addGetterSetter(He,"data");b.addGetterSetter(He,"fontFamily","Arial");b.addGetterSetter(He,"fontSize",12,U());b.addGetterSetter(He,"fontStyle",pu);b.addGetterSetter(He,"align","left");b.addGetterSetter(He,"letterSpacing",0,U());b.addGetterSetter(He,"textBaseline","middle");b.addGetterSetter(He,"fontVariant",pu);b.addGetterSetter(He,"text",My);b.addGetterSetter(He,"textDecoration",null);b.addGetterSetter(He,"kerningFunc",null);var mu="tr-konva",Oy=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange"].map(t=>t+`.${mu}`).join(" "),Gl="nodesRect",Ay=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],Iy={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135};const Ry="ontouchstart"in J._global;function Ny(t,e){if(t==="rotater")return"crosshair";e+=T.degToRad(Iy[t]||0);var n=(T.radToDeg(e)%360+360)%360;return T._inRange(n,315+22.5,360)||T._inRange(n,0,22.5)?"ns-resize":T._inRange(n,45-22.5,45+22.5)?"nesw-resize":T._inRange(n,90-22.5,90+22.5)?"ew-resize":T._inRange(n,135-22.5,135+22.5)?"nwse-resize":T._inRange(n,180-22.5,180+22.5)?"ns-resize":T._inRange(n,225-22.5,225+22.5)?"nesw-resize":T._inRange(n,270-22.5,270+22.5)?"ew-resize":T._inRange(n,315-22.5,315+22.5)?"nwse-resize":(T.error("Transformer has unknown angle for cursor detection: "+n),"pointer")}var qr=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],Fl=1e8;function Dy(t){return{x:t.x+t.width/2*Math.cos(t.rotation)+t.height/2*Math.sin(-t.rotation),y:t.y+t.height/2*Math.cos(t.rotation)+t.width/2*Math.sin(t.rotation)}}function _u(t,e,n){const i=n.x+(t.x-n.x)*Math.cos(e)-(t.y-n.y)*Math.sin(e),r=n.y+(t.x-n.x)*Math.sin(e)+(t.y-n.y)*Math.cos(e);return Object.assign(Object.assign({},t),{rotation:t.rotation+e,x:i,y:r})}function Ly(t,e){const n=Dy(t);return _u(t,e,n)}function Gy(t,e,n){let i=e;for(let r=0;r<t.length;r++){const s=J.getAngle(t[r]),o=Math.abs(s-e)%(Math.PI*2);Math.min(o,Math.PI*2-o)<n&&(i=s)}return i}class _e extends di{constructor(e){super(e),this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(Oy,this.update),this.getNode()&&this.update()}attachTo(e){return this.setNode(e),this}setNode(e){return T.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([e])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return mu+this._id}setNodes(e=[]){this._nodes&&this._nodes.length&&this.detach();const n=e.filter(r=>r.isAncestorOf(this)?(T.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);this._nodes=e=n,e.length===1&&this.useSingleNodeRotation()?this.rotation(e[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(r=>{const s=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()},o=r._attrsAffectingSize.map(a=>a+"Change."+this._getEventNamespace()).join(" ");r.on(o,s),r.on(Ay.map(a=>a+`.${this._getEventNamespace()}`).join(" "),s),r.on(`absoluteTransformChange.${this._getEventNamespace()}`,s),this._proxyDrag(r)}),this._resetTransformCache();var i=!!this.findOne(".top-left");return i&&this.update(),this}_proxyDrag(e){let n;e.on(`dragstart.${this._getEventNamespace()}`,i=>{n=e.getAbsolutePosition(),!this.isDragging()&&e!==this.findOne(".back")&&this.startDrag(i,!1)}),e.on(`dragmove.${this._getEventNamespace()}`,i=>{if(!n)return;const r=e.getAbsolutePosition(),s=r.x-n.x,o=r.y-n.y;this.nodes().forEach(a=>{if(a===e||a.isDragging())return;const l=a.getAbsolutePosition();a.setAbsolutePosition({x:l.x+s,y:l.y+o}),a.startDrag(i)}),n=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(e=>{e.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(Gl),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(Gl,this.__getNodeRect)}__getNodeShape(e,n=this.rotation(),i){var r=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),s=e.getAbsoluteScale(i),o=e.getAbsolutePosition(i),a=r.x*s.x-e.offsetX()*s.x,l=r.y*s.y-e.offsetY()*s.y;const h=(J.getAngle(e.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),c={x:o.x+a*Math.cos(h)+l*Math.sin(-h),y:o.y+l*Math.cos(h)+a*Math.sin(h),width:r.width*s.x,height:r.height*s.y,rotation:h};return _u(c,-J.getAngle(n),{x:0,y:0})}__getNodeRect(){var e=this.getNode();if(!e)return{x:-Fl,y:-Fl,width:0,height:0,rotation:0};const n=[];this.nodes().map(h=>{const c=h.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()});var u=[{x:c.x,y:c.y},{x:c.x+c.width,y:c.y},{x:c.x+c.width,y:c.y+c.height},{x:c.x,y:c.y+c.height}],d=h.getAbsoluteTransform();u.forEach(function(p){var f=d.point(p);n.push(f)})});const i=new ht;i.rotate(-J.getAngle(this.rotation()));var r,s,o,a;n.forEach(function(h){var c=i.point(h);r===void 0&&(r=o=c.x,s=a=c.y),r=Math.min(r,c.x),s=Math.min(s,c.y),o=Math.max(o,c.x),a=Math.max(a,c.y)}),i.invert();const l=i.point({x:r,y:s});return{x:l.x,y:l.y,width:o-r,height:a-s,rotation:J.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),qr.forEach(function(e){this._createAnchor(e)}.bind(this)),this._createAnchor("rotater")}_createAnchor(e){var n=new ur({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:e+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:Ry?10:"auto"}),i=this;n.on("mousedown touchstart",function(r){i._handleMouseDown(r)}),n.on("dragstart",r=>{n.stopDrag(),r.cancelBubble=!0}),n.on("dragend",r=>{r.cancelBubble=!0}),n.on("mouseenter",()=>{var r=J.getAngle(this.rotation()),s=Ny(e,r);n.getStage().content&&(n.getStage().content.style.cursor=s),this._cursorChange=!0}),n.on("mouseout",()=>{n.getStage().content&&(n.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(n)}_createBack(){var e=new F({name:"back",width:0,height:0,draggable:!0,sceneFunc(n){var i=this.getParent(),r=i.padding();n.beginPath(),n.rect(-r,-r,this.width()+r*2,this.height()+r*2),n.moveTo(this.width()/2,-r),i.rotateEnabled()&&n.lineTo(this.width()/2,-i.rotateAnchorOffset()*T._sign(this.height())-r),n.fillStrokeShape(this)},hitFunc:(n,i)=>{if(this.shouldOverdrawWholeArea()){var r=this.padding();n.beginPath(),n.rect(-r,-r,i.width()+r*2,i.height()+r*2),n.fillStrokeShape(i)}}});this.add(e),this._proxyDrag(e),e.on("dragstart",n=>{n.cancelBubble=!0}),e.on("dragmove",n=>{n.cancelBubble=!0}),e.on("dragend",n=>{n.cancelBubble=!0}),this.on("dragmove",n=>{this.update()})}_handleMouseDown(e){this._movingAnchorName=e.target.name().split(" ")[0];var n=this._getNodeRect(),i=n.width,r=n.height,s=Math.sqrt(Math.pow(i,2)+Math.pow(r,2));this.sin=Math.abs(r/s),this.cos=Math.abs(i/s),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;var o=e.target.getAbsolutePosition(),a=e.target.getStage().getPointerPosition();this._anchorDragOffset={x:a.x-o.x,y:a.y-o.y},this._fire("transformstart",{evt:e.evt,target:this.getNode()}),this._nodes.forEach(l=>{l._fire("transformstart",{evt:e.evt,target:l})})}_handleMouseMove(e){var n,i,r,s=this.findOne("."+this._movingAnchorName),o=s.getStage();o.setPointersPositions(e);const a=o.getPointerPosition();let l={x:a.x-this._anchorDragOffset.x,y:a.y-this._anchorDragOffset.y};const h=s.getAbsolutePosition();this.anchorDragBoundFunc()&&(l=this.anchorDragBoundFunc()(h,l,e)),s.setAbsolutePosition(l);const c=s.getAbsolutePosition();if(!(h.x===c.x&&h.y===c.y)){if(this._movingAnchorName==="rotater"){var u=this._getNodeRect();n=s.x()-u.width/2,i=-s.y()+u.height/2;let D=Math.atan2(-i,n)+Math.PI/2;u.height<0&&(D-=Math.PI);var d=J.getAngle(this.rotation());const A=d+D,O=J.getAngle(this.rotationSnapTolerance()),$=Gy(this.rotationSnaps(),A,O)-u.rotation,K=Ly(u,$);this._fitNodesInto(K,e);return}var p=this.keepRatio()||e.shiftKey,g=this.centeredScaling()||e.altKey;if(this._movingAnchorName==="top-left"){if(p){var f=g?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};r=Math.sqrt(Math.pow(f.x-s.x(),2)+Math.pow(f.y-s.y(),2));var v=this.findOne(".top-left").x()>f.x?-1:1,_=this.findOne(".top-left").y()>f.y?-1:1;n=r*this.cos*v,i=r*this.sin*_,this.findOne(".top-left").x(f.x-n),this.findOne(".top-left").y(f.y-i)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(s.y());else if(this._movingAnchorName==="top-right"){if(p){var f=g?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};r=Math.sqrt(Math.pow(s.x()-f.x,2)+Math.pow(f.y-s.y(),2));var v=this.findOne(".top-right").x()<f.x?-1:1,_=this.findOne(".top-right").y()>f.y?-1:1;n=r*this.cos*v,i=r*this.sin*_,this.findOne(".top-right").x(f.x+n),this.findOne(".top-right").y(f.y-i)}var y=s.position();this.findOne(".top-left").y(y.y),this.findOne(".bottom-right").x(y.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(s.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(s.x());else if(this._movingAnchorName==="bottom-left"){if(p){var f=g?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};r=Math.sqrt(Math.pow(f.x-s.x(),2)+Math.pow(s.y()-f.y,2));var v=f.x<s.x()?-1:1,_=s.y()<f.y?-1:1;n=r*this.cos*v,i=r*this.sin*_,s.x(f.x-n),s.y(f.y+i)}y=s.position(),this.findOne(".top-left").x(y.x),this.findOne(".bottom-right").y(y.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(s.y());else if(this._movingAnchorName==="bottom-right"){if(p){var f=g?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};r=Math.sqrt(Math.pow(s.x()-f.x,2)+Math.pow(s.y()-f.y,2));var v=this.findOne(".bottom-right").x()<f.x?-1:1,_=this.findOne(".bottom-right").y()<f.y?-1:1;n=r*this.cos*v,i=r*this.sin*_,this.findOne(".bottom-right").x(f.x+n),this.findOne(".bottom-right").y(f.y+i)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));var g=this.centeredScaling()||e.altKey;if(g){var m=this.findOne(".top-left"),S=this.findOne(".bottom-right"),P=m.x(),k=m.y(),x=this.getWidth()-S.x(),C=this.getHeight()-S.y();S.move({x:-P,y:-k}),m.move({x,y:C})}var M=this.findOne(".top-left").getAbsolutePosition();n=M.x,i=M.y;var I=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),N=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:n,y:i,width:I,height:N,rotation:J.getAngle(this.rotation())},e)}}_handleMouseUp(e){this._removeEvents(e)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(e){if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));var n=this.getNode();this._fire("transformend",{evt:e,target:n}),n&&this._nodes.forEach(i=>{i._fire("transformend",{evt:e,target:i})}),this._movingAnchorName=null}}_fitNodesInto(e,n){var i=this._getNodeRect();const r=1;if(T._inRange(e.width,-this.padding()*2-r,r)){this.update();return}if(T._inRange(e.height,-this.padding()*2-r,r)){this.update();return}const s=this.flipEnabled();var o=new ht;if(o.rotate(J.getAngle(this.rotation())),this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("left")>=0){const u=o.point({x:-this.padding()*2,y:0});if(e.x+=u.x,e.y+=u.y,e.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=u.x,this._anchorDragOffset.y-=u.y,!s){this.update();return}}else if(this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("right")>=0){const u=o.point({x:this.padding()*2,y:0});if(this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=u.x,this._anchorDragOffset.y-=u.y,e.width+=this.padding()*2,!s){this.update();return}}if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("top")>=0){const u=o.point({x:0,y:-this.padding()*2});if(e.x+=u.x,e.y+=u.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=u.x,this._anchorDragOffset.y-=u.y,e.height+=this.padding()*2,!s){this.update();return}}else if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const u=o.point({x:0,y:this.padding()*2});if(this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=u.x,this._anchorDragOffset.y-=u.y,e.height+=this.padding()*2,!s){this.update();return}}if(this.boundBoxFunc()){const u=this.boundBoxFunc()(i,e);u?e=u:T.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const a=1e7,l=new ht;l.translate(i.x,i.y),l.rotate(i.rotation),l.scale(i.width/a,i.height/a);const h=new ht;h.translate(e.x,e.y),h.rotate(e.rotation),h.scale(e.width/a,e.height/a);const c=h.multiply(l.invert());this._nodes.forEach(u=>{var d;const p=u.getParent().getAbsoluteTransform(),f=u.getTransform().copy();f.translate(u.offsetX(),u.offsetY());const v=new ht;v.multiply(p.copy().invert()).multiply(c).multiply(p).multiply(f);const _=v.decompose();u.setAttrs(_),this._fire("transform",{evt:n,target:u}),u._fire("transform",{evt:n,target:u}),(d=u.getLayer())===null||d===void 0||d.batchDraw()}),this.rotation(T._getRotation(e.rotation)),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(e,n){this.findOne(e).setAttrs(n)}update(){var e,n=this._getNodeRect();this.rotation(T._getRotation(n.rotation));var i=n.width,r=n.height,s=this.enabledAnchors(),o=this.resizeEnabled(),a=this.padding(),l=this.anchorSize();this.find("._anchor").forEach(h=>{h.setAttrs({width:l,height:l,offsetX:l/2,offsetY:l/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:l/2+a,offsetY:l/2+a,visible:o&&s.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:i/2,y:0,offsetY:l/2+a,visible:o&&s.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:i,y:0,offsetX:l/2-a,offsetY:l/2+a,visible:o&&s.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:r/2,offsetX:l/2+a,visible:o&&s.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:i,y:r/2,offsetX:l/2-a,visible:o&&s.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:r,offsetX:l/2+a,offsetY:l/2-a,visible:o&&s.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:i/2,y:r,offsetY:l/2-a,visible:o&&s.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:i,y:r,offsetX:l/2-a,offsetY:l/2-a,visible:o&&s.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:i/2,y:-this.rotateAnchorOffset()*T._sign(r)-a,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:i,height:r,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0}),(e=this.getLayer())===null||e===void 0||e.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();var e=this.findOne("."+this._movingAnchorName);e&&e.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),di.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return H.prototype.toObject.call(this)}clone(e){var n=H.prototype.clone.call(this,e);return n}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}function Fy(t){return t instanceof Array||T.warn("enabledAnchors value should be an array"),t instanceof Array&&t.forEach(function(e){qr.indexOf(e)===-1&&T.warn("Unknown anchor name: "+e+". Available names are: "+qr.join(", "))}),t||[]}_e.prototype.className="Transformer";Ae(_e);b.addGetterSetter(_e,"enabledAnchors",qr,Fy);b.addGetterSetter(_e,"flipEnabled",!0,Mt());b.addGetterSetter(_e,"resizeEnabled",!0);b.addGetterSetter(_e,"anchorSize",10,U());b.addGetterSetter(_e,"rotateEnabled",!0);b.addGetterSetter(_e,"rotationSnaps",[]);b.addGetterSetter(_e,"rotateAnchorOffset",50,U());b.addGetterSetter(_e,"rotationSnapTolerance",5,U());b.addGetterSetter(_e,"borderEnabled",!0);b.addGetterSetter(_e,"anchorStroke","rgb(0, 161, 255)");b.addGetterSetter(_e,"anchorStrokeWidth",1,U());b.addGetterSetter(_e,"anchorFill","white");b.addGetterSetter(_e,"anchorCornerRadius",0,U());b.addGetterSetter(_e,"borderStroke","rgb(0, 161, 255)");b.addGetterSetter(_e,"borderStrokeWidth",1,U());b.addGetterSetter(_e,"borderDash");b.addGetterSetter(_e,"keepRatio",!0);b.addGetterSetter(_e,"centeredScaling",!1);b.addGetterSetter(_e,"ignoreStroke",!1);b.addGetterSetter(_e,"padding",0,U());b.addGetterSetter(_e,"node");b.addGetterSetter(_e,"nodes");b.addGetterSetter(_e,"boundBoxFunc");b.addGetterSetter(_e,"anchorDragBoundFunc");b.addGetterSetter(_e,"shouldOverdrawWholeArea",!1);b.addGetterSetter(_e,"useSingleNodeRotation",!0);b.backCompat(_e,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});class Qt extends F{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,J.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}Qt.prototype.className="Wedge";Qt.prototype._centroid=!0;Qt.prototype._attrsAffectingSize=["radius"];Ae(Qt);b.addGetterSetter(Qt,"radius",0,U());b.addGetterSetter(Qt,"angle",0,U());b.addGetterSetter(Qt,"clockwise",!1);b.backCompat(Qt,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});function $l(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var $y=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],By=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function Hy(t,e){var n=t.data,i=t.width,r=t.height,s,o,a,l,h,c,u,d,p,f,v,_,y,g,m,S,P,k,x,C,M,I,N,D,A=e+e+1,O=i-1,V=r-1,$=e+1,K=$*($+1)/2,ie=new $l,ue=null,Z=ie,ce=null,fe=null,ye=$y[e],Ye=By[e];for(a=1;a<A;a++)Z=Z.next=new $l,a===$&&(ue=Z);for(Z.next=ie,u=c=0,o=0;o<r;o++){for(S=P=k=x=d=p=f=v=0,_=$*(C=n[c]),y=$*(M=n[c+1]),g=$*(I=n[c+2]),m=$*(N=n[c+3]),d+=K*C,p+=K*M,f+=K*I,v+=K*N,Z=ie,a=0;a<$;a++)Z.r=C,Z.g=M,Z.b=I,Z.a=N,Z=Z.next;for(a=1;a<$;a++)l=c+((O<a?O:a)<<2),d+=(Z.r=C=n[l])*(D=$-a),p+=(Z.g=M=n[l+1])*D,f+=(Z.b=I=n[l+2])*D,v+=(Z.a=N=n[l+3])*D,S+=C,P+=M,k+=I,x+=N,Z=Z.next;for(ce=ie,fe=ue,s=0;s<i;s++)n[c+3]=N=v*ye>>Ye,N!==0?(N=255/N,n[c]=(d*ye>>Ye)*N,n[c+1]=(p*ye>>Ye)*N,n[c+2]=(f*ye>>Ye)*N):n[c]=n[c+1]=n[c+2]=0,d-=_,p-=y,f-=g,v-=m,_-=ce.r,y-=ce.g,g-=ce.b,m-=ce.a,l=u+((l=s+e+1)<O?l:O)<<2,S+=ce.r=n[l],P+=ce.g=n[l+1],k+=ce.b=n[l+2],x+=ce.a=n[l+3],d+=S,p+=P,f+=k,v+=x,ce=ce.next,_+=C=fe.r,y+=M=fe.g,g+=I=fe.b,m+=N=fe.a,S-=C,P-=M,k-=I,x-=N,fe=fe.next,c+=4;u+=i}for(s=0;s<i;s++){for(P=k=x=S=p=f=v=d=0,c=s<<2,_=$*(C=n[c]),y=$*(M=n[c+1]),g=$*(I=n[c+2]),m=$*(N=n[c+3]),d+=K*C,p+=K*M,f+=K*I,v+=K*N,Z=ie,a=0;a<$;a++)Z.r=C,Z.g=M,Z.b=I,Z.a=N,Z=Z.next;for(h=i,a=1;a<=e;a++)c=h+s<<2,d+=(Z.r=C=n[c])*(D=$-a),p+=(Z.g=M=n[c+1])*D,f+=(Z.b=I=n[c+2])*D,v+=(Z.a=N=n[c+3])*D,S+=C,P+=M,k+=I,x+=N,Z=Z.next,a<V&&(h+=i);for(c=s,ce=ie,fe=ue,o=0;o<r;o++)l=c<<2,n[l+3]=N=v*ye>>Ye,N>0?(N=255/N,n[l]=(d*ye>>Ye)*N,n[l+1]=(p*ye>>Ye)*N,n[l+2]=(f*ye>>Ye)*N):n[l]=n[l+1]=n[l+2]=0,d-=_,p-=y,f-=g,v-=m,_-=ce.r,y-=ce.g,g-=ce.b,m-=ce.a,l=s+((l=o+$)<V?l:V)*i<<2,d+=S+=ce.r=n[l],p+=P+=ce.g=n[l+1],f+=k+=ce.b=n[l+2],v+=x+=ce.a=n[l+3],ce=ce.next,_+=C=fe.r,y+=M=fe.g,g+=I=fe.b,m+=N=fe.a,S-=C,P-=M,k-=I,x-=N,fe=fe.next,c+=i}}const Uy=function(e){var n=Math.round(this.blurRadius());n>0&&Hy(e,n)};b.addGetterSetter(H,"blurRadius",0,U(),b.afterSetFilter);const jy=function(t){var e=this.brightness()*255,n=t.data,i=n.length,r;for(r=0;r<i;r+=4)n[r]+=e,n[r+1]+=e,n[r+2]+=e};b.addGetterSetter(H,"brightness",0,U(),b.afterSetFilter);const Wy=function(t){var e=Math.pow((this.contrast()+100)/100,2),n=t.data,i=n.length,r=150,s=150,o=150,a;for(a=0;a<i;a+=4)r=n[a],s=n[a+1],o=n[a+2],r/=255,r-=.5,r*=e,r+=.5,r*=255,s/=255,s-=.5,s*=e,s+=.5,s*=255,o/=255,o-=.5,o*=e,o+=.5,o*=255,r=r<0?0:r>255?255:r,s=s<0?0:s>255?255:s,o=o<0?0:o>255?255:o,n[a]=r,n[a+1]=s,n[a+2]=o};b.addGetterSetter(H,"contrast",0,U(),b.afterSetFilter);const zy=function(t){var e=this.embossStrength()*10,n=this.embossWhiteLevel()*255,i=this.embossDirection(),r=this.embossBlend(),s=0,o=0,a=t.data,l=t.width,h=t.height,c=l*4,u=h;switch(i){case"top-left":s=-1,o=-1;break;case"top":s=-1,o=0;break;case"top-right":s=-1,o=1;break;case"right":s=0,o=1;break;case"bottom-right":s=1,o=1;break;case"bottom":s=1,o=0;break;case"bottom-left":s=1,o=-1;break;case"left":s=0,o=-1;break;default:T.error("Unknown emboss direction: "+i)}do{var d=(u-1)*c,p=s;u+p<1&&(p=0),u+p>h&&(p=0);var f=(u-1+p)*l*4,v=l;do{var _=d+(v-1)*4,y=o;v+y<1&&(y=0),v+y>l&&(y=0);var g=f+(v-1+y)*4,m=a[_]-a[g],S=a[_+1]-a[g+1],P=a[_+2]-a[g+2],k=m,x=k>0?k:-k,C=S>0?S:-S,M=P>0?P:-P;if(C>x&&(k=S),M>x&&(k=P),k*=e,r){var I=a[_]+k,N=a[_+1]+k,D=a[_+2]+k;a[_]=I>255?255:I<0?0:I,a[_+1]=N>255?255:N<0?0:N,a[_+2]=D>255?255:D<0?0:D}else{var A=n-k;A<0?A=0:A>255&&(A=255),a[_]=a[_+1]=a[_+2]=A}}while(--v)}while(--u)};b.addGetterSetter(H,"embossStrength",.5,U(),b.afterSetFilter);b.addGetterSetter(H,"embossWhiteLevel",.5,U(),b.afterSetFilter);b.addGetterSetter(H,"embossDirection","top-left",null,b.afterSetFilter);b.addGetterSetter(H,"embossBlend",!1,null,b.afterSetFilter);function $s(t,e,n,i,r){var s=n-e,o=r-i,a;return s===0?i+o/2:o===0?i:(a=(t-e)/s,a=o*a+i,a)}const Vy=function(t){var e=t.data,n=e.length,i=e[0],r=i,s,o=e[1],a=o,l,h=e[2],c=h,u,d,p=this.enhance();if(p!==0){for(d=0;d<n;d+=4)s=e[d+0],s<i?i=s:s>r&&(r=s),l=e[d+1],l<o?o=l:l>a&&(a=l),u=e[d+2],u<h?h=u:u>c&&(c=u);r===i&&(r=255,i=0),a===o&&(a=255,o=0),c===h&&(c=255,h=0);var f,v,_,y,g,m,S,P,k;for(p>0?(v=r+p*(255-r),_=i-p*(i-0),g=a+p*(255-a),m=o-p*(o-0),P=c+p*(255-c),k=h-p*(h-0)):(f=(r+i)*.5,v=r+p*(r-f),_=i+p*(i-f),y=(a+o)*.5,g=a+p*(a-y),m=o+p*(o-y),S=(c+h)*.5,P=c+p*(c-S),k=h+p*(h-S)),d=0;d<n;d+=4)e[d+0]=$s(e[d+0],i,r,_,v),e[d+1]=$s(e[d+1],o,a,m,g),e[d+2]=$s(e[d+2],h,c,k,P)}};b.addGetterSetter(H,"enhance",0,U(),b.afterSetFilter);const Yy=function(t){var e=t.data,n=e.length,i,r;for(i=0;i<n;i+=4)r=.34*e[i]+.5*e[i+1]+.16*e[i+2],e[i]=r,e[i+1]=r,e[i+2]=r};b.addGetterSetter(H,"hue",0,U(),b.afterSetFilter);b.addGetterSetter(H,"saturation",0,U(),b.afterSetFilter);b.addGetterSetter(H,"luminance",0,U(),b.afterSetFilter);const Xy=function(t){var e=t.data,n=e.length,i=1,r=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,o=this.luminance()*127,a,l=i*r*Math.cos(s*Math.PI/180),h=i*r*Math.sin(s*Math.PI/180),c=.299*i+.701*l+.167*h,u=.587*i-.587*l+.33*h,d=.114*i-.114*l-.497*h,p=.299*i-.299*l-.328*h,f=.587*i+.413*l+.035*h,v=.114*i-.114*l+.293*h,_=.299*i-.3*l+1.25*h,y=.587*i-.586*l-1.05*h,g=.114*i+.886*l-.2*h,m,S,P,k;for(a=0;a<n;a+=4)m=e[a+0],S=e[a+1],P=e[a+2],k=e[a+3],e[a+0]=c*m+u*S+d*P+o,e[a+1]=p*m+f*S+v*P+o,e[a+2]=_*m+y*S+g*P+o,e[a+3]=k},Ky=function(t){var e=t.data,n=e.length,i=Math.pow(2,this.value()),r=Math.pow(2,this.saturation()),s=Math.abs(this.hue()+360)%360,o,a=i*r*Math.cos(s*Math.PI/180),l=i*r*Math.sin(s*Math.PI/180),h=.299*i+.701*a+.167*l,c=.587*i-.587*a+.33*l,u=.114*i-.114*a-.497*l,d=.299*i-.299*a-.328*l,p=.587*i+.413*a+.035*l,f=.114*i-.114*a+.293*l,v=.299*i-.3*a+1.25*l,_=.587*i-.586*a-1.05*l,y=.114*i+.886*a-.2*l,g,m,S,P;for(o=0;o<n;o+=4)g=e[o+0],m=e[o+1],S=e[o+2],P=e[o+3],e[o+0]=h*g+c*m+u*S,e[o+1]=d*g+p*m+f*S,e[o+2]=v*g+_*m+y*S,e[o+3]=P};b.addGetterSetter(H,"hue",0,U(),b.afterSetFilter);b.addGetterSetter(H,"saturation",0,U(),b.afterSetFilter);b.addGetterSetter(H,"value",0,U(),b.afterSetFilter);const qy=function(t){var e=t.data,n=e.length,i;for(i=0;i<n;i+=4)e[i]=255-e[i],e[i+1]=255-e[i+1],e[i+2]=255-e[i+2]};var Jy=function(t,e,n){var i=t.data,r=e.data,s=t.width,o=t.height,a=n.polarCenterX||s/2,l=n.polarCenterY||o/2,h,c,u,d=0,p=0,f=0,v=0,_,y=Math.sqrt(a*a+l*l);c=s-a,u=o-l,_=Math.sqrt(c*c+u*u),y=_>y?_:y;var g=o,m=s,S,P,k=360/m*Math.PI/180,x,C;for(P=0;P<m;P+=1)for(x=Math.sin(P*k),C=Math.cos(P*k),S=0;S<g;S+=1)c=Math.floor(a+y*S/g*C),u=Math.floor(l+y*S/g*x),h=(u*s+c)*4,d=i[h+0],p=i[h+1],f=i[h+2],v=i[h+3],h=(P+S*s)*4,r[h+0]=d,r[h+1]=p,r[h+2]=f,r[h+3]=v},Qy=function(t,e,n){var i=t.data,r=e.data,s=t.width,o=t.height,a=n.polarCenterX||s/2,l=n.polarCenterY||o/2,h,c,u,d,p,f=0,v=0,_=0,y=0,g,m=Math.sqrt(a*a+l*l);c=s-a,u=o-l,g=Math.sqrt(c*c+u*u),m=g>m?g:m;var S=o,P=s,k,x,C=n.polarRotation||0,M,I;for(c=0;c<s;c+=1)for(u=0;u<o;u+=1)d=c-a,p=u-l,k=Math.sqrt(d*d+p*p)*S/m,x=(Math.atan2(p,d)*180/Math.PI+360+C)%360,x=x*P/360,M=Math.floor(x),I=Math.floor(k),h=(I*s+M)*4,f=i[h+0],v=i[h+1],_=i[h+2],y=i[h+3],h=(u*s+c)*4,r[h+0]=f,r[h+1]=v,r[h+2]=_,r[h+3]=y};const Zy=function(t){var e=t.width,n=t.height,i,r,s,o,a,l,h,c,u,d,p=Math.round(this.kaleidoscopePower()),f=Math.round(this.kaleidoscopeAngle()),v=Math.floor(e*(f%360)/360);if(!(p<1)){var _=T.createCanvasElement();_.width=e,_.height=n;var y=_.getContext("2d").getImageData(0,0,e,n);T.releaseCanvas(_),Jy(t,y,{polarCenterX:e/2,polarCenterY:n/2});for(var g=e/Math.pow(2,p);g<=8;)g=g*2,p-=1;g=Math.ceil(g);var m=g,S=0,P=m,k=1;for(v+g>e&&(S=m,P=0,k=-1),r=0;r<n;r+=1)for(i=S;i!==P;i+=k)s=Math.round(i+v)%e,u=(e*r+s)*4,a=y.data[u+0],l=y.data[u+1],h=y.data[u+2],c=y.data[u+3],d=(e*r+i)*4,y.data[d+0]=a,y.data[d+1]=l,y.data[d+2]=h,y.data[d+3]=c;for(r=0;r<n;r+=1)for(m=Math.floor(g),o=0;o<p;o+=1){for(i=0;i<m+1;i+=1)u=(e*r+i)*4,a=y.data[u+0],l=y.data[u+1],h=y.data[u+2],c=y.data[u+3],d=(e*r+m*2-i-1)*4,y.data[d+0]=a,y.data[d+1]=l,y.data[d+2]=h,y.data[d+3]=c;m*=2}Qy(y,t,{polarRotation:0})}};b.addGetterSetter(H,"kaleidoscopePower",2,U(),b.afterSetFilter);b.addGetterSetter(H,"kaleidoscopeAngle",0,U(),b.afterSetFilter);function Dr(t,e,n){var i=(n*t.width+e)*4,r=[];return r.push(t.data[i++],t.data[i++],t.data[i++],t.data[i++]),r}function Pi(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}function eb(t){for(var e=[0,0,0],n=0;n<t.length;n++)e[0]+=t[n][0],e[1]+=t[n][1],e[2]+=t[n][2];return e[0]/=t.length,e[1]/=t.length,e[2]/=t.length,e}function tb(t,e){var n=Dr(t,0,0),i=Dr(t,t.width-1,0),r=Dr(t,0,t.height-1),s=Dr(t,t.width-1,t.height-1),o=e||10;if(Pi(n,i)<o&&Pi(i,s)<o&&Pi(s,r)<o&&Pi(r,n)<o){for(var a=eb([i,n,s,r]),l=[],h=0;h<t.width*t.height;h++){var c=Pi(a,[t.data[h*4],t.data[h*4+1],t.data[h*4+2]]);l[h]=c<o?0:255}return l}}function nb(t,e){for(var n=0;n<t.width*t.height;n++)t.data[4*n+3]=e[n]}function ib(t,e,n){for(var i=[1,1,1,1,0,1,1,1,1],r=Math.round(Math.sqrt(i.length)),s=Math.floor(r/2),o=[],a=0;a<n;a++)for(var l=0;l<e;l++){for(var h=a*e+l,c=0,u=0;u<r;u++)for(var d=0;d<r;d++){var p=a+u-s,f=l+d-s;if(p>=0&&p<n&&f>=0&&f<e){var v=p*e+f,_=i[u*r+d];c+=t[v]*_}}o[h]=c===255*8?255:0}return o}function rb(t,e,n){for(var i=[1,1,1,1,1,1,1,1,1],r=Math.round(Math.sqrt(i.length)),s=Math.floor(r/2),o=[],a=0;a<n;a++)for(var l=0;l<e;l++){for(var h=a*e+l,c=0,u=0;u<r;u++)for(var d=0;d<r;d++){var p=a+u-s,f=l+d-s;if(p>=0&&p<n&&f>=0&&f<e){var v=p*e+f,_=i[u*r+d];c+=t[v]*_}}o[h]=c>=255*4?255:0}return o}function sb(t,e,n){for(var i=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],r=Math.round(Math.sqrt(i.length)),s=Math.floor(r/2),o=[],a=0;a<n;a++)for(var l=0;l<e;l++){for(var h=a*e+l,c=0,u=0;u<r;u++)for(var d=0;d<r;d++){var p=a+u-s,f=l+d-s;if(p>=0&&p<n&&f>=0&&f<e){var v=p*e+f,_=i[u*r+d];c+=t[v]*_}}o[h]=c}return o}const ob=function(t){var e=this.threshold(),n=tb(t,e);return n&&(n=ib(n,t.width,t.height),n=rb(n,t.width,t.height),n=sb(n,t.width,t.height),nb(t,n)),t};b.addGetterSetter(H,"threshold",0,U(),b.afterSetFilter);const ab=function(t){var e=this.noise()*255,n=t.data,i=n.length,r=e/2,s;for(s=0;s<i;s+=4)n[s+0]+=r-2*r*Math.random(),n[s+1]+=r-2*r*Math.random(),n[s+2]+=r-2*r*Math.random()};b.addGetterSetter(H,"noise",.2,U(),b.afterSetFilter);const lb=function(t){var e=Math.ceil(this.pixelSize()),n=t.width,i=t.height,r,s,o,a,l,h,c,u=Math.ceil(n/e),d=Math.ceil(i/e),p,f,v,_,y,g,m,S=t.data;if(e<=0){T.error("pixelSize value can not be <= 0");return}for(y=0;y<u;y+=1)for(g=0;g<d;g+=1){for(a=0,l=0,h=0,c=0,p=y*e,f=p+e,v=g*e,_=v+e,m=0,r=p;r<f;r+=1)if(!(r>=n))for(s=v;s<_;s+=1)s>=i||(o=(n*s+r)*4,a+=S[o+0],l+=S[o+1],h+=S[o+2],c+=S[o+3],m+=1);for(a=a/m,l=l/m,h=h/m,c=c/m,r=p;r<f;r+=1)if(!(r>=n))for(s=v;s<_;s+=1)s>=i||(o=(n*s+r)*4,S[o+0]=a,S[o+1]=l,S[o+2]=h,S[o+3]=c)}};b.addGetterSetter(H,"pixelSize",8,U(),b.afterSetFilter);const hb=function(t){var e=Math.round(this.levels()*254)+1,n=t.data,i=n.length,r=255/e,s;for(s=0;s<i;s+=1)n[s]=Math.floor(n[s]/r)*r};b.addGetterSetter(H,"levels",.5,U(),b.afterSetFilter);const cb=function(t){var e=t.data,n=e.length,i=this.red(),r=this.green(),s=this.blue(),o,a;for(o=0;o<n;o+=4)a=(.34*e[o]+.5*e[o+1]+.16*e[o+2])/255,e[o]=a*i,e[o+1]=a*r,e[o+2]=a*s,e[o+3]=e[o+3]};b.addGetterSetter(H,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});b.addGetterSetter(H,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});b.addGetterSetter(H,"blue",0,Uc,b.afterSetFilter);const ub=function(t){var e=t.data,n=e.length,i=this.red(),r=this.green(),s=this.blue(),o=this.alpha(),a,l;for(a=0;a<n;a+=4)l=1-o,e[a]=i*o+e[a]*l,e[a+1]=r*o+e[a+1]*l,e[a+2]=s*o+e[a+2]*l};b.addGetterSetter(H,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});b.addGetterSetter(H,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});b.addGetterSetter(H,"blue",0,Uc,b.afterSetFilter);b.addGetterSetter(H,"alpha",1,function(t){return this._filterUpToDate=!1,t>1?1:t<0?0:t});const db=function(t){var e=t.data,n=e.length,i,r,s,o;for(i=0;i<n;i+=4)r=e[i+0],s=e[i+1],o=e[i+2],e[i+0]=Math.min(255,r*.393+s*.769+o*.189),e[i+1]=Math.min(255,r*.349+s*.686+o*.168),e[i+2]=Math.min(255,r*.272+s*.534+o*.131)},fb=function(t){var e=t.data,n=t.width,i=t.height,r=n*4,s=i;do{var o=(s-1)*r,a=n;do{var l=o+(a-1)*4,h=e[l],c=e[l+1],u=e[l+2];h>127&&(h=255-h),c>127&&(c=255-c),u>127&&(u=255-u),e[l]=h,e[l+1]=c,e[l+2]=u}while(--a)}while(--s)},pb=function(t){var e=this.threshold()*255,n=t.data,i=n.length,r;for(r=0;r<i;r+=1)n[r]=n[r]<e?0:255};b.addGetterSetter(H,"threshold",.5,U(),b.afterSetFilter);const gb=Al.Util._assign(Al,{Arc:qt,Arrow:jn,Circle:bi,Ellipse:yn,Image:yt,Label:oa,Tag:Wn,Line:Jt,Path:we,Rect:ur,RegularPolygon:zn,Ring:Vn,Sprite:$t,Star:bn,Text:Oe,TextPath:He,Transformer:_e,Wedge:Qt,Filters:{Blur:Uy,Brighten:jy,Contrast:Wy,Emboss:zy,Enhance:Vy,Grayscale:Yy,HSL:Xy,HSV:Ky,Invert:qy,Kaleidoscope:Zy,Mask:ob,Noise:ab,Pixelate:lb,Posterize:hb,RGB:cb,RGBA:ub,Sepia:db,Solarize:fb,Threshold:pb}}),vb=Object.freeze(Object.defineProperty({__proto__:null,default:gb},Symbol.toStringTag,{value:"Module"})),mb=Hc(vb);/*!
 * vue-konva v3.0.1 - https://github.com/konvajs/vue-konva#readme
 * MIT Licensed
 */(function(t,e){(function(i,r){t.exports=r(r_,mb)})(t_,function(n,i){return function(r){var s={};function o(a){if(s[a])return s[a].exports;var l=s[a]={i:a,l:!1,exports:{}};return r[a].call(l.exports,l,l.exports,o),l.l=!0,l.exports}return o.m=r,o.c=s,o.d=function(a,l,h){o.o(a,l)||Object.defineProperty(a,l,{enumerable:!0,get:h})},o.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},o.t=function(a,l){if(l&1&&(a=o(a)),l&8||l&4&&typeof a=="object"&&a&&a.__esModule)return a;var h=Object.create(null);if(o.r(h),Object.defineProperty(h,"default",{enumerable:!0,value:a}),l&2&&typeof a!="string")for(var c in a)o.d(h,c,function(u){return a[u]}.bind(null,c));return h},o.n=function(a){var l=a&&a.__esModule?function(){return a.default}:function(){return a};return o.d(l,"a",l),l},o.o=function(a,l){return Object.prototype.hasOwnProperty.call(a,l)},o.p="",o(o.s=2)}([function(r,s){r.exports=n},function(r,s){r.exports=i},function(r,s,o){r.exports=o(3)},function(r,s,o){o.r(s);var a=o(0),l=o(1),h=o.n(l);function c(A){if(!h.a.autoDrawEnabled){var O=A.getLayer()||A.getStage();O&&O.batchDraw()}}var u={key:!0,style:!0,elm:!0,isRootInsert:!0},d=".vue-konva-event";function p(A,O,V,$){O===void 0&&(O={}),V===void 0&&(V={});var K=A.__konvaNode,ie={},ue=!1;for(var Z in V)if(!u[Z]){var ce=Z.slice(0,2)==="on",fe=V[Z]!==O[Z];if(ce&&fe){var ye=Z.substr(2).toLowerCase();ye.substr(0,7)==="content"&&(ye="content"+ye.substr(7,1).toUpperCase()+ye.substr(8)),K.off(ye+d,V[Z])}var Ye=!O.hasOwnProperty(Z);Ye&&K.setAttr(Z,void 0)}for(var Ie in O)if(!u[Ie]){var Re=Ie.slice(0,2)==="on",bt=V[Ie]!==O[Ie];if(Re&&bt){var Ue=Ie.substr(2).toLowerCase();Ue.substr(0,7)==="content"&&(Ue="content"+Ue.substr(7,1).toUpperCase()+Ue.substr(8)),O[Ie]&&(K.off(Ue+d),K.on(Ue+d,O[Ie]))}!Re&&(O[Ie]!==V[Ie]||$&&O[Ie]!==K.getAttr(Ie))&&(ue=!0,ie[Ie]=O[Ie])}ue&&(K.setAttrs(ie),c(K))}var f="v";function v(A){function O(V){return V.__konvaNode?V:V.parent?O(V.parent):(console.error("vue-konva error: Can not find parent node"),{})}return O(A.parent)}function _(A){if(A!=null&&A.component)return A.component.__konvaNode||_(A.component.subTree)}function y(A){var O=A.el,V=A.component,$=_(A);if(O!=null&&O.tagName&&V&&!$){var K=O&&O.tagName.toLowerCase();return console.error('vue-konva error: You are trying to render "'+K+'" inside your component tree. Looks like it is not a Konva node. You can render only Konva components inside the Stage.'),null}return $}function g(A){var O=[];return A.children&&A.children.forEach(function(V){!V.component&&Array.isArray(V.children)&&V.children.forEach(function($){!$.component&&Array.isArray($.children)?O.push.apply(O,$.children):O.push($)}),V.component&&O.push(V)}),O}function m(A,O){var V=g(A),$=[];V.forEach(function(ie){var ue=y(ie);ue&&$.push(ue)});var K=!1;$.forEach(function(ie,ue){ie.getZIndex()!==ue&&(ie.setZIndex(ue),K=!0)}),K&&c(O)}function S(){return S=Object.assign||function(A){for(var O=1;O<arguments.length;O++){var V=arguments[O];for(var $ in V)Object.prototype.hasOwnProperty.call(V,$)&&(A[$]=V[$])}return A},S.apply(this,arguments)}var P={props:{config:{type:Object,default:function(){return{}}},__useStrictMode:{type:Boolean}},inheritAttrs:!1,setup:function(O,V){var $=V.attrs,K=V.slots,ie=V.expose;V.emits;var ue=Object(a.getCurrentInstance)(),Z=Object(a.reactive)({}),ce=Object(a.ref)(null),fe=new window.Konva.Stage({width:O.config.width,height:O.config.height,container:document.createElement("div")});ue.__konvaNode=fe,Ie();function ye(){return ue.__konvaNode}function Ye(){return ue.__konvaNode}function Ie(){var Re=Z||{},bt=S({},$,O.config);p(ue,bt,Re,O.__useStrictMode),Object.assign(Z,bt)}return Object(a.onMounted)(function(){ce.value.innerHTML="",fe.container(ce.value),Ie()}),Object(a.onUpdated)(function(){Ie(),m(ue.subTree,fe)}),Object(a.onBeforeUnmount)(function(){fe.destroy()}),Object(a.watch)(function(){return O.config},Ie,{deep:!0}),ie({getStage:Ye,getNode:ye}),function(){var Re;return Object(a.h)("div",{ref:ce},(Re=K.default)===null||Re===void 0?void 0:Re.call(K))}}};function k(){return k=Object.assign||function(A){for(var O=1;O<arguments.length;O++){var V=arguments[O];for(var $ in V)Object.prototype.hasOwnProperty.call(V,$)&&(A[$]=V[$])}return A},k.apply(this,arguments)}var x=".vue-konva-event",C={Group:!0,Layer:!0,FastLayer:!0,Label:!0},M=function(A){return{props:{config:{type:Object,default:function(){return{}}},__useStrictMode:{type:Boolean}},setup:function(V,$){var K=$.attrs,ie=$.slots,ue=$.expose,Z=Object(a.getCurrentInstance)(),ce=Object(a.reactive)({}),fe=window.Konva[A];if(!fe){console.error("vue-konva error: Can not find node "+A);return}var ye=new fe;Z.__konvaNode=ye,Z.vnode.__konvaNode=ye,Re();function Ye(){return Z.__konvaNode}function Ie(){return Z.__konvaNode}function Re(){var Ue={};for(var Ot in Z.vnode.props)Ot.slice(0,2)==="on"&&(Ue[Ot]=Z.vnode.props[Ot]);var wi=ce||{},Yn=k({},K,V.config,Ue);p(Z,Yn,wi,V.__useStrictMode),Object.assign(ce,Yn)}Object(a.onMounted)(function(){var Ue=v(Z).__konvaNode;Ue.add(ye),c(ye)}),Object(a.onUnmounted)(function(){c(ye),ye.destroy(),ye.off(x)}),Object(a.onUpdated)(function(){Re(),m(Z.subTree,ye)}),Object(a.watch)(function(){return V.config},Re,{deep:!0}),ue({getStage:Ie,getNode:Ye});var bt=C[A];return bt?function(){var Ue;return Object(a.h)("template",{},(Ue=ie.default)===null||Ue===void 0?void 0:Ue.call(ie))}:function(){return null}}}};typeof window<"u"&&!window.Konva&&o(1);var I=["Layer","FastLayer","Group","Label","Rect","Circle","Ellipse","Wedge","Line","Sprite","Image","Text","TextPath","Star","Ring","Arc","Tag","Path","RegularPolygon","Arrow","Shape","Transformer"],N=[{name:"Stage",component:P}].concat(I.map(function(A){return{name:A,component:M(A)}})),D={install:function(O,V){var $=f;V&&V.prefix&&($=V.prefix),N.forEach(function(K){O.component(""+$+K.name,K.component)})}};s.default=D}]).default})})(i_);const _b=n_(uo);bc(e_).use(_b).mount("#app");
